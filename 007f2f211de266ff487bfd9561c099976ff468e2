{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "8a961b45_57139a21",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1083042
      },
      "writtenOn": "2021-06-30T13:32:22Z",
      "side": 1,
      "message": "Edwin, you added this code in 2018, LMK if you\u0027re OK with removing the \"Email: ...\" part.\nMarija, please review for the business logic.",
      "revId": "007f2f211de266ff487bfd9561c099976ff468e2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "569a8e9c_f7e83e2b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2021-06-30T13:36:35Z",
      "side": 1,
      "message": "It made issue investigations a little easier since you could just search for the email when looking at the git history, but I guess you can find git commands to also search for the email in the diffs. So removing it should be fine, but since the email is still present in the diffs it also means that you don\u0027t gain that much by removing them from the commit message.",
      "parentUuid": "8a961b45_57139a21",
      "revId": "007f2f211de266ff487bfd9561c099976ff468e2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0bc66206_f4bfc2da",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1083042
      },
      "writtenOn": "2021-06-30T13:45:26Z",
      "side": 1,
      "message": "Yes, it is still persisted in the previous commit - is that what you mean? That can be GC-ed eventually, so it should be OK, but LMK if I\u0027m missing something.",
      "parentUuid": "569a8e9c_f7e83e2b",
      "revId": "007f2f211de266ff487bfd9561c099976ff468e2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "85216620_9906d8a3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2021-06-30T14:00:19Z",
      "side": 1,
      "message": "What I mean is that the footer with the email is only added to the commit message if the external ID for that email is touched in that commit. Since the email for the external ID is stored as plain text, you will still be able to see the email from the commit content.\n\nBut maybe there are plans to to store the emails encrypted?",
      "parentUuid": "0bc66206_f4bfc2da",
      "revId": "007f2f211de266ff487bfd9561c099976ff468e2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "14d02f87_eae4356a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1083042
      },
      "writtenOn": "2021-06-30T14:12:54Z",
      "side": 1,
      "message": "\u003e What I mean is that the footer with the email is only added to the commit message if the external ID for that email is touched in that commit. Since the email for the external ID is stored as plain text, you will still be able to see the email from the commit content.\n\nI think the problem is that \"touched\" includes \"deleted\", so what happens is that we delete the external ID to remove the email address, but then persist the very same email address in the commit message.\n\nIf we stop persisting the email in commit N, then IIUC GC-ing up to and including commit N-1 will make the email inaccessible, or is that not the case?",
      "parentUuid": "85216620_9906d8a3",
      "revId": "007f2f211de266ff487bfd9561c099976ff468e2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "454968d7_1a43dc29",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2021-06-30T14:32:23Z",
      "side": 1,
      "message": "Yes, \"touched\" includes \"deleted\".\n\nAFAIK you can only GC commits that are no longer referenced. Since commit N references commit N-1 as its parent commit it will not be GCed. To GC it you would need to rewrite commit N and all it successors so that commit N becomes a new root commit. \n\nThis would basically be equivalent to not having any git history for refs/meta/external-ids, e.g. have a single commit that is always amended when external IDs are updated (I think we do this for the branches in All-Users that store the draft comments as we don\u0027t need to keep a history for these branches).\n\nBut if we do this we also lose the advantage of storing this data in NoteDb which is having the history available.",
      "parentUuid": "14d02f87_eae4356a",
      "revId": "007f2f211de266ff487bfd9561c099976ff468e2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6b3feff3_f80ce309",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2021-06-30T14:34:49Z",
      "side": 1,
      "message": "In other words, as long as refs/meta/external-ids has a Git history you will be able to find the emails of all existing and deleted external IDs in there.",
      "parentUuid": "454968d7_1a43dc29",
      "revId": "007f2f211de266ff487bfd9561c099976ff468e2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b86f585e_4dffd820",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-07-01T07:12:24Z",
      "side": 1,
      "message": "We\u0027ll have to do non-FF updates on All-Users updates, and rely on reflog to look at historical updates.",
      "parentUuid": "6b3feff3_f80ce309",
      "revId": "007f2f211de266ff487bfd9561c099976ff468e2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "134a5a1a_e7b34ea2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-07-01T07:13:09Z",
      "side": 1,
      "message": "if we do that, it\u0027s not necessary to remove data from commit message, though, because the commit msg itself will also be made unreachable.",
      "parentUuid": "b86f585e_4dffd820",
      "revId": "007f2f211de266ff487bfd9561c099976ff468e2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e607bf5b_7001dd8e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2021-07-01T07:14:44Z",
      "side": 1,
      "message": "Indeed, but at this point the data in the commit message loses its purpose. So in this case we should drop it.",
      "parentUuid": "134a5a1a_e7b34ea2",
      "revId": "007f2f211de266ff487bfd9561c099976ff468e2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bef18bd1_d513197e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-07-01T16:46:09Z",
      "side": 1,
      "message": "We discussed offline with Joerg, regardless of the strategy, I think it is ok to remove those footers.\nI mostly rely on git log to find the relevant commits by email address/account id (which is contained in external id config file).\n\nAs for the garbage collection, I suggest we discuss non-FF strategy vs email encryption separately for pros and cons.\nLooks like non-FF should be preferable, while email encryption would require extra layer when reading external-ids and would make debugging for both existing and deleted accounts harder.",
      "parentUuid": "e607bf5b_7001dd8e",
      "revId": "007f2f211de266ff487bfd9561c099976ff468e2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}