{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "609916a5_e06bb425",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 13,
      "author": {
        "id": 1146706
      },
      "writtenOn": "2023-11-24T09:17:08Z",
      "side": 1,
      "message": "Implicit?",
      "range": {
        "startLine": 13,
        "startChar": 47,
        "endLine": 13,
        "endChar": 55
      },
      "revId": "059108b8b9e0cc4fd86091f506d65808bb1c716c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dd2dc499_0c64e7d6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 13,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2023-11-24T10:26:55Z",
      "side": 1,
      "message": "What I meant here is that the _publishing_ is explicit (i.e. you explicitly hit on the `reply` button).\nBut you\u0027re right it does sound confusing, let me rephrase it.",
      "parentUuid": "609916a5_e06bb425",
      "range": {
        "startLine": 13,
        "startChar": 47,
        "endLine": 13,
        "endChar": 55
      },
      "revId": "059108b8b9e0cc4fd86091f506d65808bb1c716c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "08ea9eeb_1b49a5e1",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 29,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2023-11-24T08:57:32Z",
      "side": 1,
      "message": "Hi @nitzan@google.com, sorry to summon you on this change, hope you don\u0027t mind ðŸ˜Š\n\nI am currently working on this fix and I find it hard to pass the current user to the `ChangeDraftNodesUpdate.Executor`, in fact, I am not sure it is possible given the current interface constraints.\n\nWould you mind checking that my analysis is correct?\n\nIs there any room for modifying the current `ChangeDraftUpdateExecutor` without affecting any subclasses you guys might have implemented?\n\nThanks a lot for your input!",
      "range": {
        "startLine": 23,
        "startChar": 0,
        "endLine": 29,
        "endChar": 67
      },
      "revId": "059108b8b9e0cc4fd86091f506d65808bb1c716c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8f7d03a2_87cbcab9",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 29,
      "author": {
        "id": 1146706
      },
      "writtenOn": "2023-11-24T09:17:08Z",
      "side": 1,
      "message": "Hi, thanks for looping me in!\n\nWe\u0027d like to avoid adding NoteDb implementation details (e.g. repos/objectIds) to this and related interfaces. However, passing the `currentUser` SGTM.\n\nThat\u0027s assuming `currentUser` is injectable at `NoteDbUpdateManager` (the sole caller to this class), I see we do not currently inject it, or any other user ID there, but haven\u0027t looked closely to see if there\u0027s a blocker. I\u0027d guess some change and draft updates are not triggered by user actions though.",
      "parentUuid": "08ea9eeb_1b49a5e1",
      "range": {
        "startLine": 23,
        "startChar": 0,
        "endLine": 29,
        "endChar": 67
      },
      "revId": "059108b8b9e0cc4fd86091f506d65808bb1c716c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "04ce1c8a_9d405017",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 29,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2023-11-24T10:26:55Z",
      "side": 1,
      "message": "\u003e Hi, thanks for looping me in!\n\u003e \n\u003e We\u0027d like to avoid adding NoteDb implementation details (e.g. repos/objectIds) to this and related interfaces. However, passing the `currentUser` SGTM.\n\u003e \n\u003e That\u0027s assuming `currentUser` is injectable at `NoteDbUpdateManager` (the sole caller to this class), I see we do not currently inject it, or any other user ID there, but haven\u0027t looked closely to see if there\u0027s a blocker. I\u0027d guess some change and draft updates are not triggered by user actions though.\n\n`NoteDbUpdateManager` is built through a factory, so I could add the `currentUser` assisted argument to it (in fact, I have already done this in a previous patchset  [1] and that was working before I rebased on the latest 3.9).\n\nThe problem I am facing now is that the inner `Executor` class is static (so it will have no access to it).\n\nPassing a `currentUser` assisted argument directly to the `Executor.Factory.create()` is also not an option because its interface is defined by `ChangeDraftUpdateExecutor` to be argumentless (see [2]).\n\nThe above makes it impossible to pass current user at all, unless I missing something.\n\nWhat do you think?\n\n\n[1] https://gerrit-review.googlesource.com/c/gerrit/+/394417/3/java/com/google/gerrit/server/notedb/NoteDbUpdateManager.java\n\n[2] https://gerrit-review.googlesource.com/c/gerrit/+/393415",
      "parentUuid": "8f7d03a2_87cbcab9",
      "range": {
        "startLine": 23,
        "startChar": 0,
        "endLine": 29,
        "endChar": 67
      },
      "revId": "059108b8b9e0cc4fd86091f506d65808bb1c716c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ccbdaa1a_00b20d43",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 29,
      "author": {
        "id": 1146706
      },
      "writtenOn": "2023-11-24T10:30:12Z",
      "side": 1,
      "message": "\u003e Passing a currentUser assisted argument directly to the Executor.Factory.create() is also not an option because its interface is defined by ChangeDraftUpdateExecutor to be argumentless (see [2]).\n\nIt\u0027s OK to add the user ID to ChangeDraftUpdateExecutor creation method, I\u0027ll wire it for our implementation as well.",
      "parentUuid": "04ce1c8a_9d405017",
      "range": {
        "startLine": 23,
        "startChar": 0,
        "endLine": 29,
        "endChar": 67
      },
      "revId": "059108b8b9e0cc4fd86091f506d65808bb1c716c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}