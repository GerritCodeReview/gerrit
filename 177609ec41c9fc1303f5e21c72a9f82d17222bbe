{
  "comments": [
    {
      "key": {
        "uuid": "f8904e0b_9f033343",
        "filename": "Documentation/config-gerrit.txt",
        "patchSetId": 1
      },
      "lineNbr": 1707,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2015-07-10T04:26:17Z",
      "side": 1,
      "message": "Given that gerrit.war contains the docs i don\u0027t see any sense in suporting this and would handle unet and empty the same way.",
      "revId": "177609ec41c9fc1303f5e21c72a9f82d17222bbe",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f8904e0b_fff6ffcd",
        "filename": "Documentation/config-gerrit.txt",
        "patchSetId": 1
      },
      "lineNbr": 1710,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2015-07-10T04:26:17Z",
      "side": 1,
      "message": "Why not to tell the users the truth: Even when set, the web UI will query for `/Documentation/index.html` when the\napp loads and discard the value. One could argue, this is implementaton detail. But when a user investigates the network activity in her browser, that request is still executed, even though she provided the documntation URL. This may be confusing.",
      "range": {
        "startLine": 1709,
        "startChar": 0,
        "endLine": 1710,
        "endChar": 58
      },
      "revId": "177609ec41c9fc1303f5e21c72a9f82d17222bbe",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5333fdd6_aa01cf10",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/Gerrit.java",
        "patchSetId": 1
      },
      "lineNbr": 455,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2015-07-10T04:26:17Z",
      "side": 1,
      "message": "The same callback group is used for both requests. Do we garantuee that the order of callbacks invocation is preserved? Otherwise the line 438 would erroneouly override the corect value retrived and set on line 449.",
      "range": {
        "startLine": 434,
        "startChar": 4,
        "endLine": 455,
        "endChar": 7
      },
      "revId": "177609ec41c9fc1303f5e21c72a9f82d17222bbe",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5333fdd6_ea0bc72c",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/Gerrit.java",
        "patchSetId": 1
      },
      "lineNbr": 455,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2015-07-10T05:30:32Z",
      "side": 1,
      "message": "\u003e Do we garantuee that the order of callbacks invocation \n \u003e is preserved?\n\nYes, this is the purpose of callback group. It guarantees that the callbacks are executed in the correct order.",
      "parentUuid": "5333fdd6_aa01cf10",
      "range": {
        "startLine": 434,
        "startChar": 4,
        "endLine": 455,
        "endChar": 7
      },
      "revId": "177609ec41c9fc1303f5e21c72a9f82d17222bbe",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5333fdd6_4a1bf379",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/Gerrit.java",
        "patchSetId": 1
      },
      "lineNbr": 455,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2015-07-10T05:45:35Z",
      "side": 1,
      "message": "Indeed:\n\n  The enclosing group buffers returned results and ensures that\n  {@code onSuccess} is called exactly once for each callback \n  in the group, in the same order that callbacks were added.",
      "parentUuid": "5333fdd6_ea0bc72c",
      "range": {
        "startLine": 434,
        "startChar": 4,
        "endLine": 455,
        "endChar": 7
      },
      "revId": "177609ec41c9fc1303f5e21c72a9f82d17222bbe",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5333fdd6_8a232bb4",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/Gerrit.java",
        "patchSetId": 1
      },
      "lineNbr": 455,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2015-07-10T08:35:52Z",
      "side": 1,
      "message": "On second thought this looks like a bug to me and not a feature. The general use case is: the requests are independent from each other and all what is expected from CallbackGroup is to make sure that final callback is get called after all requests/callbacks in the group were processed. Making the exception from this rule: requests are always dependent as a default behavior is wrong assumption and means serious and unnecessary performance degradation.\n\nConsider two independent requests: R_1, R_2, and two corresponding callbacks C_1, C_2. For simplicity let say, that R_1 duration is 10 sec, R_2 \u003d 0, C_1 \u003d 0, C_2 \u003d 10.\n\nWith wrong dependent requests assumption (current CallbackGroup  implementation) the processing would take 20 sec, with this order of events:\n\n* R_1 (10) | R_2 (0)\n* C_1 (0)\n* C_2 (10)\n\nWith correct implementation (unordered callback invocation for independent requests) the processing would take 10 sec:\n\n* R_1 (10) | R_2 (0), C_2 (10)\n* C_1 (0)\n\nIOW: CallbackGroup should not preserve the order of the callback invocation per default. Of course, there should be a way to enforce the exception from this rule, e.g.: have OrderedCallbackGroup for that or other means.",
      "parentUuid": "5333fdd6_4a1bf379",
      "range": {
        "startLine": 434,
        "startChar": 4,
        "endLine": 455,
        "endChar": 7
      },
      "revId": "177609ec41c9fc1303f5e21c72a9f82d17222bbe",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f8904e0b_3f5f8741",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/Gerrit.java",
        "patchSetId": 1
      },
      "lineNbr": 455,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2015-07-10T08:44:36Z",
      "side": 1,
      "message": "\u003e With correct implementation (unordered callback \n \u003e invocation for independent requests) the processing \n \u003e would take 10 sec:\n\nIf you have independent requests, just don\u0027t use a callback group and you get this behaviour, don\u0027t you?",
      "parentUuid": "5333fdd6_8a232bb4",
      "range": {
        "startLine": 434,
        "startChar": 4,
        "endLine": 455,
        "endChar": 7
      },
      "revId": "177609ec41c9fc1303f5e21c72a9f82d17222bbe",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5333fdd6_ea22e7ac",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/Gerrit.java",
        "patchSetId": 1
      },
      "lineNbr": 455,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2015-07-10T08:59:43Z",
      "side": 1,
      "message": "Of course not: the final callback is still needed, because we have to do something (render a view) after all these independent requests/callbacks were processed and not before.\n\nAgain: these requirements have a final callback that is get called after all independent requests and their callbacks were processed and having dependent requests and process their callbacks in order of adding them to the callback group are orthogonal requirements and must not be put and assumed per default in generic CallbackGroup implementation.",
      "parentUuid": "f8904e0b_3f5f8741",
      "range": {
        "startLine": 434,
        "startChar": 4,
        "endLine": 455,
        "endChar": 7
      },
      "revId": "177609ec41c9fc1303f5e21c72a9f82d17222bbe",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f8904e0b_df63fb0f",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/Gerrit.java",
        "patchSetId": 1
      },
      "lineNbr": 455,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2015-07-10T09:26:57Z",
      "side": 1,
      "message": "\"Talk is cheap. Show me the code\": Here is the correct implementation of CallbackGroup in ECMAScript 6 with OOP-style class syntax:\n\n  class CallbackGroup {\n    constructor(doneCallback) {\n      // final callback to be called when all requests/callbacks were processed\n      this.doneCallback \u003d doneCallback;\n      this.counter \u003d 0;\n    }\n    add(callback) {\n      this.counter++;\n      return function () {\n        // call own callback\n        callback.apply(this, arguments);\n        // is this callback the last one?\n        this.counter--;\n        if (this.counter \u003d\u003d\u003d 0) {\n          // call final callback when all requests were processed\n          this.doneCallback();\n        }\n      }\n    }\n  }",
      "parentUuid": "5333fdd6_ea22e7ac",
      "range": {
        "startLine": 434,
        "startChar": 4,
        "endLine": 455,
        "endChar": 7
      },
      "revId": "177609ec41c9fc1303f5e21c72a9f82d17222bbe",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f8904e0b_ff603f05",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/Gerrit.java",
        "patchSetId": 1
      },
      "lineNbr": 455,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2015-07-10T09:39:54Z",
      "side": 1,
      "message": "\u003e Of course not: the final callback is still needed,   \n \u003e because we have to do something (render a view) after \n \u003e all these independent requests/callbacks were processed \n \u003e and not before.\n\nOK, if this is the requirement (do n independent requests/callbacks and then have 1 final callback in the end) then CallbackGroup needs to be adapted for this. But we must keep the possibility to enforce the order of callbacks since current code relies on it.",
      "parentUuid": "f8904e0b_df63fb0f",
      "range": {
        "startLine": 434,
        "startChar": 4,
        "endLine": 455,
        "endChar": 7
      },
      "revId": "177609ec41c9fc1303f5e21c72a9f82d17222bbe",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f8904e0b_dff9bbbe",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/config/GetServerInfo.java",
        "patchSetId": 1
      },
      "lineNbr": 99,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2015-07-10T04:26:17Z",
      "side": 1,
      "message": "Are we going to bother the user with such a details?\n\n  docUrl \u003d CharMatcher.is(\u0027/\u0027).trimFrom(docUrl) + \"/\";\n\nLike in all other places in the code.",
      "range": {
        "startLine": 98,
        "startChar": 4,
        "endLine": 99,
        "endChar": 57
      },
      "revId": "177609ec41c9fc1303f5e21c72a9f82d17222bbe",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f8904e0b_df221bdd",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/config/GetServerInfo.java",
        "patchSetId": 1
      },
      "lineNbr": 99,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2015-07-10T05:30:32Z",
      "side": 1,
      "message": "I also think that we should just append the \"/\" if it is missing.",
      "parentUuid": "f8904e0b_dff9bbbe",
      "range": {
        "startLine": 98,
        "startChar": 4,
        "endLine": 99,
        "endChar": 57
      },
      "revId": "177609ec41c9fc1303f5e21c72a9f82d17222bbe",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}