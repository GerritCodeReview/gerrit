{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "83cbaad4_f961efe5",
        "filename": "java/com/google/gerrit/server/notedb/ChangeNotesCache.java",
        "patchSetId": 1
      },
      "lineNbr": 379,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2024-01-11T11:55:54Z",
      "side": 0,
      "message": "I am puzzled by this assignment: this is a side-effect outside the contract of the loader.\n\nThe `Loader.call()` contract is to load the value from the persistence layer, how come that stores the revision note map as instance variable shared across threads?",
      "range": {
        "startLine": 379,
        "startChar": 6,
        "endLine": 379,
        "endChar": 52
      },
      "revId": "18408fb7e2366695660f685a9016fe783203073d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "84bf5079_bf07c5c2",
        "filename": "java/com/google/gerrit/server/notedb/ChangeUpdate.java",
        "patchSetId": 1
      },
      "lineNbr": 631,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2024-01-11T11:55:54Z",
      "side": 0,
      "message": "I believe this is the culprit: instead of reading the revision note map from the storage, we create one based on the one cached in the loader instance variable.\n\nCould we reduce this change to only this bit and still get the fix working?",
      "range": {
        "startLine": 628,
        "startChar": 0,
        "endLine": 631,
        "endChar": 7
      },
      "revId": "18408fb7e2366695660f685a9016fe783203073d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6607df33_ced70ec7",
        "filename": "javatests/com/google/gerrit/server/notedb/ChangeNotesTest.java",
        "patchSetId": 1
      },
      "lineNbr": 1968,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2024-01-11T11:55:54Z",
      "side": 0,
      "message": "Why do we need also to change the test? Was this added for triggering a side-effect in the way the change notes are loaded?",
      "revId": "18408fb7e2366695660f685a9016fe783203073d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}