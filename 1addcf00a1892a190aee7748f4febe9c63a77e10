{
  "comments": [
    {
      "key": {
        "uuid": "bc29d568_a50125b9",
        "filename": "/COMMIT_MSG",
        "patchSetId": 8
      },
      "lineNbr": 26,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2019-09-27T07:34:54Z",
      "side": 1,
      "message": "This is confusing to me, can you please clarify this.\n\nOn the one side you talk about 2 external IDs that have the same email (both belonging to the same account), and then you name them preferred e-mail and \u0027mailto:\u0027 record. The preferred email is not an external ID. If an account has several emails via external IDs, then the user can select one of these emails as preferred email which is then stored in account.config. Hence it is mandatory that the email that the user has a preferred email also exists as external ID. I think you are using preferred email as term for another external ID, which confusing.",
      "range": {
        "startLine": 24,
        "startChar": 0,
        "endLine": 26,
        "endChar": 72
      },
      "revId": "1addcf00a1892a190aee7748f4febe9c63a77e10",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "89798eab_3a4465cb",
        "filename": "/COMMIT_MSG",
        "patchSetId": 8
      },
      "lineNbr": 26,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-09-27T07:51:43Z",
      "side": 1,
      "message": "\u003e This is confusing to me, can you please clarify this.\n\u003e \n\u003e On the one side you talk about 2 external IDs that have the same email (both belonging to the same account), and then you name them preferred e-mail and \u0027mailto:\u0027 record.\n\nYes, that is very confusing in Gerrit: the overall design problem has been highlighted by \n Andrew in the Issue 11246. The email should never be an attribute of the account but always a mailto: external id. As a matter of fact, Gerrit considers the email in the gerrit: record as an external id, even if it isn\u0027t really a proper external id.\n\nI believe we should fix this design issue (coming from the very beginning of Gerrit) in master, but that would require data migration and can\u0027t be done in a stable branch.\n\n\u003e The preferred email is not an external ID. \n\nThat\u0027s the issue, exactly. And that\u0027s why different part of Gerrit are getting confused.\n\n\u003e If an account has several emails via external IDs, then the user can select one of these emails as preferred email which is then stored in account.config.\n\nYes, and *that* is the use-case that doesn\u0027t work at all. If you have an external id you cannot flag it anymore as preferred because it will be found in the list of external ids that the account has and an exception is thrown.\n\n\u003e Hence it is mandatory that the email that the user has a preferred email also exists as external ID.\n\nActually, this is the way it works today and has always been working with LDAP. The LDAP authentication sets the preferred e-mail in the account without creating an external ID. Actually, that\u0027s the ONLY use-case that works without my fix.\n\n\u003e I think you are using preferred email as term for another external ID, which confusing.\n\nI agree, but that\u0027s not me, it\u0027s Gerrit that has this design mismatch, which has lead to the confusion in the code and hence created a bug.\n\nHope this clarifies the issue.",
      "parentUuid": "bc29d568_a50125b9",
      "range": {
        "startLine": 24,
        "startChar": 0,
        "endLine": 26,
        "endChar": 72
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "1addcf00a1892a190aee7748f4febe9c63a77e10",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "925f05e0_f4667440",
        "filename": "javatests/com/google/gerrit/acceptance/api/accounts/AccountManagerIT.java",
        "patchSetId": 8
      },
      "lineNbr": 441,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2019-09-27T06:58:26Z",
      "side": 1,
      "message": "Still not removed, same comment as in previous patch set.",
      "range": {
        "startLine": 441,
        "startChar": 2,
        "endLine": 441,
        "endChar": 15
      },
      "revId": "1addcf00a1892a190aee7748f4febe9c63a77e10",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c1a861b2_f3a114fc",
        "filename": "javatests/com/google/gerrit/acceptance/api/accounts/AccountManagerIT.java",
        "patchSetId": 8
      },
      "lineNbr": 441,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-09-27T07:51:43Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "925f05e0_f4667440",
      "range": {
        "startLine": 441,
        "startChar": 2,
        "endLine": 441,
        "endChar": 15
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "1addcf00a1892a190aee7748f4febe9c63a77e10",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}