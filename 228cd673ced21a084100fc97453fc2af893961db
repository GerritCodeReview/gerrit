{
  "comments": [
    {
      "key": {
        "uuid": "ca1f0c44_e413fa2c",
        "filename": "gerrit-httpd/src/main/java/com/google/gerrit/httpd/GitOverHttpServlet.java",
        "patchSetId": 13
      },
      "lineNbr": 236,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2014-05-16T20:40:01Z",
      "side": 1,
      "message": "instead",
      "range": {
        "startLine": 236,
        "startChar": 37,
        "endLine": 236,
        "endChar": 45
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0a26849c_46869202",
        "filename": "gerrit-httpd/src/main/java/com/google/gerrit/httpd/GitOverHttpServlet.java",
        "patchSetId": 13
      },
      "lineNbr": 236,
      "author": {
        "id": 1012612
      },
      "writtenOn": "2014-05-17T21:03:41Z",
      "side": 1,
      "message": "That was a clever typo of mine. :) Fixed.",
      "parentUuid": "ca1f0c44_e413fa2c",
      "range": {
        "startLine": 236,
        "startChar": 37,
        "endLine": 236,
        "endChar": 45
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ca1f0c44_4403eed9",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/validators/UploadValidationListener.java",
        "patchSetId": 13
      },
      "lineNbr": 56,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2014-05-16T20:40:01Z",
      "side": 1,
      "message": "Maybe avoid an own exception class and just throw a ValidationException as all the other ValidationListener do? This ValidationException could then be caught and wrapped into a ServiceMayNotContinueException in UploadValidators.onSendPack(...).",
      "range": {
        "startLine": 56,
        "startChar": 13,
        "endLine": 56,
        "endChar": 38
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2a3188d1_27b7dac5",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/validators/UploadValidationListener.java",
        "patchSetId": 13
      },
      "lineNbr": 56,
      "author": {
        "id": 1012612
      },
      "writtenOn": "2014-05-17T21:03:41Z",
      "side": 1,
      "message": "I agree... We don\u0027t need a thin wrapper, and we should use a ServiceMayNotContinueException when coming out of our handler.",
      "parentUuid": "ca1f0c44_4403eed9",
      "range": {
        "startLine": 56,
        "startChar": 13,
        "endLine": 56,
        "endChar": 38
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2a3188d1_6709d28e",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/validators/UploadValidationListener.java",
        "patchSetId": 13
      },
      "lineNbr": 56,
      "author": {
        "id": 1012987
      },
      "writtenOn": "2014-05-20T13:04:40Z",
      "side": 1,
      "message": "The reason why I created an UploadValidationException, which extends ServiceMayNotContinueException, is to be able to only catch exception thrown by this extension and return the message to the client without printing a stack trace in the server logs.\n\nIf you change this you will end up swallowing all the possible ServiceMayNotContinueException. I know that currently, only this code register a UploadPack preUploadHook but if later we register another one in the Gerrit code, we will expect an ServiceMayNotContinueException and it will be swallowed.",
      "parentUuid": "2a3188d1_27b7dac5",
      "range": {
        "startLine": 56,
        "startChar": 13,
        "endLine": 56,
        "endChar": 38
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0a26849c_066d7a41",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/validators/UploadValidationListener.java",
        "patchSetId": 13
      },
      "lineNbr": 56,
      "author": {
        "id": 1012612
      },
      "writtenOn": "2014-05-20T13:10:22Z",
      "side": 1,
      "message": "Ah, I see that now.  I must have missed what it was inheriting from (I thought it was just a generic ValidationException subclass, as the name implies).  I\u0027m not firmly opposed to either way... I think the only thing that can throw a ServiceMayNotContinueException is the hook (or the chain), though?  In either case, wouldn\u0027t we want the same handling of passing it down to the client and cleaning up the server connection?",
      "parentUuid": "2a3188d1_6709d28e",
      "range": {
        "startLine": 56,
        "startChar": 13,
        "endLine": 56,
        "endChar": 38
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2a3188d1_e715c2a2",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/validators/UploadValidationListener.java",
        "patchSetId": 13
      },
      "lineNbr": 56,
      "author": {
        "id": 1012987
      },
      "writtenOn": "2014-05-20T13:21:05Z",
      "side": 1,
      "message": "With my initial solution (UploadValidationException inheriting ServiceMayNotContinueException), the extension point implementations are throwing UploadValidationException which is handled by JGit (sending message back to client also done by JGit) and on the other side, the Upload command class is swallowing the UploadValidationException to prevent printing a stacktrace in the logs.\n\nLets say that some other code add a hook in the chain which end up throwing a ServiceMayNotContinueException, maybe we want to see the stacktrace in the logs? I do not like the fact that this extension point code take the ownership of handling all the ServiceMayNotContinueException.",
      "parentUuid": "0a26849c_066d7a41",
      "range": {
        "startLine": 56,
        "startChar": 13,
        "endLine": 56,
        "endChar": 38
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2a3188d1_072bb6e7",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/validators/UploadValidationListener.java",
        "patchSetId": 13
      },
      "lineNbr": 56,
      "author": {
        "id": 1012612
      },
      "writtenOn": "2014-05-20T13:27:24Z",
      "side": 1,
      "message": "I\u0027m okay with changing it back, but may not hurt to let the others weigh in first. :)",
      "parentUuid": "2a3188d1_e715c2a2",
      "range": {
        "startLine": 56,
        "startChar": 13,
        "endLine": 56,
        "endChar": 38
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2a3188d1_2728bae8",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/validators/UploadValidationListener.java",
        "patchSetId": 13
      },
      "lineNbr": 56,
      "author": {
        "id": 1012987
      },
      "writtenOn": "2014-05-20T13:31:12Z",
      "side": 1,
      "message": "Sure, let\u0027s wait for Edwin to comment.",
      "parentUuid": "2a3188d1_072bb6e7",
      "range": {
        "startLine": 56,
        "startChar": 13,
        "endLine": 56,
        "endChar": 38
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff51f41e_e6307edb",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/validators/UploadValidationListener.java",
        "patchSetId": 13
      },
      "lineNbr": 56,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2014-05-22T07:09:36Z",
      "side": 1,
      "message": "I\u0027m not sure if I understand the problem. Can\u0027t we throw a normal com.google.gerrit.server.validators.ValidationException here and wrap it into a UploadValidationException that extends ServiceMayNotContinueException in UploadValidators.onSendPack(...). Then you can still catch this specific exception, but the UploadValidationListener interface would be consistent with the other ValidationListener interfaces that all throw com.google.gerrit.server.validators.ValidationException\u0027s.",
      "parentUuid": "2a3188d1_2728bae8",
      "range": {
        "startLine": 56,
        "startChar": 13,
        "endLine": 56,
        "endChar": 38
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ea221089_a5be5ec1",
        "filename": "gerrit-sshd/src/main/java/com/google/gerrit/sshd/commands/Upload.java",
        "patchSetId": 13
      },
      "lineNbr": 73,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2014-05-16T20:40:01Z",
      "side": 1,
      "message": "Maybe we should log it as a warning?",
      "range": {
        "startLine": 73,
        "startChar": 34,
        "endLine": 73,
        "endChar": 64
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0a26849c_66838ef1",
        "filename": "gerrit-sshd/src/main/java/com/google/gerrit/sshd/commands/Upload.java",
        "patchSetId": 13
      },
      "lineNbr": 73,
      "author": {
        "id": 1012612
      },
      "writtenOn": "2014-05-17T21:03:41Z",
      "side": 1,
      "message": "Actually, if we throw the UploadMayNotContinueException, JGit doesn\u0027t swallow it, but it does tell us if it\u0027s been output to the client... so we should check for this and return the appropriate error to the client if it hasn\u0027t been output.\n\nBut otherwise, no, I don\u0027t think it deserves a warning.  I\u0027d consider this a \"success\" of a plugin, really, although if the plugin needs to output a warning, it probably should inject a logger and log as appropriate.",
      "parentUuid": "ea221089_a5be5ec1",
      "range": {
        "startLine": 73,
        "startChar": 34,
        "endLine": 73,
        "endChar": 64
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff51f41e_2627b6a8",
        "filename": "gerrit-sshd/src/main/java/com/google/gerrit/sshd/commands/Upload.java",
        "patchSetId": 13
      },
      "lineNbr": 73,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2014-05-22T07:09:36Z",
      "side": 1,
      "message": "I agree, returning the message to the client is better. Then we don\u0027t want any log.",
      "parentUuid": "0a26849c_66838ef1",
      "range": {
        "startLine": 73,
        "startChar": 34,
        "endLine": 73,
        "endChar": 64
      },
      "revId": "228cd673ced21a084100fc97453fc2af893961db",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}