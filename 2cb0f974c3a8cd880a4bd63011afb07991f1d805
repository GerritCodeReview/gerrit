{
  "comments": [
    {
      "key": {
        "uuid": "b031d818_62415656",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/server/mail/MailMetadataIT.java",
        "patchSetId": 2
      },
      "lineNbr": 136,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2016-11-15T00:23:29Z",
      "side": 1,
      "message": "Is there a constant for this?",
      "range": {
        "startLine": 136,
        "startChar": 26,
        "endLine": 136,
        "endChar": 31
      },
      "revId": "2cb0f974c3a8cd880a4bd63011afb07991f1d805",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f0a51083_e49c1a5a",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/server/mail/MailMetadataIT.java",
        "patchSetId": 2
      },
      "lineNbr": 136,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2016-11-15T07:33:12Z",
      "side": 1,
      "message": "Actually, should we be fixing this to UTC?  Time stamps from gerrit-review are UTC but isn\u0027t that simply because the server\u0027s local time is UTC?",
      "parentUuid": "b031d818_62415656",
      "range": {
        "startLine": 136,
        "startChar": 26,
        "endLine": 136,
        "endChar": 31
      },
      "revId": "2cb0f974c3a8cd880a4bd63011afb07991f1d805",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b031d818_a54d28e4",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/mail/send/CommentSender.java",
        "patchSetId": 2
      },
      "lineNbr": 141,
      "author": {
        "id": 1026519
      },
      "writtenOn": "2016-11-15T17:40:01Z",
      "side": 1,
      "message": "Why timestamp rather than GUID or other unique identifier?",
      "range": {
        "startLine": 141,
        "startChar": 7,
        "endLine": 141,
        "endChar": 47
      },
      "revId": "2cb0f974c3a8cd880a4bd63011afb07991f1d805",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f0a51083_67490cd1",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/mail/send/CommentSender.java",
        "patchSetId": 2
      },
      "lineNbr": 141,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2016-11-15T17:52:27Z",
      "side": 1,
      "message": "Yeah, that\u0027s a very good question actually. We currently have no UUID on a set of comments and just identify/group them by timestamp when we show them in the UI. We\u0027ve thought about changing that now on the fly to e.g. the commit SHA1 from NoteDb, but that might change as we rewrite history.\n\nI\u0027ve also considered taking the UUID from one of the comments, but then again behind the scenes we would do the same kind of magic with timestamps + UUIDs are a little ugly to the users given that we have this visible in the text version of the email. Sending/Parsing an RFC822 timestamp seemed to be the best choice between those in the end.",
      "parentUuid": "b031d818_a54d28e4",
      "range": {
        "startLine": 141,
        "startChar": 7,
        "endLine": 141,
        "endChar": 47
      },
      "revId": "2cb0f974c3a8cd880a4bd63011afb07991f1d805",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b031d818_c58b0cae",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/mail/send/CommentSender.java",
        "patchSetId": 2
      },
      "lineNbr": 141,
      "author": {
        "id": 1026519
      },
      "writtenOn": "2016-11-15T19:06:38Z",
      "side": 1,
      "message": "I see. Using the timestamp seems reasonable for most cases. Naturally, it may not work when two reviewers post comments at the same time -- or, more precisely, (and, in fact, more likely), the emails for those comments are generated at the same time.\n\nI expect the most robust approach would be to generate a unique UUID for posted groups of comments. (Along with the slightly-uglier plain-text emails.) I don\u0027t know what kind of impact that would have on storing comments though.\n\nSuch a UUID may also provide benefits to the UI message list, where we somewhat heuristically group comments together by timestamp. Occasionally, it groups them wrong when the timestamps are unlucky.",
      "parentUuid": "f0a51083_67490cd1",
      "revId": "2cb0f974c3a8cd880a4bd63011afb07991f1d805",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b031d818_2533d828",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/mail/send/CommentSender.java",
        "patchSetId": 2
      },
      "lineNbr": 141,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2016-11-16T00:49:01Z",
      "side": 1,
      "message": "You are right, if people send comments in the exact same second then we would have a larger list of comments (comments from both reviewers) when parsing the timestamp back and getting the comments from the Db. Although that will almost certainly not impact the parser as the list of candidate comments is just slightly larger and those won\u0027t match in the email.\n\nThe timestamp should reflect the time when a comment was posted and not when it was sent out though as it comes from ChangeSender::setChangeMessage\n\nI agree that in the long run we should move to a more unique ID. Let\u0027s plan to refactor this when we change how we identify grouped comments in the UI.",
      "parentUuid": "b031d818_c58b0cae",
      "revId": "2cb0f974c3a8cd880a4bd63011afb07991f1d805",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b031d818_055b34a0",
        "filename": "gerrit-server/src/main/resources/com/google/gerrit/server/mail/CommentFooterHtml.soy",
        "patchSetId": 2
      },
      "lineNbr": 32,
      "author": {
        "id": 1026519
      },
      "writtenOn": "2016-11-15T17:40:01Z",
      "side": 1,
      "message": "Might as well put both in the same P element.",
      "range": {
        "startLine": 30,
        "startChar": 2,
        "endLine": 32,
        "endChar": 28
      },
      "revId": "2cb0f974c3a8cd880a4bd63011afb07991f1d805",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b031d818_0532144e",
        "filename": "gerrit-server/src/main/resources/com/google/gerrit/server/mail/CommentFooterHtml.soy",
        "patchSetId": 2
      },
      "lineNbr": 32,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2016-11-15T17:52:27Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b031d818_055b34a0",
      "range": {
        "startLine": 30,
        "startChar": 2,
        "endLine": 32,
        "endChar": 28
      },
      "revId": "2cb0f974c3a8cd880a4bd63011afb07991f1d805",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}