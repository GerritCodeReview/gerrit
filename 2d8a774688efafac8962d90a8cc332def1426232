{
  "comments": [
    {
      "key": {
        "uuid": "70e76057_e02fa24e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 4
      },
      "lineNbr": 12,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-11-25T10:46:12Z",
      "side": 1,
      "message": "I know, that I was saying that you should ignore this existing bug when implementing the support for the magic refs/changes/YY/XXXXXXX/current ref. However looking at this now, I think this might be a bad idea.\n\nAt the moment users always go to the WebUI and copy the fetch command from the download commands section on the change screen. Since in the UI users only see draft patch sets that they are supposed to see, it cannot happen that they copy a fetch command for a draft patch set that they cannot see. This is why it\u0027s currently not a big problem that VisibleRefFilter is leaking the refs for all draft patch sets. To get a draft patch set of another user, you must know about this bug and manually construct a fetch command. If I do this I\u0027m aware of getting a draft patch set of another user that I\u0027m not supposed to see.\n\nBy supporting refs/changes/YY/XXXXXXX/current this becomes much more of an issue, because users expect this ref to return the latest patch set that they see in the UI. If it sometimes returns draft patch sets of other users that are not visible to the calling user, this gets very confusing to the calling user. Also if users start using refs/changes/YY/XXXXXXX/current it will happen much more often that users now see draft patch sets that they are not supposed to see.\n\nI\u0027m afraid that this means, either of the following:\n\n1. VisibleRefFilter must be fixed no not leak draft patch sets of other users. This should be done as a predecessor change, but is difficult to do without bad performance impacts.\n2. We drop support for draft patch sets before this change goes in.\n3. refs/changes/YY/XXXXXXX/current never resolves to draft patch sets of other users. Again this is probably difficult to do without impacting performance.",
      "range": {
        "startLine": 10,
        "startChar": 33,
        "endLine": 12,
        "endChar": 65
      },
      "revId": "2d8a774688efafac8962d90a8cc332def1426232",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "50ec1c3c_1fef83cf",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git/RefAdvertisementIT.java",
        "patchSetId": 4
      },
      "lineNbr": 430,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-11-25T10:46:12Z",
      "side": 1,
      "message": "This seems to be unneeded, why don\u0027t you use \u0027project\u0027 which is created by the test framework?",
      "range": {
        "startLine": 429,
        "startChar": 4,
        "endLine": 430,
        "endChar": 68
      },
      "revId": "2d8a774688efafac8962d90a8cc332def1426232",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "50ec1c3c_3ff247b9",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git/RefAdvertisementIT.java",
        "patchSetId": 4
      },
      "lineNbr": 434,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-11-25T10:46:12Z",
      "side": 1,
      "message": "Why \u0027mr1\u0027? Just name this \u0027r1\u0027 for result 1?",
      "range": {
        "startLine": 434,
        "startChar": 25,
        "endLine": 434,
        "endChar": 28
      },
      "revId": "2d8a774688efafac8962d90a8cc332def1426232",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "50ec1c3c_dfdcfb33",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git/RefAdvertisementIT.java",
        "patchSetId": 4
      },
      "lineNbr": 440,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-11-25T10:46:12Z",
      "side": 1,
      "message": "Not sure what \u0027mcStr\u0027 means. Just name this \u0027changeRefPrefix\u0027?",
      "range": {
        "startLine": 440,
        "startChar": 11,
        "endLine": 440,
        "endChar": 16
      },
      "revId": "2d8a774688efafac8962d90a8cc332def1426232",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70e76057_00744674",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git/RefAdvertisementIT.java",
        "patchSetId": 4
      },
      "lineNbr": 444,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-11-25T10:46:12Z",
      "side": 1,
      "message": "Remove this? This shouldn\u0027t be needed.",
      "range": {
        "startLine": 444,
        "startChar": 8,
        "endLine": 444,
        "endChar": 56
      },
      "revId": "2d8a774688efafac8962d90a8cc332def1426232",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70e76057_408e4e50",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git/RefAdvertisementIT.java",
        "patchSetId": 4
      },
      "lineNbr": 457,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-11-25T10:46:12Z",
      "side": 1,
      "message": "Extract this into a method so that you don\u0027t need to repeat the same code in the test below.",
      "range": {
        "startLine": 446,
        "startChar": 3,
        "endLine": 457,
        "endChar": 51
      },
      "revId": "2d8a774688efafac8962d90a8cc332def1426232",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70e76057_e078426c",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git/RefAdvertisementIT.java",
        "patchSetId": 4
      },
      "lineNbr": 463,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-11-25T10:46:12Z",
      "side": 1,
      "message": "not needed?",
      "range": {
        "startLine": 462,
        "startChar": 3,
        "endLine": 463,
        "endChar": 68
      },
      "revId": "2d8a774688efafac8962d90a8cc332def1426232",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "50ec1c3c_7feccfd8",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git/RefAdvertisementIT.java",
        "patchSetId": 4
      },
      "lineNbr": 483,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-11-25T10:46:12Z",
      "side": 1,
      "message": "not needed",
      "range": {
        "startLine": 482,
        "startChar": 52,
        "endLine": 483,
        "endChar": 56
      },
      "revId": "2d8a774688efafac8962d90a8cc332def1426232",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}