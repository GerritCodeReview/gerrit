{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "300b5ff3_4476420f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 24
      },
      "lineNbr": 0,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-05-06T10:01:29Z",
      "side": 1,
      "message": "Looks good overall!",
      "revId": "2de2842194c6a411021cc8e81bc75e76b1f3493d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "040a53e8_f19bfaa7",
        "filename": "Documentation/access-control.txt",
        "patchSetId": 24
      },
      "lineNbr": 483,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-05-05T16:36:17Z",
      "side": 1,
      "message": "nit: This is done, since git branches are case sensitive, so that sandbox branches (computed from the username) are still reachable by the users.",
      "range": {
        "startLine": 483,
        "startChar": 17,
        "endLine": 483,
        "endChar": 32
      },
      "revId": "2de2842194c6a411021cc8e81bc75e76b1f3493d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c838045f_ffa1f27f",
        "filename": "Documentation/access-control.txt",
        "patchSetId": 24
      },
      "lineNbr": 483,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2021-05-06T11:16:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "040a53e8_f19bfaa7",
      "range": {
        "startLine": 483,
        "startChar": 17,
        "endLine": 483,
        "endChar": 32
      },
      "revId": "2de2842194c6a411021cc8e81bc75e76b1f3493d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "314839d9_6f84a1f2",
        "filename": "java/com/google/gerrit/server/account/externalids/ExternalId.java",
        "patchSetId": 24
      },
      "lineNbr": 151,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-05-05T16:36:17Z",
      "side": 1,
      "message": "same as for the ExternalId, either move to factory or move factory here?",
      "range": {
        "startLine": 151,
        "startChar": 22,
        "endLine": 151,
        "endChar": 28
      },
      "revId": "2de2842194c6a411021cc8e81bc75e76b1f3493d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8d01740a_308b5285",
        "filename": "java/com/google/gerrit/server/account/externalids/ExternalId.java",
        "patchSetId": 24
      },
      "lineNbr": 151,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2021-05-06T11:16:01Z",
      "side": 1,
      "message": "The factory\u0027s purpose is to create external id keys, while respecting the Gerrit configuration. This method however explicitly ignores the configuration and allows to overwrite it. This is kind of against the purpose of the factory.\n\nAnd as you said in another comment, it would also move the AutoValue constructor call into a class other than the AutoValue class, which would work, but doesn\u0027t fit the usual pattern.",
      "parentUuid": "314839d9_6f84a1f2",
      "range": {
        "startLine": 151,
        "startChar": 22,
        "endLine": 151,
        "endChar": 28
      },
      "revId": "2de2842194c6a411021cc8e81bc75e76b1f3493d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "380da6de_7802158b",
        "filename": "java/com/google/gerrit/server/account/externalids/ExternalId.java",
        "patchSetId": 24
      },
      "lineNbr": 151,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2021-05-06T13:02:49Z",
      "side": 1,
      "message": "Having a static factory method inside an AutoValue class is a standard idiom [1].\nI would propose to keep the code as-is for now and discuss moving the factory methods in a new change.\n\n@Marija: if we can agree on that I would give CR+2 on this change.\n\n[1] https://github.com/google/auto/blob/master/value/userguide/index.md#in-your-value-class",
      "parentUuid": "8d01740a_308b5285",
      "range": {
        "startLine": 151,
        "startChar": 22,
        "endLine": 151,
        "endChar": 28
      },
      "revId": "2de2842194c6a411021cc8e81bc75e76b1f3493d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e36d1467_a1a8fd6e",
        "filename": "java/com/google/gerrit/server/account/externalids/ExternalId.java",
        "patchSetId": 24
      },
      "lineNbr": 228,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-05-05T16:36:17Z",
      "side": 1,
      "message": "move to Factory?",
      "range": {
        "startLine": 228,
        "startChar": 2,
        "endLine": 228,
        "endChar": 26
      },
      "revId": "2de2842194c6a411021cc8e81bc75e76b1f3493d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ebce4da2_b08346f0",
        "filename": "java/com/google/gerrit/server/account/externalids/ExternalId.java",
        "patchSetId": 24
      },
      "lineNbr": 228,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2021-05-06T11:16:01Z",
      "side": 1,
      "message": "See my response on your other comment.",
      "parentUuid": "e36d1467_a1a8fd6e",
      "range": {
        "startLine": 228,
        "startChar": 2,
        "endLine": 228,
        "endChar": 26
      },
      "revId": "2de2842194c6a411021cc8e81bc75e76b1f3493d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4f2d8576_d2584252",
        "filename": "java/com/google/gerrit/server/account/externalids/ExternalIdFactory.java",
        "patchSetId": 24
      },
      "lineNbr": 192,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-05-05T16:36:17Z",
      "side": 1,
      "message": "Even though this could be static, I think it makes sense to keep it non-static for consistency (same for all create methods, that belonged to ExternalIds before)\n\nHowever, as I understand you did not move\npublic static ExternalId create(\n      Key key,\n      Account.Id accountId,\n      @Nullable String email,\n      @Nullable String hashedPassword,\n      @Nullable ObjectId blobId)\n\nhere to avoid calling AutoValue constructor, but maybe just have all \u0027create\u0027 methods in Factory and have Factory and ExternalId in the same file?",
      "range": {
        "startLine": 192,
        "startChar": 2,
        "endLine": 192,
        "endChar": 20
      },
      "revId": "2de2842194c6a411021cc8e81bc75e76b1f3493d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "70346b53_cf926779",
        "filename": "java/com/google/gerrit/server/account/externalids/ExternalIdFactory.java",
        "patchSetId": 24
      },
      "lineNbr": 192,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2021-05-06T11:16:01Z",
      "side": 1,
      "message": "Moving the factory as a subclass to ExternalId would not work, since it would have to be static and this does not work with injecting the configuration to the factory.\nFurther, especially in tests, we need a way to create ExternalIds without relying on injection, which makes this factory methods useful.\nI fully agree however, that this seems quite dangerous in that it may lead to errors, because the configuration is by mistake not applied in some cases.",
      "parentUuid": "4f2d8576_d2584252",
      "range": {
        "startLine": 192,
        "startChar": 2,
        "endLine": 192,
        "endChar": 20
      },
      "revId": "2de2842194c6a411021cc8e81bc75e76b1f3493d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9e109732_d6368d47",
        "filename": "java/com/google/gerrit/server/account/externalids/ExternalIdFactory.java",
        "patchSetId": 24
      },
      "lineNbr": 250,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-05-05T16:36:17Z",
      "side": 1,
      "message": "Could you, please, add a static method with \u0027isCaseInsensitive\u0027 option? That would be useful for testing.",
      "range": {
        "startLine": 250,
        "startChar": 20,
        "endLine": 250,
        "endChar": 25
      },
      "revId": "2de2842194c6a411021cc8e81bc75e76b1f3493d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7a76715c_cbbcfef0",
        "filename": "java/com/google/gerrit/server/account/externalids/ExternalIdFactory.java",
        "patchSetId": 24
      },
      "lineNbr": 250,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2021-05-06T11:16:01Z",
      "side": 1,
      "message": "I don\u0027t want to add a method that is currently not used anywhere. A quick check showed that this should be easily possible by exchanging L264 with:\n\n  Key externalIdKey \u003d ExternalId.Key.parse(externalIdKeyStr, isCaseSensitive);\n\nand L284ff with:\n\n      return ExternalId.create(\n        externalIdKey,\n        Account.id(accountId),\n        Strings.emptyToNull(email),\n        Strings.emptyToNull(password),\n        blobId);\n\nwhile using the same logic as in the non-static method.\n\nIf you have some tests in mind, I would also implement them or add then to this change.",
      "parentUuid": "9e109732_d6368d47",
      "range": {
        "startLine": 250,
        "startChar": 20,
        "endLine": 250,
        "endChar": 25
      },
      "revId": "2de2842194c6a411021cc8e81bc75e76b1f3493d",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}