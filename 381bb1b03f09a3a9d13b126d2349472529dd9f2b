{
  "pushCert": "certificate version 0.1\npusher Dave Borowitz \u003cdborowitz@google.com\u003e 1492001684 -0400\nnonce AFMZ2GzxNLth1TlumFqfWBVN9i+/utLYbyWl04Ln3wBRLVLlHTdkuCdZ1MaIPU3BdSQKlYdSW5bp\n\n0000000000000000000000000000000000000000 381bb1b03f09a3a9d13b126d2349472529dd9f2b refs/for/master\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQIcBAABAgAGBQJY7iOUAAoJEF/XxZqaEoiMiKsP/37EjRZEDnC5Q3ShwHLiVVrD\nPnBPSOVG9pqJdFtNd+M/Q7GWzgnehXlLP6vNf9ATOgnhtJe/wlIPepjzpgso44Or\nPYHijp8a0KxasPXQU3H8KGxvnKm0YuSXSivziZ4e8/Fel24YWnl66KhDCxvPXg0b\nYwMjDDQuvnvi3OPIE+hClcmnnteDlHHdSxy8dRYhrMnmoj7dVsjJjHio0GIE8pHo\ntifjrJf3Lo7qA3ASZ30IGbzy7Mh3Esnw2/l/rDR5NEJ0g2qT3LyFHwJ27PLQ25sJ\nRopXYyqzAKOlPa9xE9wkZI5aWRA2gm8Z0zhiJek9FZ1YaCo4jClblMZ++wUIMjKO\nylM0blodIaSTMOCzQEF8oK1gLoMrUJbqZoRHnL8cK7fCYFueVBzEoJLUoLAyHpET\nyi4rgSMSSC/rL04BKAk9MZDJodgGSInJ24C4vpV1mm72DNPmqTwdZvM4ozqFw6vO\nzGEeoKh3ja8vwqztX3gyCcGH0EmcFqV5LcF+mMjEinZm7y/7q993tDInKQr3Vtjo\neN550Nrlz2ZtOy4I72OZqCyT2xr/Iydnvg5ucSehqpmiXAsNruWu8VQH1J0uv5zn\nLXKApnjqp54vGPr9wKf9TipphMysmJhbMfNXL8mL5i/hpNqp92H2XzBoioKG2IMF\n1ZZHO61OL+5e9us8n30K\n\u003dMfGS\n-----END PGP SIGNATURE-----\n",
  "comments": [
    {
      "key": {
        "uuid": "9fab10ad_1904b7cd",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/NoteDbBatchUpdate.java",
        "patchSetId": 8
      },
      "lineNbr": 425,
      "author": {
        "id": 1030912
      },
      "writtenOn": "2017-04-12T14:10:28Z",
      "side": 1,
      "message": "optional: Isn\u0027t this the same as\n\ncatch (Exception e) {\n    handle.close();\n    throw e;\n}\n\n?",
      "range": {
        "startLine": 421,
        "startChar": 5,
        "endLine": 425,
        "endChar": 5
      },
      "revId": "381bb1b03f09a3a9d13b126d2349472529dd9f2b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c302f048_41431406",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/NoteDbBatchUpdate.java",
        "patchSetId": 8
      },
      "lineNbr": 425,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-04-12T14:41:03Z",
      "side": 1,
      "message": "No, because finally will execute if a non-Exception Throwable is thrown. In fact I prefer this way precisely so we don\u0027t have to think about the exception hierarchy.",
      "parentUuid": "9fab10ad_1904b7cd",
      "range": {
        "startLine": 421,
        "startChar": 5,
        "endLine": 425,
        "endChar": 5
      },
      "revId": "381bb1b03f09a3a9d13b126d2349472529dd9f2b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "66329b6a_35c36458",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/NoteDbBatchUpdate.java",
        "patchSetId": 8
      },
      "lineNbr": 425,
      "author": {
        "id": 1030912
      },
      "writtenOn": "2017-04-12T14:58:23Z",
      "side": 1,
      "message": "Non-Exception Throwables should be Errors which according to the Javadoc of Error indicate \"abnormal conditions that should never occur\". If they do, we\u0027ll probably have other problems than an unclosed NoteDbUpdateManager. ;-)\nI don\u0027t mind having the boolean check.",
      "parentUuid": "c302f048_41431406",
      "range": {
        "startLine": 421,
        "startChar": 5,
        "endLine": 425,
        "endChar": 5
      },
      "revId": "381bb1b03f09a3a9d13b126d2349472529dd9f2b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9619eb29_19588923",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/NoteDbBatchUpdate.java",
        "patchSetId": 8
      },
      "lineNbr": 425,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-04-12T15:02:59Z",
      "side": 1,
      "message": "Yeah you don\u0027t even want to know how many places our code needs to catch StackOverflowError though :)",
      "parentUuid": "66329b6a_35c36458",
      "range": {
        "startLine": 421,
        "startChar": 5,
        "endLine": 425,
        "endChar": 5
      },
      "revId": "381bb1b03f09a3a9d13b126d2349472529dd9f2b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7d4693d3_b1b44ec4",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/NoteDbBatchUpdate.java",
        "patchSetId": 8
      },
      "lineNbr": 425,
      "author": {
        "id": 1030912
      },
      "writtenOn": "2017-04-12T15:17:34Z",
      "side": 1,
      "message": "If we make sure to close all loop holes here, shouldn\u0027t we also ensure that all non-closed NoteDbBatchUpdateManagers (of the remaining ChangeHandles) are closed if an exception is thrown in NoteDbBatchUpdateManager#execute for e.g. the first ChangeHandle or in NoteDbBatchUpdate#executeChangeOps for the last ChangeHandle? Maybe we should rather add a try-finally to NoteDbBatchUpdate#execute which encloses the switch-statement and call close() on all handles after they are fully processed. If they were already closed because of a successful operation, calling close() should be a no-op.",
      "parentUuid": "9619eb29_19588923",
      "range": {
        "startLine": 421,
        "startChar": 5,
        "endLine": 425,
        "endChar": 5
      },
      "revId": "381bb1b03f09a3a9d13b126d2349472529dd9f2b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0b273445_fd1e17c7",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/NoteDbBatchUpdate.java",
        "patchSetId": 8
      },
      "lineNbr": 425,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-04-12T15:38:19Z",
      "side": 1,
      "message": "Sadly, Repository produces logspam when you close it too many times, so it\u0027s not quite a no-op. But I think moving the try/finally up into execute is a fine idea anyway, and we can get rid of this.",
      "parentUuid": "7d4693d3_b1b44ec4",
      "range": {
        "startLine": 421,
        "startChar": 5,
        "endLine": 425,
        "endChar": 5
      },
      "revId": "381bb1b03f09a3a9d13b126d2349472529dd9f2b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a60c5d9d_f6814f5a",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/NoteDbBatchUpdate.java",
        "patchSetId": 8
      },
      "lineNbr": 425,
      "author": {
        "id": 1030912
      },
      "writtenOn": "2017-04-12T15:49:40Z",
      "side": 1,
      "message": "I was referring to NoteDbUpdateManager#close being a no-op after the first call. ;-)",
      "parentUuid": "0b273445_fd1e17c7",
      "range": {
        "startLine": 421,
        "startChar": 5,
        "endLine": 425,
        "endChar": 5
      },
      "revId": "381bb1b03f09a3a9d13b126d2349472529dd9f2b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e47a4085_d6fbe493",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/NoteDbBatchUpdate.java",
        "patchSetId": 8
      },
      "lineNbr": 425,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-04-12T15:51:45Z",
      "side": 1,
      "message": "I know. NoteDbUpdateManager#close calls OpenRepo#close calls Repository#close.",
      "parentUuid": "a60c5d9d_f6814f5a",
      "range": {
        "startLine": 421,
        "startChar": 5,
        "endLine": 425,
        "endChar": 5
      },
      "revId": "381bb1b03f09a3a9d13b126d2349472529dd9f2b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2c726e7c_f1d9b196",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/NoteDbBatchUpdate.java",
        "patchSetId": 8
      },
      "lineNbr": 425,
      "author": {
        "id": 1030912
      },
      "writtenOn": "2017-04-12T15:57:48Z",
      "side": 1,
      "message": "First call: NoteDbUpdateManager#close -\u003e openRepo#close + \"openRepo \u003d null\".\nSecond call: NoteDbUpdateManager#close -\u003e \"openRepo \u003d\u003d null\" -\u003e stop",
      "parentUuid": "e47a4085_d6fbe493",
      "range": {
        "startLine": 421,
        "startChar": 5,
        "endLine": 425,
        "endChar": 5
      },
      "revId": "381bb1b03f09a3a9d13b126d2349472529dd9f2b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "737eb9d2_18bca6d0",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/NoteDbBatchUpdate.java",
        "patchSetId": 8
      },
      "lineNbr": 425,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-04-12T16:27:55Z",
      "side": 1,
      "message": "Ah, indeed. Perfect.",
      "parentUuid": "2c726e7c_f1d9b196",
      "range": {
        "startLine": 421,
        "startChar": 5,
        "endLine": 425,
        "endChar": 5
      },
      "revId": "381bb1b03f09a3a9d13b126d2349472529dd9f2b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}