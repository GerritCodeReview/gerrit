{
  "comments": [
    {
      "key": {
        "uuid": "ab4dc25b_515e54be",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/editor/EditScreen.java",
        "patchSetId": 13
      },
      "lineNbr": 226,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2016-04-16T07:20:40Z",
      "side": 1,
      "message": "This logic: takes the content from the original patch set on non-edit (lines 259-261 added below) and call the GET diff REST handler on edit patch set is broken and only works as expected in one specific use case:\n\nWorking use case:\n\n* 1. open inline editor on non-edit patch set: original file is retrieved and put into cmOrig\n* 2. change the content in cmEdit\n* 3. save\n* 4. exit inline editor\n* 5. re-enter the same file: diff endpoint is correct and cmOrig/cmEdit have correct contents\n\nBroken use cases:\n\nScenario I: reverting the changes in the change edit (continue the above use case):\n\n* 6. revert changes\n* 7. save\n* 8. exit inline editor\n* 9. re-enter the same file: diff endpoint returns no content: no differences. The cmOrig is empty and the merge view errorneously shows that the whole content was added, even though there were no changes compared to base.\n\nScenario II: entering further files in inline editor after createing the change edit by changing first file:\n\n* 1. create change edit by modifying one file\n* 2. save\n* 3. exit\n* 4. enter inline editor for already existing change edit (revision.get() \u003d\u003d 0) for further files\n* 5. Diff API always returns no content: all files are rendered as new files, with no content in cmOrig\n\nOne way to fix it is not to use diff REST handler but use GET /changes/\u003cid\u003e/revisions/\u003cid\u003e/files/\u003cname\u003e/content handler instead, using EditInfo.base() you\u0027ve added in the previous change, something like:\n\n  ChangeEditApi.get(PatchSet.Id.fromRef(result.base()), path,\n      new HttpCallback\u003cNativeString\u003e() {\n  [...]",
      "range": {
        "startLine": 216,
        "startChar": 14,
        "endLine": 226,
        "endChar": 19
      },
      "revId": "3a3bd96cba503aa21ba4297f579eb3122bd7f8c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c8d2fce6_d2a3e4c3",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/editor/EditScreen.java",
        "patchSetId": 13
      },
      "lineNbr": 226,
      "author": {
        "id": 1012758
      },
      "writtenOn": "2016-04-18T18:37:24Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ab4dc25b_515e54be",
      "range": {
        "startLine": 216,
        "startChar": 14,
        "endLine": 226,
        "endChar": 19
      },
      "revId": "3a3bd96cba503aa21ba4297f579eb3122bd7f8c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ab4dc25b_f14e6811",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/editor/EditScreen.java",
        "patchSetId": 13
      },
      "lineNbr": 451,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2016-04-16T05:31:35Z",
      "side": 1,
      "message": "Wrong rebase. This should be cmEdit.",
      "range": {
        "startLine": 451,
        "startChar": 4,
        "endLine": 451,
        "endChar": 6
      },
      "revId": "3a3bd96cba503aa21ba4297f579eb3122bd7f8c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8b2d5e79_48313fc7",
        "filename": "lib/codemirror/BUCK",
        "patchSetId": 13
      },
      "lineNbr": 95,
      "author": {
        "id": 1006818
      },
      "writtenOn": "2016-04-16T04:52:59Z",
      "side": 1,
      "message": "It would be clear to say\n  \"Merge the JS file of merge addon with JS file of google-diff-match-patch\" \nas it is not all files of addons to merge and it is not CSS file of merge addon to merge.",
      "range": {
        "startLine": 95,
        "startChar": 2,
        "endLine": 95,
        "endChar": 45
      },
      "revId": "3a3bd96cba503aa21ba4297f579eb3122bd7f8c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8b2d5e79_8859770d",
        "filename": "lib/codemirror/BUCK",
        "patchSetId": 13
      },
      "lineNbr": 95,
      "author": {
        "id": 1006818
      },
      "writtenOn": "2016-04-16T05:11:33Z",
      "side": 1,
      "message": "It works to merge them together, while I would like to handle them separately (let merge.js in CM_ADDONS),  if google-diff-match-patch does not have minified version and that would be easy to maintenance.",
      "parentUuid": "8b2d5e79_48313fc7",
      "range": {
        "startLine": 95,
        "startChar": 2,
        "endLine": 95,
        "endChar": 45
      },
      "revId": "3a3bd96cba503aa21ba4297f579eb3122bd7f8c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8b2d5e79_084e6741",
        "filename": "lib/codemirror/BUCK",
        "patchSetId": 13
      },
      "lineNbr": 95,
      "author": {
        "id": 1012758
      },
      "writtenOn": "2016-04-16T08:39:08Z",
      "side": 1,
      "message": "If I put merge.js in CM_ADDONS then it will be include unconditionally in the bundled cm.js. This is not optimal because the DiffScreen doesn\u0027t use the addon - only the EditScreen does.\n\nBesides, the addon only works if diff-match-patch is present, so it makes sense to bundle them during the build process.\n\nI might also refactor how the other addons are loaded in a later change.",
      "parentUuid": "8b2d5e79_8859770d",
      "range": {
        "startLine": 95,
        "startChar": 2,
        "endLine": 95,
        "endChar": 45
      },
      "revId": "3a3bd96cba503aa21ba4297f579eb3122bd7f8c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8b2d5e79_c8536fe7",
        "filename": "lib/codemirror/BUCK",
        "patchSetId": 13
      },
      "lineNbr": 119,
      "author": {
        "id": 1006818
      },
      "writtenOn": "2016-04-16T05:11:33Z",
      "side": 1,
      "message": "maybe we should give it another name , avoid confusing with others addonS in CM_ADDONS",
      "range": {
        "startLine": 119,
        "startChar": 32,
        "endLine": 119,
        "endChar": 37
      },
      "revId": "3a3bd96cba503aa21ba4297f579eb3122bd7f8c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "68f5903c_5f814bc2",
        "filename": "lib/codemirror/BUCK",
        "patchSetId": 13
      },
      "lineNbr": 119,
      "author": {
        "id": 1012758
      },
      "writtenOn": "2016-04-16T08:39:08Z",
      "side": 1,
      "message": "The other addons are currently bundled with the main codemirror.js into cm.js so they don\u0027t go into addon/. I also renamed the file to be merge_bundled.js to make the alteration clear.",
      "parentUuid": "8b2d5e79_c8536fe7",
      "range": {
        "startLine": 119,
        "startChar": 32,
        "endLine": 119,
        "endChar": 37
      },
      "revId": "3a3bd96cba503aa21ba4297f579eb3122bd7f8c5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}