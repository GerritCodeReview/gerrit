{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "a2c15658_6c15606f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-08-30T18:11:17Z",
      "side": 1,
      "message": "This change looks good to me. Out of curiosity: what is the benefit of having \u0027is:attention\u0027 and \u0027has:attention\u0027 as aliases of \u0027attention:self\u0027 ?",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a0e76bdd_d6963848",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-08-31T13:43:10Z",
      "side": 1,
      "message": "+1, I\u0027m fine with this change but it feels a little redundant nevertheless.",
      "parentUuid": "a2c15658_6c15606f",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9670ab53_86815fab",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2021-08-31T14:57:35Z",
      "side": 1,
      "message": "I just realised that the task meant find all changes with an attention or ones without. do you know how I can do that please? similar to assignee. I tried the Account.id(-1) but that doesnâ€™t work.",
      "parentUuid": "a0e76bdd_d6963848",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fc577122_955566f6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-08-31T15:23:46Z",
      "side": 1,
      "message": "I think you can add a new ChangeField similar to the existing Attention set field(ATTENTION_SET_USERS):\nFieldDef\u003cChangeData, Integer\u003e ATTENTION_SET_USERS_COUNT\n\nThen you can make an attention set predicate (similar to IsUnresolvedPredicate). \nDoes it make sense?",
      "parentUuid": "9670ab53_86815fab",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "95cf1c75_81c0a8a8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2021-09-10T13:27:12Z",
      "side": 1,
      "message": "Thanks, i\u0027m still not sure what to do.\n\nI\u0027ve had a look at\n\n```\n  public static final FieldDef\u003cChangeData, Integer\u003e UNRESOLVED_COMMENT_COUNT \u003d//\n      intRange(ChangeQueryBuilder.FIELD_UNRESOLVED_COMMENT_COUNT)\n          .build(\n              ChangeData::unresolvedCommentCount,\n              (cd, field) -\u003e cd.setUnresolvedCommentCount(field));\n```\n\nbut i\u0027m not sure how i do the equivalent for attention.",
      "parentUuid": "fc577122_955566f6",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c291effa_71615ced",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-10T14:03:26Z",
      "side": 1,
      "message": "Maybe easier to explain is the comparison to the attention set field:\n  public static final FieldDef\u003cChangeData, Iterable\u003cInteger\u003e\u003e ATTENTION_SET_USERS \u003d\n      integer(ChangeQueryBuilder.FIELD_ATTENTION_SET_USERS)\n          .buildRepeatable(ChangeField::getAttentionSetUserIds);\n\n\nFrom a storage perspective, we store keys \u003d user ids and values \u003d changes. But this is not useful to implement is:attention, since we need to know how many different users have attention on the change. For that, we should store \"key\" \u003d number of users with attention, value \u003d change.\n\n  public static final FieldDef\u003cChangeData, Integer\u003e ATTENTION_SET_USERS_COUNT \u003d\n      integer(ChangeQueryBuilder.FIELD_ATTENTION_SET_USERS)\n          .buildRepeatable(cd - \u003e additionsOnly(cd.attentionSet().size());\n          \nNow you can go to ChangePredicates and create a predicate almost identical to attentionSet(Account.Id):\n\n  public static Predicate\u003cChangeData\u003e attentionSetCount(int count) {\n    return new ChangeIndexPredicate(ChangeField.ATTENTION_SET_USERS_COUNT, /* count\u003d */ 0);\n  }\n  \n  \nBtw, ATTENTION_SET_FULL can\u0027t be utilized since it includes users that used to be in the attention set, and are no longer.\n\nNote: this will require a schema/index migration, but I don\u0027t see a way to implement it otherwise.\n\nAnyway, if you need more help feel free to ask for a VC.",
      "parentUuid": "95cf1c75_81c0a8a8",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "678fd1d3_ec9ac0d8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2021-09-10T19:20:08Z",
      "side": 1,
      "message": "I\u0027m seeing:\n\n```\njava/com/google/gerrit/server/index/change/ChangeField.java:348: error: incompatible types: no instance(s) of type variable(s) I exist so that FieldDef\u003cI,Iterable\u003cInteger\u003e\u003e conforms to FieldDef\u003cChangeData,Integer\u003e\n          .buildRepeatable(cd -\u003e additionsOnly(cd.attentionSet().size()));\n                          ^\n  where I,T are type-variables:\n    I extends Object declared in method \u003cI\u003ebuildRepeatable(Getter\u003cI,Iterable\u003cT\u003e\u003e)\n    T extends Object declared in class Builder\njava/com/google/gerrit/server/query/change/ChangePredicates.java:47: error: incompatible types: int cannot be converted to String\n    return new ChangeIndexPredicate(ChangeField.ATTENTION_SET_USERS_COUNT, count);\n                                         \n```",
      "parentUuid": "c291effa_71615ced",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9ee4a97c_bc111416",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-10T19:41:22Z",
      "side": 1,
      "message": "I don\u0027t know without seeing the code but it looks like you implemented:\nFieldDef\u003cChangeData, Iterable\u003cInteger\u003e\u003e instead of:\nFieldDef\u003cChangeData, Integer\u003e\n\nJust a guess based on the exception.",
      "parentUuid": "678fd1d3_ec9ac0d8",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "82e50547_bc7990f5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2021-09-10T20:07:57Z",
      "side": 1,
      "message": "It is:\n\n  /** Number of changes that contain attention set. */\n  public static final FieldDef\u003cChangeData, Integer\u003e ATTENTION_SET_USERS_COUNT \u003d\n      integer(ChangeQueryBuilder.FIELD_ATTENTION_SET_USERS)\n          .buildRepeatable(cd -\u003e additionsOnly(cd.attentionSet().size()));",
      "parentUuid": "9ee4a97c_bc111416",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "95d1c1fd_7d9ef90f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-13T06:46:10Z",
      "side": 1,
      "message": "Looks like it should be \"build\" instead of \"buildRepeatable\"\n  /** Number of changes that contain attention set. */\n  public static final FieldDef\u003cChangeData, Integer\u003e ATTENTION_SET_USERS_COUNT \u003d\n      integer(ChangeQueryBuilder.FIELD_ATTENTION_SET_USERS)\n          .build(cd -\u003e additionsOnly(cd.attentionSet().size()));\n          \nThere might be other syntax errors though, I didn\u0027t compile it :-)",
      "parentUuid": "82e50547_bc7990f5",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c65b4890_69dcc64a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2021-09-13T23:29:17Z",
      "side": 1,
      "message": "Fixed, thank you! Works now!",
      "parentUuid": "95d1c1fd_7d9ef90f",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e25fddd4_5666d42b",
        "filename": "Documentation/user-search.txt",
        "patchSetId": 9
      },
      "lineNbr": 435,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-08-30T18:11:17Z",
      "side": 1,
      "message": "nit: You can say that is equivalent to the \u0027attention:self\u0027 query",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b3f2a9df_b45f271c",
        "filename": "Documentation/user-search.txt",
        "patchSetId": 9
      },
      "lineNbr": 435,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2021-09-13T23:29:00Z",
      "side": 1,
      "message": "I\u0027ve changed how it works since you commented. Going to close this as resolved.",
      "parentUuid": "e25fddd4_5666d42b",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f3c33cb0_fd96fa9d",
        "filename": "Documentation/user-search.txt",
        "patchSetId": 9
      },
      "lineNbr": 455,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-08-30T18:11:17Z",
      "side": 1,
      "message": "nit: You can say that is equivalent to the \u0027attention:self\u0027 query",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "86f9c1e1_716f830e",
        "filename": "Documentation/user-search.txt",
        "patchSetId": 9
      },
      "lineNbr": 455,
      "author": {
        "id": 1029953
      },
      "writtenOn": "2021-09-13T23:29:00Z",
      "side": 1,
      "message": "I\u0027ve changed how it works since you commented. Going to close this as resolved.",
      "parentUuid": "f3c33cb0_fd96fa9d",
      "revId": "3e35b263f084b56cb6157507c4825082eb4232c2",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}