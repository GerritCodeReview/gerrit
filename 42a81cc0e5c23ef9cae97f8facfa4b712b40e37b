{
  "comments": [
    {
      "key": {
        "uuid": "cb4bfb44_12b20ccc",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2016-11-11T16:42:30Z",
      "side": 1,
      "message": "I couldn\u0027t reproduce the problem you describe here. On the current master and also on stable-2.13 I tried:\n\n$ ssh -p29418 admin@localhost gerrit index changes 765\nfatal: \"765\" no such change\n\nNothing blew up.\nNothing was logged into the error_log but I don\u0027t see why would we need to log this as an error in the error_log?\n\nHow to reproduce the issue?",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 11,
        "endChar": 62
      },
      "revId": "42a81cc0e5c23ef9cae97f8facfa4b712b40e37b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d0748cbf_93b6dcb9",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1011624
      },
      "writtenOn": "2016-11-14T09:00:53Z",
      "side": 1,
      "message": "Use a syntacial invalid id , e.g. \"1234,1\"",
      "parentUuid": "cb4bfb44_12b20ccc",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 11,
        "endChar": 62
      },
      "revId": "42a81cc0e5c23ef9cae97f8facfa4b712b40e37b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3026c8ad_b62c080a",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2016-11-14T10:24:48Z",
      "side": 1,
      "message": "OK, I see. However, this issue is *not* reproducible by using any syntactically wrong id but only those containing comma.\n\nThis will not reproduce NPE:\n\n  $ ssh -p29418 admin@localhost gerrit index changes 765.1\n  fatal: For input string: \"765.1\"\n  $ ssh -p29418 admin@localhost gerrit index changes 765@1\n  fatal: For input string: \"765@1\"\n\nand now reproduce the NPE:\n\n  $ ssh -p29418 admin@localhost gerrit index changes 765,1\n  fatal: internal server error\n\nThe reason is that Change.Id.parse() has a logic of splitting the id on comma [1] and trying to get a parent key which is null for an IntKey. Therefore, I think that the commit message should more precisely describe the issue (based on this comment). Further, we should understand the idea behind the IntKey having a parent-key before removing this logic.\n\n[1] https://gerrit.googlesource.com/gwtorm/+/refs/heads/master/src/main/java/com/google/gwtorm/client/KeyUtil.java#86",
      "parentUuid": "d0748cbf_93b6dcb9",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 11,
        "endChar": 62
      },
      "revId": "42a81cc0e5c23ef9cae97f8facfa4b712b40e37b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "eb6c3fba_3603762e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2016-11-14T12:35:49Z",
      "side": 1,
      "message": "The parsing was based on the fact that the ID could identify an individual patch-set. However, here we target a change and not a patch. Therefore, just parsing from Int is the right solution.",
      "parentUuid": "3026c8ad_b62c080a",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 11,
        "endChar": 62
      },
      "revId": "42a81cc0e5c23ef9cae97f8facfa4b712b40e37b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cb4bfb44_52bc949b",
        "filename": "gerrit-sshd/src/main/java/com/google/gerrit/sshd/ChangeArgumentParser.java",
        "patchSetId": 2
      },
      "lineNbr": 120,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2016-11-11T16:42:30Z",
      "side": 1,
      "message": "Keep the existing:\n\n  Change.Id.parse(id)\n\nhere. It will also throws a NumberFormatException if the id is not parseable.\n\nThere is quite some logic behind the Change.Id.parse. We shouldn\u0027t remove all that logic without elaborating in the commit message the reason for that.",
      "range": {
        "startLine": 120,
        "startChar": 27,
        "endLine": 120,
        "endChar": 62
      },
      "revId": "42a81cc0e5c23ef9cae97f8facfa4b712b40e37b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0b70b387_57db8ed0",
        "filename": "gerrit-sshd/src/main/java/com/google/gerrit/sshd/ChangeArgumentParser.java",
        "patchSetId": 2
      },
      "lineNbr": 120,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2016-11-14T12:35:49Z",
      "side": 1,
      "message": "Do we expect anything other than a change numeric id here? If yes, it wasn\u0027t documented and wasn\u0027t working either.",
      "parentUuid": "cb4bfb44_52bc949b",
      "range": {
        "startLine": 120,
        "startChar": 27,
        "endLine": 120,
        "endChar": 62
      },
      "revId": "42a81cc0e5c23ef9cae97f8facfa4b712b40e37b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cb4bfb44_32af1065",
        "filename": "gerrit-sshd/src/main/java/com/google/gerrit/sshd/ChangeArgumentParser.java",
        "patchSetId": 2
      },
      "lineNbr": 122,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2016-11-11T16:42:30Z",
      "side": 1,
      "message": "Why do we need to log this as an error when a user makes a typo in his SSH command?",
      "revId": "42a81cc0e5c23ef9cae97f8facfa4b712b40e37b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "eb6c3fba_5610f26c",
        "filename": "gerrit-sshd/src/main/java/com/google/gerrit/sshd/ChangeArgumentParser.java",
        "patchSetId": 2
      },
      "lineNbr": 122,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2016-11-14T12:35:49Z",
      "side": 1,
      "message": "I am not awareof a way to provide a different output to the REST API collection results. But possibly I could try to throw an exception and then catch at SSH command level. Let me try that out ...",
      "parentUuid": "cb4bfb44_32af1065",
      "revId": "42a81cc0e5c23ef9cae97f8facfa4b712b40e37b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}