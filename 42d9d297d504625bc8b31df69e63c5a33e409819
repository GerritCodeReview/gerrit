{
  "comments": [
    {
      "key": {
        "uuid": "c32476a6_f65a8053",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/ReviewerSuggestionCache.java",
        "patchSetId": 26
      },
      "lineNbr": 0,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2015-03-26T13:46:06Z",
      "side": 1,
      "message": "Newly created accounts are not added to this cache and we cannot flush this cache. This means that Gerrit has to be restarted when a new account is added in order to be loaded into this cache.\n\nCompare this implementation with the \"project_list\" cache implementation in the ProjectCacheImpl.",
      "revId": "42d9d297d504625bc8b31df69e63c5a33e409819",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c32476a6_16461c81",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/ReviewerSuggestionCache.java",
        "patchSetId": 26
      },
      "lineNbr": 58,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2015-03-26T13:46:06Z",
      "side": 1,
      "message": "Since this cache is not defined using a CacheModule gerrit will not list it from its \"show-caches\" command. Right? And we also have no way of flushing this cache since it has no name.",
      "range": {
        "startLine": 51,
        "startChar": 0,
        "endLine": 58,
        "endChar": 15
      },
      "revId": "42d9d297d504625bc8b31df69e63c5a33e409819",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c32476a6_b6540828",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/ReviewerSuggestionCache.java",
        "patchSetId": 26
      },
      "lineNbr": 58,
      "author": {
        "id": 1006454
      },
      "writtenOn": "2015-03-26T13:58:45Z",
      "side": 1,
      "message": "Perhaps I am misunderstanding you, but since  .expireAfterWrite(30, TimeUnit.SECONDS) is used, should not the cache \"refresh\" every 30 second? If so, is it really necessary to manually flush the cache? Is it common that you add a user and try to add him/her as a reviewer within 30 seconds?",
      "parentUuid": "c32476a6_16461c81",
      "range": {
        "startLine": 51,
        "startChar": 0,
        "endLine": 58,
        "endChar": 15
      },
      "revId": "42d9d297d504625bc8b31df69e63c5a33e409819",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c32476a6_76ac309e",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/ReviewerSuggestionCache.java",
        "patchSetId": 26
      },
      "lineNbr": 58,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2015-03-26T14:03:35Z",
      "side": 1,
      "message": "OK, it will refresh every 30 seconds I see.\n\nStill this is not how a cache should work, to load all accounts (in our case about 10.000) every 30 seconds. Wouldn\u0027t it be better if it handles account creation similarly like the project_list cache handles project creation?",
      "parentUuid": "c32476a6_b6540828",
      "range": {
        "startLine": 51,
        "startChar": 0,
        "endLine": 58,
        "endChar": 15
      },
      "revId": "42d9d297d504625bc8b31df69e63c5a33e409819",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "030bee18_18bbe5d6",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/ReviewerSuggestionCache.java",
        "patchSetId": 26
      },
      "lineNbr": 58,
      "author": {
        "id": 1006454
      },
      "writtenOn": "2015-03-26T14:19:21Z",
      "side": 1,
      "message": "I think this solution was a suggested \"placeholder solution\" by Dave during the Hackathon in Berlin. The plan was to rewrite it once we had all accounts in NoteDB/Secondary index.\n\nBut are you experience a negative impact due to this implementation compared to the previous one where a new database query was issued every time any of your 10.000 users pressed a button in the \"Add Reviewer\"-field in the UI?\n\nAfter deploying this patch we were seeing nice speed gains in the UI and a bit less load on the database. I cannot imagine 10.000 accounts to be that heavy on memory usage.",
      "parentUuid": "c32476a6_76ac309e",
      "range": {
        "startLine": 51,
        "startChar": 0,
        "endLine": 58,
        "endChar": 15
      },
      "revId": "42d9d297d504625bc8b31df69e63c5a33e409819",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}