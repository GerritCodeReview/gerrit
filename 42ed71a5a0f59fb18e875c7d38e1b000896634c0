{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "05b445e0_0762d462",
        "filename": "/COMMIT_MSG",
        "patchSetId": 4
      },
      "lineNbr": 7,
      "author": {
        "id": 1012457
      },
      "writtenOn": "2022-06-07T06:31:46Z",
      "side": 1,
      "message": "This might be better:\n\n Add extension point that allows plugins to provide destination address for outgoing emails",
      "range": {
        "startLine": 7,
        "startChar": 0,
        "endLine": 7,
        "endChar": 51
      },
      "revId": "42ed71a5a0f59fb18e875c7d38e1b000896634c0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a6694497_030f01ec",
        "filename": "/COMMIT_MSG",
        "patchSetId": 4
      },
      "lineNbr": 10,
      "author": {
        "id": 1012457
      },
      "writtenOn": "2022-06-07T06:31:46Z",
      "side": 1,
      "message": "How about:\n\nThis new extension point is helpful when organizations want all outgoing emails from Gerrit sent to a specific address (for example, an alternate registered email) of the user rather than their preferred email.",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 18
      },
      "revId": "42ed71a5a0f59fb18e875c7d38e1b000896634c0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9287e789_068cd6f1",
        "filename": "/COMMIT_MSG",
        "patchSetId": 4
      },
      "lineNbr": 12,
      "author": {
        "id": 1012457
      },
      "writtenOn": "2022-06-07T06:31:46Z",
      "side": 1,
      "message": "Remove \u0027Impact\u0027 footer.\n\nAdd a \u0027Release-Notes\u0027 footer.",
      "range": {
        "startLine": 12,
        "startChar": 0,
        "endLine": 12,
        "endChar": 66
      },
      "revId": "42ed71a5a0f59fb18e875c7d38e1b000896634c0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "40b24ab2_9e8a6c6b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1013267
      },
      "writtenOn": "2022-06-07T06:49:20Z",
      "side": 1,
      "message": "i suppose this indirectly addresses https://crbug.com/gerrit/2615.\nbut i think that should be core functionality, not an extension point. an XP could be provided for validating addresses at configuration time, though.",
      "revId": "42ed71a5a0f59fb18e875c7d38e1b000896634c0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "30d56867_905b756a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2022-06-07T23:39:21Z",
      "side": 1,
      "message": "Thanks for pointing that issue out, I didn\u0027t realize it existed. That actually deals with the issue we want to tackle next (which identity to use for git operations). We have two needs, 1) apply server-wide policy on where emails should be sent (for us, we\u0027ll have a plugin that forces it to go to the user\u0027s LDAP address, not any other registered address), and 2) apply per-repo policy on which registered email address for a user should be used for git author/committer.\n\nThe bug you linked leads me to potentially see adding a user preference for \"Override my preferred email and use this identity for git author/committer instead\" as a core feature and as a step towards #2. I don\u0027t think it applies to #1, which is what this change is working towards.\n\nDoes that help clarify? (we\u0027ll be sure to update the commit message if it does)",
      "parentUuid": "40b24ab2_9e8a6c6b",
      "revId": "42ed71a5a0f59fb18e875c7d38e1b000896634c0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3b1b5fdc_b9086436",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1013267
      },
      "writtenOn": "2022-06-08T08:50:38Z",
      "side": 1,
      "message": "\u003e Does that help clarify?\n\nat a high level, it certainly does.\nat the implementation level, the patch seems backwards, as it basically subverts the configuration done in the UI. you\u0027d at least need an additional mechanism to disable/replace the UI. it appears easier to obtain a clean implementation by just relaying it entirely to the configuration (after introducing purpose-bound address settings), though your requirement to make the addresses repo-specific makes this somewhat cumbersome (unless it was a pattern like foo-${repo}@mail.dns).\n\nfwiw, the case which got me interested in this issue was a guy who contributes to qt-project as an employee and consequently needs to present himself as such in commits and the gerrit UI, but wants to use a private address for notifications, as the company\u0027s restrictive security policy makes using the company address somewhat impractical for that. he worked it around by having two gerrit accounts, which is obviously suboptimal.",
      "parentUuid": "30d56867_905b756a",
      "revId": "42ed71a5a0f59fb18e875c7d38e1b000896634c0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "648eafb5_550e2afd",
        "filename": "Documentation/dev-plugins.txt",
        "patchSetId": 4
      },
      "lineNbr": 2902,
      "author": {
        "id": 1012457
      },
      "writtenOn": "2022-06-07T06:31:46Z",
      "side": 1,
      "message": "How about:\n\nThis extension point allows plugins to provide a preferred destination address for all outgoing emails from Gerrit.",
      "range": {
        "startLine": 2901,
        "startChar": 0,
        "endLine": 2902,
        "endChar": 67
      },
      "revId": "42ed71a5a0f59fb18e875c7d38e1b000896634c0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b32b4811_635b7c8d",
        "filename": "java/com/google/gerrit/server/email/PreferredNotificationEmailProvider.java",
        "patchSetId": 4
      },
      "lineNbr": 22,
      "author": {
        "id": 1012457
      },
      "writtenOn": "2022-06-07T06:31:46Z",
      "side": 1,
      "message": "How about:\n\n Extension point to provide destination address for all outgoing emails from Gerrit.",
      "range": {
        "startLine": 21,
        "startChar": 1,
        "endLine": 22,
        "endChar": 42
      },
      "revId": "42ed71a5a0f59fb18e875c7d38e1b000896634c0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8c052d21_42e0e511",
        "filename": "java/com/google/gerrit/server/email/PreferredNotificationEmailProvider.java",
        "patchSetId": 4
      },
      "lineNbr": 28,
      "author": {
        "id": 1012457
      },
      "writtenOn": "2022-06-07T06:31:46Z",
      "side": 1,
      "message": "How about:\n\n Get preferred destination address for outgoing emails.",
      "range": {
        "startLine": 28,
        "startChar": 0,
        "endLine": 28,
        "endChar": 46
      },
      "revId": "42ed71a5a0f59fb18e875c7d38e1b000896634c0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d6e9d7b7_0110ef1f",
        "filename": "java/com/google/gerrit/server/email/PreferredNotificationEmailProvider.java",
        "patchSetId": 4
      },
      "lineNbr": 30,
      "author": {
        "id": 1012457
      },
      "writtenOn": "2022-06-07T06:31:46Z",
      "side": 1,
      "message": "How about:\n\n The {@code Account} of the user whose destination address is to be obtained",
      "range": {
        "startLine": 30,
        "startChar": 20,
        "endLine": 30,
        "endChar": 89
      },
      "revId": "42ed71a5a0f59fb18e875c7d38e1b000896634c0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "44c99f91_01ba7ed0",
        "filename": "javatests/com/google/gerrit/acceptance/server/mail/PreferredNotificationEmailProviderIT.java",
        "patchSetId": 4
      },
      "lineNbr": 74,
      "author": {
        "id": 1012457
      },
      "writtenOn": "2022-06-07T06:31:46Z",
      "side": 1,
      "message": "This might be more readable:\n\n ImmutableList\u003cMessage\u003e messages \u003d sender.getMessages();\n assertThat(messages).hasSize(1);\n ImmutableList\u003cAddress\u003e recipients \u003d messages.get(0).rcpt();\n assertThat(recipients.size()).isEqualTo(2);\n Set\u003cString\u003e recipient_emails \u003d recipients.stream().map(a -\u003e \n a.email()).collect(Collectors.toSet());\n assertThat(recipient_emails).contains(SET_BY_PLUGIN + admin.email());\n assertThat(recipient_emails).contains(SET_BY_PLUGIN + user.email());",
      "range": {
        "startLine": 69,
        "startChar": 1,
        "endLine": 74,
        "endChar": 61
      },
      "revId": "42ed71a5a0f59fb18e875c7d38e1b000896634c0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}