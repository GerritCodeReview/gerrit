{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "dd72cd0a_9148d95e",
        "filename": "Documentation/dev-bazel.txt",
        "patchSetId": 10
      },
      "lineNbr": 686,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2022-01-01T22:04:28Z",
      "side": 1,
      "message": "Haven\u0027t you mentioned that they\u0027ve updated it and now the git version included is good for our tests?",
      "range": {
        "startLine": 686,
        "startChar": 7,
        "endLine": 686,
        "endChar": 57
      },
      "revId": "432802469cb0caadd1aaec4c9534d1e754438498",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d4d1e91e_b938e31e",
        "filename": "Documentation/dev-bazel.txt",
        "patchSetId": 10
      },
      "lineNbr": 686,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2022-01-01T23:05:21Z",
      "side": 1,
      "message": "GCE team has not updated official RBE docker image for Ubuntu 18.04. It\u0027s still using outdated git-core version 2.17.1, while we need at least 2.18.\n\nWhat this change is doing, is defining our custom docker image, see included Dockerfile and description.\n\nI have built this new custom docker image and published it to Gerrit bucket on GCE.\n\nAfter doing it, I have rebuilt rbe_config to point to that custom docker image. This step is documented in this repository: [1], see README.md, the relevant change is the docker image provided to rbe_configs_gen command:\n\n  $ ./rbe_configs_gen \\\n       --bazel_version\u003d4.1.0 \\\n       --toolchain_container\u003dgcr.io/$PROJECT_NAME/rbe-ubuntu18-04:latest \\\n       --output_src_root\u003d/home/\u003cuser\u003e/projects/rbe_autoconfig \\\n       --exec_os\u003dlinux \\\n       --target_os\u003dlinux\n\nAs the last step, I conducted new release of rbe_autoconfig v3.0.0 and uploaded it to both: github and Google bucket.\n\n[1] https://github.com/davido/rbe_autoconfig\n[2] https://github.com/davido/rbe_autoconfig/releases/tag/v3.0.0",
      "parentUuid": "dd72cd0a_9148d95e",
      "range": {
        "startLine": 686,
        "startChar": 7,
        "endLine": 686,
        "endChar": 57
      },
      "revId": "432802469cb0caadd1aaec4c9534d1e754438498",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3362c1b4_782f6d5b",
        "filename": "Documentation/dev-bazel.txt",
        "patchSetId": 10
      },
      "lineNbr": 686,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2022-01-01T23:13:07Z",
      "side": 1,
      "message": "Forgot to mention the very last step, update WORKSPACE file in this change and reference new rbe_autoconfig release v3.0.0:\n\n  http_archive(\n    name \u003d \"rbe_jdk11\",\n    sha256 \u003d \"5939e2a4e56d1fc53b6c44c6db97ee068c9f4bd18e86c762f6ab8b4fff5e294b\",\n    strip_prefix \u003d \"rbe_autoconfig-3.0.0\",\n    urls \u003d [\n        \"https://gerrit-bazel.storage.googleapis.com/rbe_autoconfig/v3.0.0.tar.gz\",\n        \"https://github.com/davido/rbe_autoconfig/archive/v3.0.0.tar.gz\",\n    ],\n  )\n  \nShould I update commit message and include all these steps there? Another thought, it would be good to move rbe_autoconfig github project from https://github.com/davido/rbe_autoconfig to gerrit-review and gerritcodereview github organization.\n\nWDYT?\n\nCurrently there is only README.md file there, but still it would be good, that other maintainers can update rbe_autoconfig toolchain. It\u0027s possible already now, though, even without write access to https://github.com/davido/rbe_autoconfig project. You could create your own github project and delegate to it, or just remove it entirely, and update rbe_autoconfig on GCE bucket and only specify this URL in http_archive rule, e.g.:\n\n  http_archive(\n    name \u003d \"rbe_jdk11\",\n    sha256 \u003d \"\u003cnew sha256\u003e\",\n    strip_prefix \u003d \"rbe_autoconfig-42.0.0\",\n    urls \u003d [\n        \"https://gerrit-bazel.storage.googleapis.com/rbe_autoconfig/v42.0.0.tar.gz\",\n    ],\n  )",
      "parentUuid": "d4d1e91e_b938e31e",
      "range": {
        "startLine": 686,
        "startChar": 7,
        "endLine": 686,
        "endChar": 57
      },
      "revId": "432802469cb0caadd1aaec4c9534d1e754438498",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5689c55a_78684beb",
        "filename": "Documentation/dev-bazel.txt",
        "patchSetId": 10
      },
      "lineNbr": 686,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2022-01-05T02:00:34Z",
      "side": 1,
      "message": "\u003e Forgot to mention the very last step, update WORKSPACE file in this change and reference new rbe_autoconfig release v3.0.0:\n\u003e \n\u003e   http_archive(\n\u003e     name \u003d \"rbe_jdk11\",\n\u003e     sha256 \u003d \"5939e2a4e56d1fc53b6c44c6db97ee068c9f4bd18e86c762f6ab8b4fff5e294b\",\n\u003e     strip_prefix \u003d \"rbe_autoconfig-3.0.0\",\n\u003e     urls \u003d [\n\u003e         \"https://gerrit-bazel.storage.googleapis.com/rbe_autoconfig/v3.0.0.tar.gz\",\n\u003e         \"https://github.com/davido/rbe_autoconfig/archive/v3.0.0.tar.gz\",\n\u003e     ],\n\u003e   )\n\u003e   \n\u003e Should I update commit message and include all these steps there? Another thought, it would be good to move rbe_autoconfig github project from https://github.com/davido/rbe_autoconfig to gerrit-review and gerritcodereview github organization.\n\nYeah, it should be part of the gerrit-review.googlesource.com set of projects, as it will be needed to perform the project\u0027s validation.",
      "parentUuid": "3362c1b4_782f6d5b",
      "range": {
        "startLine": 686,
        "startChar": 7,
        "endLine": 686,
        "endChar": 57
      },
      "revId": "432802469cb0caadd1aaec4c9534d1e754438498",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e414e8f4_65a0092a",
        "filename": "Documentation/dev-bazel.txt",
        "patchSetId": 10
      },
      "lineNbr": 686,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2022-01-05T07:20:48Z",
      "side": 1,
      "message": "But the previous change was already approved, that switched to using custom rbe_autoconfig distribution from my github project and Google storage bucket, to unblock Bazel update, see change 307404. So that moving custom rbe_autoconfig with single README.md file from: [1] to googlesource.com shouldn\u0027t block this change either.\n\n@Hanwen, you approved change 307404, can you have a look?\n\n[1] https://github.com/davido/rbe_autoconfig/blob/master/README.md",
      "parentUuid": "5689c55a_78684beb",
      "range": {
        "startLine": 686,
        "startChar": 7,
        "endLine": 686,
        "endChar": 57
      },
      "revId": "432802469cb0caadd1aaec4c9534d1e754438498",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "912be6e5_760d9269",
        "filename": "tools/platforms/Dockerfile",
        "patchSetId": 10
      },
      "lineNbr": 0,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2022-01-02T13:10:09Z",
      "side": 1,
      "message": "I figured, that easily, we could even switch to using Ubuntu 20.04 on RBE:\n\n  +FROM gcr.io/cloud-marketplace/google/ubuntu2004:latest\n  +\n  +RUN apt-get -y update \u0026\u0026 \\\n  +    apt-get -y install git \u0026\u0026 \\\n  +    apt-get -y install golang \u0026\u0026 \\\n  +    apt-get -y install openjdk-17-jdk openjdk-17-jre openjdk-17-jdk-headless \u0026\u0026 \\\n  +    apt-get -y install unzip zip \u0026\u0026 \\\n  +    apt-get -y install python3 \u0026\u0026 \\\n  +    apt-get -y install wget \u0026\u0026 \\\n  +    apt-get -y install vim \u0026\u0026 \\\n  +    apt-get clean\n\nThat way built Docker image works as expected locally. I have not tried to use it on RBE yet.",
      "revId": "432802469cb0caadd1aaec4c9534d1e754438498",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}