{
  "comments": [
    {
      "key": {
        "uuid": "9f4d5812_9bc2eb39",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 44,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2014-06-05T10:45:21Z",
      "side": 1,
      "message": "Does it make sense to get all interfaces from the Jar and then looking for the one you need by name ? Seems a bit overkill IMHO.",
      "range": {
        "startLine": 44,
        "startChar": 30,
        "endLine": 44,
        "endChar": 82
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f3d4c4d_40654e57",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 44,
      "author": {
        "id": 1010134
      },
      "writtenOn": "2014-06-06T08:43:28Z",
      "side": 1,
      "message": "It depends on the point of view. You are right that collection all that data can be overkill, but my approach was at create something for general purposes and not hardcode SecureStore class name in other parts of the code base.\n\nI see here two responsibilities. First to collect all metadata about class. Second to extract classes that are interesting for SecureStore.\n\nRight now code in scanner is fully disconnected form SecureStore implementation.\n\nAFAIR my initial idea was to pass list of interfaces that are interesting for caller to scan() method. But this will mean that scanning will be done many times. Current approach is the simply trading CPU for memory, making Gerrit starting faster and consume bit more ram...",
      "parentUuid": "9f4d5812_9bc2eb39",
      "range": {
        "startLine": 44,
        "startChar": 30,
        "endLine": 44,
        "endChar": 82
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f3d4c4d_c0fb9e27",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 44,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2014-06-06T08:55:41Z",
      "side": 1,
      "message": "You need only one interface (SecureStore) and you expect this to be implemented by one class at most per plugin.\n\nWith regards to Memory vs. start-up time: most of the people typically don\u0027t care of taking a bit more time to start Gerrit if it uses overall less memory :-)\n\nYou start/restart Gerrit (at most) 1-2 times a day (if you do continuous deployment from Gerrit master) and most of Gerrit users once a week.",
      "parentUuid": "3f3d4c4d_40654e57",
      "range": {
        "startLine": 44,
        "startChar": 30,
        "endLine": 44,
        "endChar": 82
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f4d5812_5beb038a",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 44,
      "author": {
        "id": 1010134
      },
      "writtenOn": "2014-06-06T09:13:42Z",
      "side": 1,
      "message": "Wait a minute, we are talking here about PluginData class, right? Will this instances of this class be always used in Gerrit? I think that after deploying a plugin they will be GCed or am I wrong?\n\nAlso instances of this class will be created only during startup and plugin installation process. Restarts, as you mentioned, are not so often and I would say that you even less often install plugins",
      "parentUuid": "3f3d4c4d_c0fb9e27",
      "range": {
        "startLine": 44,
        "startChar": 30,
        "endLine": 44,
        "endChar": 82
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f3d4c4d_0023c644",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 57,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2014-06-05T10:45:21Z",
      "side": 1,
      "message": "You are kind of overloading on the Export concept here: this will not be used in the same way that plugins do and would not generate the same plugin loading mechanism.\n\nWhy don\u0027t you just define a @SecureStoreProvider annotation or something more tailored to this ? It is typically a bad idea to reause names for different concepts.",
      "range": {
        "startLine": 57,
        "startChar": 48,
        "endLine": 57,
        "endChar": 60
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f3d4c4d_00f2e64d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 57,
      "author": {
        "id": 1010134
      },
      "writtenOn": "2014-06-06T08:43:28Z",
      "side": 1,
      "message": "Yes, I was thinking about providing another annotation, but IMO it will make thins more complicated. I prefer to have less annotations to keep client API smaller.\n\nIMO it is better to have one general purpose annotation to \"bind something\" in gerrit then have separate annotations for everything.\n\nI also think that this is Gerrit\u0027s approach to have less annotations. If it won\u0027t be then you will have something like: @ExportSshCommans, @ExportHttpServlet, @ExportJavaScript ... and so on.",
      "parentUuid": "3f3d4c4d_0023c644",
      "range": {
        "startLine": 57,
        "startChar": 48,
        "endLine": 57,
        "endChar": 60
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f4d5812_fbfbef58",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 57,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2014-06-06T08:55:41Z",
      "side": 1,
      "message": "This is different though: you\u0027re not using the Gerrit plugin architecture for that but it is only a way for you to recognise the class to load *OUTSIDE* the plugin loader.\n\nReusing a plugin-specific annotation for something that is not related to Gerrit plugins, it is misleading IMHO.",
      "parentUuid": "3f3d4c4d_00f2e64d",
      "range": {
        "startLine": 57,
        "startChar": 48,
        "endLine": 57,
        "endChar": 60
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f3d4c4d_200b6a8d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 57,
      "author": {
        "id": 1010134
      },
      "writtenOn": "2014-06-06T09:13:42Z",
      "side": 1,
      "message": "You are looking on this from Gerrit developer perspective. Somebody who knows Gerrit internals. If you look from the perspective of person that doesn\u0027t care about internals but want to implement extension then it doesn\u0027t make much sense to have different annotation here.",
      "parentUuid": "9f4d5812_fbfbef58",
      "range": {
        "startLine": 57,
        "startChar": 48,
        "endLine": 57,
        "endChar": 60
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f4d5812_3bf2b778",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 57,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2014-06-06T09:24:24Z",
      "side": 1,
      "message": "I think it needs to be understood by the \"SecureExtension\" developer that what he is going to implement is not a plugin and would not benefit from the plugin Guice injections.\n\nHe needs to know that he provides a plain class, that\u0027s it.\nIt would be KISS just to mention the plugin / class name to load from your Gerrit config and that\u0027s it: simple, clear, less chances to break :-)",
      "parentUuid": "3f3d4c4d_200b6a8d",
      "range": {
        "startLine": 57,
        "startChar": 48,
        "endLine": 57,
        "endChar": 60
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f4d5812_bbc7a748",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 61,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2014-06-05T10:45:21Z",
      "side": 1,
      "message": "A bit overkill here. I think you had to do in this way because of the reuse of existing @Export annotation for a different context / purpose.\nIf you sort out the previous problem, then you don\u0027t need to make this complex searching / scanning anymore :-)",
      "range": {
        "startLine": 60,
        "startChar": 6,
        "endLine": 61,
        "endChar": 75
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f4d5812_3bd717cd",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 61,
      "author": {
        "id": 1010134
      },
      "writtenOn": "2014-06-06T08:43:28Z",
      "side": 1,
      "message": "You mean here rather, if I change my approach and make this extension point more strict (single SecureStore impl per plugin) and less consumer friendly (additional annotation). Then we could have different code in few places.\n\nIMO we should care more about consumers. Changes that I did are not so dramatic and complex to force other developers to use more obscure API",
      "parentUuid": "9f4d5812_bbc7a748",
      "range": {
        "startLine": 60,
        "startChar": 6,
        "endLine": 61,
        "endChar": 75
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f4d5812_9b00ab9b",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 61,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2014-06-06T08:55:41Z",
      "side": 1,
      "message": "What is the value of one plugin with three different SecureStore implementations ? At the end of the day I choose to use one in Gerrit right ? The basic concept of development should be KISS without anticipating future needs in current development.\n\nDo simple steps: make it work (and merged) and *THEN* make it better :-)",
      "parentUuid": "9f4d5812_3bd717cd",
      "range": {
        "startLine": 60,
        "startChar": 6,
        "endLine": 61,
        "endChar": 75
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f3d4c4d_4008ee8d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 61,
      "author": {
        "id": 1010134
      },
      "writtenOn": "2014-06-06T09:13:42Z",
      "side": 1,
      "message": "The value is in the effort that one need to put to maintain one plugin code base versus eg. ten plugins.\n\nTBH personally I really don\u0027t think that limiting number of SecureStore implementations per plugin to one will make this change to be merged earlier and also will not make code simpler.",
      "parentUuid": "9f4d5812_9b00ab9b",
      "range": {
        "startLine": 60,
        "startChar": 6,
        "endLine": 61,
        "endChar": 75
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f3d4c4d_a00d3a9c",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 61,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2014-06-06T09:24:24Z",
      "side": 1,
      "message": "Do you have already a plugin that provides multiple secure stores ?\nIsn\u0027t it going to be a \"one-size-fits-all\" plugin ?\nPlugin should simple, trivial, even just a simple script :-)",
      "parentUuid": "3f3d4c4d_4008ee8d",
      "range": {
        "startLine": 60,
        "startChar": 6,
        "endLine": 61,
        "endChar": 75
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f3d4c4d_a0177ad7",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 105,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2014-06-05T10:45:21Z",
      "side": 1,
      "message": "Does it really make sense to have a plugin with multiple secure-stores ? What would be the rationale behind it ?",
      "range": {
        "startLine": 99,
        "startChar": 4,
        "endLine": 105,
        "endChar": 5
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f3d4c4d_80391660",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 105,
      "author": {
        "id": 1010134
      },
      "writtenOn": "2014-06-06T08:43:28Z",
      "side": 1,
      "message": "Is it really make sense to block such behavior?\n\nI can imagine plugin that will contain multiple secure stores one for each encryption algorithm. Why would you like to prevent that?",
      "parentUuid": "3f3d4c4d_a0177ad7",
      "range": {
        "startLine": 99,
        "startChar": 4,
        "endLine": 105,
        "endChar": 5
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f4d5812_bb0567aa",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 105,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2014-06-06T08:55:41Z",
      "side": 1,
      "message": "KISS: we\u0027ve got nothing in Gerrit at the moment, keep it simple and merged and *THEN* more flexible and better (if anyone needs it)",
      "parentUuid": "3f3d4c4d_80391660",
      "range": {
        "startLine": 99,
        "startChar": 4,
        "endLine": 105,
        "endChar": 5
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f4d5812_7be83f8c",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 105,
      "author": {
        "id": 1010134
      },
      "writtenOn": "2014-06-06T09:13:42Z",
      "side": 1,
      "message": "You can\u0027t do some things after change is merged without breaking backward compatibility. At least for this change if you remove possibility to provide multiple SecureStore per plugin, then current format of secureStroe property ($plugin_name/$store_name) will not make sense so it should also be changed. This will block going back to initial idea of multiple SecureStore instances per jar file.",
      "parentUuid": "9f4d5812_bb0567aa",
      "range": {
        "startLine": 99,
        "startChar": 4,
        "endLine": 105,
        "endChar": 5
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f4d5812_db1dd3fb",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/securestore/SecureStoreProvider.java",
        "patchSetId": 12
      },
      "lineNbr": 105,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2014-06-06T09:24:24Z",
      "side": 1,
      "message": "That\u0027s the danger in Code-Review: as you fear your change to take too much time to be merged, you tend to put as much stuff as you can ... as this could be \"your only chance\".\n\nThat\u0027s wrong: changes must be simple, incremental, as trivial as possible, as stable as possible. That\u0027s the way Code Review becomes agile and useful IMHO :-)",
      "parentUuid": "9f4d5812_7be83f8c",
      "range": {
        "startLine": 99,
        "startChar": 4,
        "endLine": 105,
        "endChar": 5
      },
      "revId": "454784aa88a0977bfedc1933329fffba4a81c6f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}