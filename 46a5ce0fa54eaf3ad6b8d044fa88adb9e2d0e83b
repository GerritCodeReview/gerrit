{
  "comments": [
    {
      "key": {
        "uuid": "48d52c29_763cb071",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 22,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2016-04-22T06:02:14Z",
      "side": 1,
      "message": "Would be nice to add a test for that. Could be done on master, though.",
      "revId": "46a5ce0fa54eaf3ad6b8d044fa88adb9e2d0e83b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "88bba4f1_58c79dbc",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 22,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2016-04-22T06:07:53Z",
      "side": 1,
      "message": "Looking at how QueryIT works, it looks like it performs all queries as admin.  There\u0027s no ssh session set up for regular user.\n\nI\u0027ll see how much work it will be to add it.",
      "parentUuid": "48d52c29_763cb071",
      "revId": "46a5ce0fa54eaf3ad6b8d044fa88adb9e2d0e83b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "48d52c29_16433cf0",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 22,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2016-04-22T06:26:42Z",
      "side": 1,
      "message": "Sure, we don\u0027t set up SSH user session, only REST user session. But isn\u0027t VIEW_DRAFT permission is a normal permision that can be revoked for admin user? If I read the code correctly:\n\n  return isOwner() || isReviewer(db, cd) || getRefControl().canViewDrafts()\n        || getUser().isInternalUser();\n\nwe don\u0027t have special case fo admin user in the ChangeControl#isDraftVisible() method. Am I missing something?",
      "parentUuid": "88bba4f1_58c79dbc",
      "revId": "46a5ce0fa54eaf3ad6b8d044fa88adb9e2d0e83b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a8e30849_c183828c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 22,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2016-04-22T07:15:44Z",
      "side": 1,
      "message": "Correct, view draft is not set by default for admins.\n\nMy point was that the change is being created by the admin user, so the draft is visible.\n\nIn the next patch set I\u0027ve worked around it by setting up a separate ssh session for the regular user, who can\u0027t see drafts.\n\nNote that there is some possibility to clean up ssh session handling in the tests, but I will defer that to the master branch.",
      "parentUuid": "48d52c29_16433cf0",
      "revId": "46a5ce0fa54eaf3ad6b8d044fa88adb9e2d0e83b",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}