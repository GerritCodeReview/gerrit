{
  "comments": [
    {
      "key": {
        "uuid": "89e81467_e2bc06d0",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-16T13:31:42Z",
      "side": 1,
      "message": "This class needs to go in a different package, we don\u0027t want an H2 dependency in gerrit-server. Either put it in gerrit-cache-h2 (and optionally rename that package), or put it in its own package.",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4940dc42_b00f582f",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-06-17T09:27:10Z",
      "side": 1,
      "message": "I have now moved it com.google.gerrit.server.schema where we already have classes dealing with H2.",
      "parentUuid": "89e81467_e2bc06d0",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "89e81467_c2b902de",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 51,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-16T13:31:42Z",
      "side": 1,
      "message": "I think you\u0027d want to declare the DynamicSet in a common location and only bind it in this module?",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a9195874_93febc3b",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 51,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-06-17T09:27:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "89e81467_c2b902de",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "69ebe063_e1c76646",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 78,
      "author": {
        "id": 1011624
      },
      "writtenOn": "2016-06-16T14:02:49Z",
      "side": 1,
      "message": "Support the flags that are used for the cache tables as well?\nEspecially CACHE_SIZE seems useful?\n\nSee gerrit-cache-h2/src/main/java/com/google/gerrit/server/cache/h2/H2CacheFactory.java",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "09fc242a_1e94ed49",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 78,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-06-16T15:02:44Z",
      "side": 1,
      "message": "Thanks, that\u0027s a good point.",
      "parentUuid": "69ebe063_e1c76646",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a9195874_f37cd0a0",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 78,
      "author": {
        "id": 1011624
      },
      "writtenOn": "2016-06-17T08:17:31Z",
      "side": 1,
      "message": "Actually I think adding h2 auto-server could enable a leightweight multi-master mode, as long as the db directory is shared. See https://gerrit-review.googlesource.com/#/c/77824 where I do this for the normal h2 db to enable online Notedbd rebuild.",
      "parentUuid": "09fc242a_1e94ed49",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4940dc42_d012dc54",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 78,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-06-17T09:27:10Z",
      "side": 1,
      "message": "Looks interesting, but maybe better to add this option in a follow-up change.",
      "parentUuid": "a9195874_f37cd0a0",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a9195874_b33898e1",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 78,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-06-17T09:27:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "69ebe063_e1c76646",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "89e81467_02c00a36",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 82,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-16T13:31:42Z",
      "side": 1,
      "message": "Is this option also used somewhere else, e.g. the H2 cache impl? Worth factoring out?",
      "range": {
        "startLine": 82,
        "startChar": 50,
        "endLine": 82,
        "endChar": 67
      },
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "09fc242a_fe982180",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 82,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-06-16T15:02:44Z",
      "side": 1,
      "message": "No, this is the only place where we use this option. See [1] for an explanation of this option. I guess I can add a comment about it here.\n\n[1] http://stackoverflow.com/questions/5763747/h2-in-memory-database-table-not-found",
      "parentUuid": "89e81467_02c00a36",
      "range": {
        "startLine": 82,
        "startChar": 50,
        "endLine": 82,
        "endChar": 67
      },
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4940dc42_f0b9608f",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 82,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-06-17T09:27:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "09fc242a_fe982180",
      "range": {
        "startLine": 82,
        "startChar": 50,
        "endLine": 82,
        "endChar": 67
      },
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b41b715a_43d20609",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 101,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-16T13:31:42Z",
      "side": 1,
      "message": "Don\u0027t limit this, we support \u003e255 character filenames. Do whatever gwtorm does for a String column with no limit, although I forget what that is.",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "09fc242a_3e8fa93d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 101,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-06-16T15:02:44Z",
      "side": 1,
      "message": "Do we? For my local H2 based instance it shows:\n\n$ gsql\n[2016-06-16 16:57:10,880] [main] INFO  com.google.gerrit.server.git.LocalDiskRepositoryManager : Defaulting core.streamFileThreshold to 1995m\nWelcome to Gerrit Code Review 2.12.2-2834-gcb9e30f-dirty\n(H2 1.3.176 (2014-04-05))\n\nType \u0027\\h\u0027 for help.  Type \u0027\\r\u0027 to clear the buffer.\n\ngerrit\u003e \\d ACCOUNT_PATCH_REVIEWS\n                     Table ACCOUNT_PATCH_REVIEWS\n COLUMN_NAME  | TYPE\n -------------+---------------------------------\n ACCOUNT_ID   | INTEGER DEFAULT 0 NOT NULL\n CHANGE_ID    | INTEGER DEFAULT 0 NOT NULL\n PATCH_SET_ID | INTEGER DEFAULT 0 NOT NULL\n FILE_NAME    | VARCHAR(255) DEFAULT \u0027\u0027 NOT NULL\n\nIndexes on ACCOUNT_PATCH_REVIEWS:\n  PRIMARY_KEY_12 UNIQUE (ACCOUNT_ID, CHANGE_ID, PATCH_SET_ID, FILE_NAME)",
      "parentUuid": "b41b715a_43d20609",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6914c033_39e10fda",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 101,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-16T17:45:02Z",
      "side": 1,
      "message": "Ouch. I guess we can stick with this since it\u0027s what gwtorm does, but that\u0027s unfortunate. I\u0027m sure there\u0027s some Java project somewhere with 256 character filenames. (I just checked and fortunately Gerrit is max 115 :)",
      "parentUuid": "09fc242a_3e8fa93d",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b41b715a_63cf025c",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 231,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-16T13:31:42Z",
      "side": 1,
      "message": "I guess it\u0027s probably not worth identifying OrmConcurrencyExceptions here, because who would be catching them?",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "09fc242a_de956546",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 231,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-06-16T15:02:44Z",
      "side": 1,
      "message": "We check for it above in line 139.",
      "parentUuid": "b41b715a_63cf025c",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6914c033_f9ca7750",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 231,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-16T17:45:02Z",
      "side": 1,
      "message": "That\u0027s OrmDuplicateKeyException which I see you\u0027ve done correctly. I was talking about OrmConcurrencyException, which presumably corresponds to some other H2 error code. But like I said I doubt it\u0027s necessary.",
      "parentUuid": "09fc242a_de956546",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4940dc42_d0b65c9d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 231,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-06-17T09:27:10Z",
      "side": 1,
      "message": "Oh, OrmConcurrencyException! I think it\u0027s not necessary. DialectH2 in gwtorm is also not caring about it.",
      "parentUuid": "6914c033_f9ca7750",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b41b715a_83fcfe7c",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 253,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-16T13:31:42Z",
      "side": 1,
      "message": "Use Ints.tryParse",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a9195874_f392900d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/H2AccountPatchReviewStore.java",
        "patchSetId": 1
      },
      "lineNbr": 253,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-06-17T09:27:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b41b715a_83fcfe7c",
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b41b715a_c3f6f69a",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/schema/Schema_127.java",
        "patchSetId": 1
      },
      "lineNbr": 55,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-16T13:31:42Z",
      "side": 1,
      "message": "We should also delete the table from the ReviewDb schema, ideally in the same upgrade, in which case this would be replaced with a SQL query on ReviewDb.",
      "range": {
        "startLine": 54,
        "startChar": 36,
        "endLine": 55,
        "endChar": 31
      },
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a9195874_733b20e4",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/schema/Schema_127.java",
        "patchSetId": 1
      },
      "lineNbr": 55,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-06-17T09:27:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b41b715a_c3f6f69a",
      "range": {
        "startLine": 54,
        "startChar": 36,
        "endLine": 55,
        "endChar": 31
      },
      "revId": "4c0d5283a35bdb5c1fed874ed8aaa055f6423210",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}