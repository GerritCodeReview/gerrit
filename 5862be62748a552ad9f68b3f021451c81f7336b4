{
  "pushCert": "certificate version 0.1\npusher A0D0EF51 1481275830 +0100\nnonce AOr0K+Q6YSrYFtjNob2Sfl0AbFXSGqJS2LtjuybEmAHxSCw6gTILsHY7Lj2KVPJc+50QkFTcd9R0\n\n0000000000000000000000000000000000000000 5862be62748a552ad9f68b3f021451c81f7336b4 refs/for/stable-2.13\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQEcBAABAgAGBQJYSnm2AAoJEFG1/Zeg0O9RLKAH/1Jf8X56EIbggd9MH1OGWs2O\n8JIqMEvHlvJLRcGpdn2H6EyGk+iG0YBKBuxiPNg4uK3kwrQ8o5h0IXAN/V1KKJRr\nmfj0yJ3MF+hlBHfVtALXniEh2RBzREUUx/1HPFxu7ceRS0Sn4LJdTYmX2YfIQts9\n7t5rE9ivxoZGBIFjUjIidfOp+sAu/pvtMnMg7CqmfiYdNRkpdbRz0DuoE/ZhZPQL\ns+WMM+iEXjC51XDsbTx/Ipfp0d5UchSOcvlQ7l8QcMXlrSsCGWW2FDNydyjkmtB0\nIG1AAbbfsPo8K3wom/gv1Ospjr+yphIWHD1fA7g3ANvc+S7LEsNk/CLyZVJFU+g\u003d\n\u003ddCv6\n-----END PGP SIGNATURE-----\n",
  "comments": [
    {
      "key": {
        "uuid": "0d8e0bb3_7dd6b7af",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/account/AccountManager.java",
        "patchSetId": 2
      },
      "lineNbr": 250,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-12-09T09:40:06Z",
      "side": 1,
      "message": "Here the external ID is created with the ID of the new account. As far as I see it is nowhere updated. Hence checking later if it matches the ID of the new account would always return true.",
      "revId": "5862be62748a552ad9f68b3f021451c81f7336b4",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a699be3_b7b508ad",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/account/AccountManager.java",
        "patchSetId": 2
      },
      "lineNbr": 261,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-12-09T09:40:06Z",
      "side": 1,
      "message": "Here we upsert the external ID. If the external ID belonged to another account, it\u0027s overwritten now. We would only get a duplicate key exception if this was an insert. But there was a reason to change it to upsert (see [1]).\n\n[1] https://gerrit-review.googlesource.com/50221",
      "revId": "5862be62748a552ad9f68b3f021451c81f7336b4",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0d8e0bb3_fd7e47cc",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/account/AccountManager.java",
        "patchSetId": 2
      },
      "lineNbr": 261,
      "author": {
        "id": 1011624
      },
      "writtenOn": "2016-12-09T09:50:01Z",
      "side": 1,
      "message": "Does this upsert really succeed for the username? \nOn line 293 we get a duplicateNameError, and looking into \nchangeUserName.call(), we should error out with INVALID_STATE, if there is already a username for this account, if I am not mistaken.",
      "revId": "5862be62748a552ad9f68b3f021451c81f7336b4",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a699be3_37e1f8b4",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/account/AccountManager.java",
        "patchSetId": 2
      },
      "lineNbr": 261,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-12-09T09:57:22Z",
      "side": 1,
      "message": "It must succeed otherwise we would fail already here, wouldn\u0027t we?\n\nThese are different external ID\u0027s:\n\n* extId uses SCHEME_GERRIT\n* the call in line 293 which fails user SCHEME_USERNAME",
      "parentUuid": "0d8e0bb3_fd7e47cc",
      "revId": "5862be62748a552ad9f68b3f021451c81f7336b4",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a699be3_57e26cbd",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/account/AccountManager.java",
        "patchSetId": 2
      },
      "lineNbr": 293,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-12-09T09:40:06Z",
      "side": 1,
      "message": "Here we set the username. extId has nothing to do with it.",
      "revId": "5862be62748a552ad9f68b3f021451c81f7336b4",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a699be3_f7ab8052",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/account/AccountManager.java",
        "patchSetId": 2
      },
      "lineNbr": 354,
      "author": {
        "id": 1011624
      },
      "writtenOn": "2016-12-09T09:33:05Z",
      "side": 1,
      "message": "We get the exception used here, so could check  if it is a DuplicateNameError?",
      "revId": "5862be62748a552ad9f68b3f021451c81f7336b4",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a699be3_77e770cc",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/account/AccountManager.java",
        "patchSetId": 2
      },
      "lineNbr": 354,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2016-12-09T09:40:06Z",
      "side": 1,
      "message": "Not sure if I understand.",
      "parentUuid": "5a699be3_f7ab8052",
      "revId": "5862be62748a552ad9f68b3f021451c81f7336b4",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}