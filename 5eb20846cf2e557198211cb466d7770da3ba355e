{
  "comments": [
    {
      "key": {
        "uuid": "451343a1_c4f8fde8",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2017-10-25T08:50:10Z",
      "side": 1,
      "message": "We are using the same construct with merge_jars:\n\n  tools/bzl/maven.bzl:  return (\u0027$(location //tools:merge_jars) $@ \u0027\n\nand merge_jar.py has exactly the same construct:\n\n  #!/usr/bin/env python\n\nAnd I guess it works for you, as HTML document generation happens much later in the build process. The only difference is that merge_jar is called form genrule, while replace_macros s called from Skylark rule. I think, I cannot reproduce this problem on Bazel 0.6.\n\nFirst question, can you try to replace:\n\n  ctx.actiosn.run_shell()\n\nwith the old and deprecated one\n\n  ctx.action()\n\nas it was used on stable-2.14?\n\nSecond question: We (you?) should create a very small reproducer (GH project) and file an issue against upstream.",
      "revId": "5eb20846cf2e557198211cb466d7770da3ba355e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "072898cf_69453348",
        "filename": "tools/bzl/asciidoc.bzl",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2017-10-25T05:49:42Z",
      "side": 1,
      "message": "To make it portable (on the other platform it is called python.exe), this should be:\n\n  ctx.which(\"python\")\n\nI know that it is used the same way in js.bzl, but this is wrong too.",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 12
      },
      "revId": "5eb20846cf2e557198211cb466d7770da3ba355e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f065f90e_d6411b8d",
        "filename": "tools/bzl/asciidoc.bzl",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2017-10-25T05:53:04Z",
      "side": 1,
      "message": "See this issue: [1] and the fix: [2] for more context.\n\n* [1] https://github.com/bazelbuild/bazel/issues/3477\n* [2] https://bazel-review.googlesource.com/c/bazel/+/14890/?polygerrit\u003d1",
      "parentUuid": "072898cf_69453348",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 12
      },
      "revId": "5eb20846cf2e557198211cb466d7770da3ba355e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "84fb53ec_b10712fa",
        "filename": "tools/bzl/asciidoc.bzl",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2017-10-25T06:22:11Z",
      "side": 1,
      "message": "That doesn\u0027t work.\n\n  type \u0027ctx\u0027 has no method which(string)",
      "parentUuid": "f065f90e_d6411b8d",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 12
      },
      "revId": "5eb20846cf2e557198211cb466d7770da3ba355e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "93d2d0e5_91b7d337",
        "filename": "tools/bzl/asciidoc.bzl",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2017-10-25T06:23:50Z",
      "side": 1,
      "message": "And the bazel-review link doesn\u0027t work for me.  I get 404.",
      "parentUuid": "84fb53ec_b10712fa",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 12
      },
      "revId": "5eb20846cf2e557198211cb466d7770da3ba355e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5514cd49_7202c7f0",
        "filename": "tools/bzl/asciidoc.bzl",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2017-10-25T06:34:29Z",
      "side": 1,
      "message": "Ah, my mistake. ctx.which() is only available for repository rules, that the asciidoc.bzl is not (but js.bzl is). So that you would have to implement the OS detection yourself, and fall back to using \"python.exe\" instead of \"python\" on the other platform.",
      "parentUuid": "84fb53ec_b10712fa",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 12
      },
      "revId": "5eb20846cf2e557198211cb466d7770da3ba355e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4ab013be_1f54b5b1",
        "filename": "tools/bzl/asciidoc.bzl",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2017-10-25T06:35:36Z",
      "side": 1,
      "message": "https://bazel-review.googlesource.com/?polygerrit\u003d0#/c/bazel/+/14890/",
      "parentUuid": "93d2d0e5_91b7d337",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 12
      },
      "revId": "5eb20846cf2e557198211cb466d7770da3ba355e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3cf2e46e_bd4323d2",
        "filename": "tools/bzl/asciidoc.bzl",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2017-10-25T06:40:45Z",
      "side": 1,
      "message": "I\u0027m not sure that I want to make such an invasive change on the stable branch.  Given that it works the same way for js.bzl I would prefer to keep it like this and do a proper fix on master.\n\nThe bazel-review link is still giving 404.  Is it a private change?",
      "parentUuid": "4ab013be_1f54b5b1",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 12
      },
      "revId": "5eb20846cf2e557198211cb466d7770da3ba355e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f5331bd9_333ef638",
        "filename": "tools/bzl/asciidoc.bzl",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2017-10-25T06:50:23Z",
      "side": 1,
      "message": "\u003e I\u0027m not sure that I want to make such an invasive change on the\n \u003e stable branch.  Given that it works the same way for js.bzl I would\n \u003e prefer to keep it like this and do a proper fix on master.\n\nSorry, this is contra productive to my efforts to make Bazel build tool chain portable. Again, js.bzl is repository rule and thus not the same.\n \n \u003e The bazel-review link is still giving 404.  Is it a private change?\n\nIndeed. Marked is as non private.",
      "parentUuid": "3cf2e46e_bd4323d2",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 12
      },
      "revId": "5eb20846cf2e557198211cb466d7770da3ba355e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cd7f86a5_52d926c7",
        "filename": "tools/bzl/asciidoc.bzl",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2017-10-25T06:54:24Z",
      "side": 1,
      "message": "\u003e Sorry, this is contra productive to my efforts to make Bazel build tool chain portable. Again, js.bzl is repository rule and thus not the same.\n\u003e  \n\nOK.  Then can you help to fix it?",
      "parentUuid": "f5331bd9_333ef638",
      "range": {
        "startLine": 37,
        "startChar": 4,
        "endLine": 37,
        "endChar": 12
      },
      "revId": "5eb20846cf2e557198211cb466d7770da3ba355e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bbeca2fc_c622d1a4",
        "filename": "tools/bzl/asciidoc.bzl",
        "patchSetId": 2
      },
      "lineNbr": 51,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2017-10-30T10:06:19Z",
      "side": 1,
      "message": "Check this design document: [1]. Setting use_default_shell_env \u003d True, in combination with specifying PATH with --action-env\u003dPATH in one of the Bazel configuration files  (e.g.: $HOME/.bazel.rc) should fix it for you, without explicitly adding \"python\" on line 37 above?\n\nSo, just add this line to your $HOME/.bazel.rc file:\n\n  build --action_env\u003dPATH\n\nand revert the change on line 37 above.\n\n* [1] https://bazel.build/designs/2016/06/21/environment.html",
      "range": {
        "startLine": 51,
        "startChar": 4,
        "endLine": 51,
        "endChar": 33
      },
      "revId": "5eb20846cf2e557198211cb466d7770da3ba355e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c1e1c487_818c3cd2",
        "filename": "tools/bzl/asciidoc.bzl",
        "patchSetId": 2
      },
      "lineNbr": 51,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2017-10-30T10:07:41Z",
      "side": 1,
      "message": "Typo: a user-specific file, located in ~/.bazelrc.",
      "parentUuid": "bbeca2fc_c622d1a4",
      "range": {
        "startLine": 51,
        "startChar": 4,
        "endLine": 51,
        "endChar": 33
      },
      "revId": "5eb20846cf2e557198211cb466d7770da3ba355e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}