{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "35051964_c3be69b8",
        "filename": "polygerrit-ui/app/models/change/change-model.ts",
        "patchSetId": 3
      },
      "lineNbr": 171,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2024-01-09T08:13:59Z",
      "side": 0,
      "message": "I think you did not address this challenge. If your preference is to use `FIRST_PARENT`, but then you select `PARENT` from the patchset dropdown, how will the view model or this compute method pick up that change?",
      "range": {
        "startLine": 166,
        "startChar": 71,
        "endLine": 171,
        "endChar": 39
      },
      "revId": "5fb7efabcef2dc93a2231a946b891aa830e95a17",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f600b01b_bb477b60",
        "filename": "polygerrit-ui/app/models/change/change-model.ts",
        "patchSetId": 3
      },
      "lineNbr": 171,
      "author": {
        "id": 1010516
      },
      "writtenOn": "2024-01-09T09:11:15Z",
      "side": 0,
      "message": "If I understand this concern correctly, it is fixed by removing the extra condition in line 155.",
      "parentUuid": "35051964_c3be69b8",
      "range": {
        "startLine": 166,
        "startChar": 71,
        "endLine": 171,
        "endChar": 39
      },
      "revId": "5fb7efabcef2dc93a2231a946b891aa830e95a17",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fcb474f7_0144581b",
        "filename": "polygerrit-ui/app/models/change/change-model.ts",
        "patchSetId": 3
      },
      "lineNbr": 171,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2024-01-09T09:15:56Z",
      "side": 0,
      "message": "I don\u0027t think so. Did you try it out?\n\nThe problem is that ultimately the view model is identical to the information that is contained in the URL. And the URL currently has no way of making a distinction between `undefined` and `PARENT`.",
      "parentUuid": "f600b01b_bb477b60",
      "range": {
        "startLine": 166,
        "startChar": 71,
        "endLine": 171,
        "endChar": 39
      },
      "revId": "5fb7efabcef2dc93a2231a946b891aa830e95a17",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f23d3977_aff1bbf7",
        "filename": "polygerrit-ui/app/models/change/change-model.ts",
        "patchSetId": 3
      },
      "lineNbr": 171,
      "author": {
        "id": 1010516
      },
      "writtenOn": "2024-01-09T09:20:51Z",
      "side": 0,
      "message": "What should I check? When I set First Parent as the default, opening the change without the PS part (https://server/c/project/+/22038) shows First Parent, and if I choose Auto Merge, the URL is changed to https://server/c/project/+/22038/1 (1 is the PS number) and it works.\n\nIf the default is Auto Merge then the URL without PS uses Auto Merge, and if I choose First Parent it changes to https://server/c/project/+/22038/-1..1 and it works.\n\nIs that what you meant, or should I test something else?",
      "parentUuid": "fcb474f7_0144581b",
      "range": {
        "startLine": 166,
        "startChar": 71,
        "endLine": 171,
        "endChar": 39
      },
      "revId": "5fb7efabcef2dc93a2231a946b891aa830e95a17",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6db0ccde_6330bffa",
        "filename": "polygerrit-ui/app/models/change/change-model.ts",
        "patchSetId": 3
      },
      "lineNbr": 171,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2024-01-09T11:39:55Z",
      "side": 0,
      "message": "Yeah, so it works somewhat, but it is still a bit weird:\n\n1. If FIRST_PARENT is your chosen default, then there is no URL for showing you the *latest* patchset against AUTO_MERGE. And for ...22038 the chose parent is FIRST_PARENT, but for ...222038/1 the chosen parent is AUTO_MERGE, which is very confusing.\n\n2. You cannot share URLs with other users and expect them to see the same thing.\n\nI think there is no way around somehow encoding AUTO_MERGE in the URL, *if* we want to support this feature.\n\nI would actually like to take a step back and discuss whether we need this feature at all. We have not had the feature for more than two years, and at Google nobody really complained about it. So I would like to remove the feature entirely and thus reduce the complexity of our system.\n\nWhy would users need a different default choice for which parent to see? What is the benefit?",
      "parentUuid": "f23d3977_aff1bbf7",
      "range": {
        "startLine": 166,
        "startChar": 71,
        "endLine": 171,
        "endChar": 39
      },
      "revId": "5fb7efabcef2dc93a2231a946b891aa830e95a17",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a171f138_efe2f07a",
        "filename": "polygerrit-ui/app/models/change/change-model.ts",
        "patchSetId": 3
      },
      "lineNbr": 171,
      "author": {
        "id": 1010516
      },
      "writtenOn": "2024-01-09T12:02:32Z",
      "side": 0,
      "message": "1. The same claim holds also for FIRST_PARENT in the current implementation. There is no URL for FIRST_PARENT against latest patch set, and I agree the URLs are a bit confusing, but this is already the case before my change.\n2. This is right, but only for the main change URL. If you share a file link, it always contains PS info.\n\nI see that there were reported bugs in the past when this feature broke in PG. See https://issues.gerritcodereview.com/issues/40008165 and https://issues.gerritcodereview.com/issues/40008170.\n\nI\u0027m in charge of merges in my project, and I care much more about the diff against first parent than the diff with auto-merge in the review process.\n\nSo when I click a change from the list, or from the review email, I don\u0027t want to choose Parent 1 every time. And when there are new comments and I reload the page, I also need to choose Parent 1. This is very annoying.",
      "parentUuid": "6db0ccde_6330bffa",
      "range": {
        "startLine": 166,
        "startChar": 71,
        "endLine": 171,
        "endChar": 39
      },
      "revId": "5fb7efabcef2dc93a2231a946b891aa830e95a17",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b61f5dd6_fc6bdb6a",
        "filename": "polygerrit-ui/app/models/change/change-model.ts",
        "patchSetId": 3
      },
      "lineNbr": 171,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2024-01-09T17:32:13Z",
      "side": 0,
      "message": "I understand that my review may be a bit frustrating, but I don\u0027t really see a good way around substantially revising how we encode the base patchset in the URL.\n\nFile URLs can also have a `.../1/...` indicating that the right hand patchset is 1 and left side is the default parent.\n\nIf \"First Parent\" is your default, then `.../1/...` should show you the first parent on the left, but it shows you \"Auto Merge\". But if we switch that to actually showing you the first parent, then there is no way to show auto merge. We would have to explicitly have to establish `0` (or something else) to mean \"auto merge\".\n\nAnd I am not sure whether we have considered it all in our current conversation. So this needs more design considerations, more tests and more reviews than just uploading another slightly modified patchset, unfortunately. Sorry. :-/\n\nI have also discussed this with other team members. They have brought up another good point: This preference has been broken for 5 years, so it might be very surprising for users with a \"FIRST PARENT\" preference, because they may not remember setting that, and they will suddenly get a different behavior.",
      "parentUuid": "a171f138_efe2f07a",
      "range": {
        "startLine": 166,
        "startChar": 71,
        "endLine": 171,
        "endChar": 39
      },
      "revId": "5fb7efabcef2dc93a2231a946b891aa830e95a17",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "567e1842_2e0a1eb5",
        "filename": "polygerrit-ui/app/models/change/change-model.ts",
        "patchSetId": 3
      },
      "lineNbr": 171,
      "author": {
        "id": 1010516
      },
      "writtenOn": "2024-01-09T17:38:57Z",
      "side": 0,
      "message": "I see.\n\nI have another suggestion (but I don\u0027t know how to implement it, I don\u0027t do frontend ðŸ˜Š). How about *redirecting* from the change page to the relevant one (/$last or /-1..$last) according to the user preference?",
      "parentUuid": "b61f5dd6_fc6bdb6a",
      "range": {
        "startLine": 166,
        "startChar": 71,
        "endLine": 171,
        "endChar": 39
      },
      "revId": "5fb7efabcef2dc93a2231a946b891aa830e95a17",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2266a827_33afe767",
        "filename": "polygerrit-ui/app/models/change/change-model.ts",
        "patchSetId": 3
      },
      "lineNbr": 171,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2024-01-10T07:51:02Z",
      "side": 0,
      "message": "Yeah, I have also thought about that, but redirecting has its own set of issues: 1. You can only redirect when the change is loaded. 2. If you choose \"auto merge\" explicitly, then how do we know that we don\u0027t have to redirect? We cannot encode \"auto merge\" in the URL.\n\nI don\u0027t think that there is a solution to this problem without being able to encode \"auto merge\" as `0` (or something else) in the URL. And touching that and rolling the change out would probably cost me about half a week. So I am hesitant to invest into this, although I understand that this feature is desirable for you and a small subset of other Gerrit users. Also, coaching someone else (outside of the Gerrit dev team) and reviewing their code would probably be a similar amount of work. So in this case I don\u0027t see a good way forward at the moment.\n\nAgain, apologies for not having a better suggestion and making this frustrating for you. :-/",
      "parentUuid": "567e1842_2e0a1eb5",
      "range": {
        "startLine": 166,
        "startChar": 71,
        "endLine": 171,
        "endChar": 39
      },
      "revId": "5fb7efabcef2dc93a2231a946b891aa830e95a17",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}