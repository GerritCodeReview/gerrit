{
  "comments": [
    {
      "key": {
        "uuid": "fdb9e9f9_98a2d597",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 18,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2013-06-04T16:34:03Z",
      "side": 1,
      "message": "Is base-ref the base on which the new-branch-name has to be created? If yes, why not use the parent commit of the branch-creation-request commit to specify the base? Then, it is clear where to create the empty commit:\n\n    o (branch-creation-request)\n   /\n  o A\n  |\n  o\n\nThe new branch would point to the commit A which is the parent of the branch-creation-request.\n\n\nOtherwise, if the Base: is specified in the commit message then the empty commit could be created on any commit. For me, it feels unintuitive.",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9dd0ed3c_5533eccc",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 18,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2013-06-05T00:11:51Z",
      "side": 1,
      "message": "The empty commit is on refs/meta/requests, so the parent commit is not going to be the one from which the new branch is created.",
      "parentUuid": "fdb9e9f9_98a2d597",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fdb9e9f9_b8a3598d",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 18,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2013-06-05T08:07:24Z",
      "side": 1,
      "message": "I know that what I wrote was discussed (during the last Hackathon) but Edwin couldn\u0027t recall the details.\n\nCould you provide some more details from the discussion? Why is \"my\" proposal not going to work?",
      "parentUuid": "9dd0ed3c_5533eccc",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bdd3f145_765f10f5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 18,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2013-06-05T08:26:16Z",
      "side": 1,
      "message": "Yes, we discussed a solution like this and rejected it because it would result in unwanted empty commits on the actual branch.\n\nSay your master branch looks like this:\n\n o C (master)\n |\n o B\n |\n o A\n\nAnd you want to create a new branch `new` from commit `B`.\n\nWith your proposal, pushing an empty commit on the actual branch, you would end up with:\n\n o C (master)   /-o D (new)\n |             /\n o B ----------\n | \n o A\n\nWhereas with the proposal in this change, you end up with:\n o C (master)\n |\n o B (new)\n |\n o A\n\n(the empty commit still exists but it\u0027s hidden away on the refs/meta/request branch)",
      "parentUuid": "fdb9e9f9_b8a3598d",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1dea3def_5188b460",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 18,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2013-06-05T08:36:30Z",
      "side": 1,
      "message": "I think there is a misunderstanding about what I proposed. In my proposal the empty commit would still be pushed to the refs/meta/request branch, just that its parent commit would be the base of the new branch.\n\nTaking your example the request would look like:\n o C (master)   /-o D (refs/meta/reqeust)\n |             /\n o B ----------\n | \n o A\n\nand, after the new branch gets created:\n\n o C (master)   /-o D (refs/meta/request)\n |             /\n o B --------------- (new)\n | \n o A\n\nNo extra empty commit on the \"new\" branch.",
      "parentUuid": "bdd3f145_765f10f5",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9dd0ed3c_55e1acf8",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 18,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2013-06-05T08:49:45Z",
      "side": 1,
      "message": "Maybe I\u0027m still misunderstanding it but I\u0027m not sure how that would work.\n\nThe commits on master wouldn\u0027t be reachable from refs/meta/request.  They don\u0027t have any common base with master. Same as the refs/meta/config and refs/notes/review branches.\n\n o C (master)\n |\n o B\n |\n o A\n \n o G (refs/meta/requests)\n |\n o F\n |\n o E\n |\n o D\n \n o K (refs/meta/config)\n |\n o J\n |\n o I\n |\n o H\n \n o O (refs/notes/review)\n |\n o N\n |\n o M\n |\n o L",
      "parentUuid": "1dea3def_5188b460",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fdb9e9f9_38b869b5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 18,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2013-06-05T09:23:27Z",
      "side": 1,
      "message": "\u003e The commits on master wouldn\u0027t be reachable from refs/meta/request. They don\u0027t have any common base with master. Same as the refs/meta/config and refs/notes/review branches.\n\nI cannot think of any issues with commits on master (or any other refs/heads/*) being reachable from a meta branch. We don\u0027t have such cases yet but this shouldn\u0027t mean that it is forbidden.",
      "parentUuid": "9dd0ed3c_55e1acf8",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bdd3f145_f6efa0e8",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 18,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2013-06-05T09:33:45Z",
      "side": 1,
      "message": "My point wasn\u0027t about visibility of commits from a security point of view.\n\nWhat does the history of refs/meta/requests look like if every commit on it is based on a different commit from master (or any other random branch)?\n\nIf you look for example at refs/meta/config or refs/notes/review all the commits are in sequence, based on the previous commit on the branch.",
      "parentUuid": "fdb9e9f9_38b869b5",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fdb9e9f9_f8c2f12e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 18,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2013-06-05T10:27:51Z",
      "side": 1,
      "message": "\u003e What does the history of refs/meta/requests look like if every commit on it is based on a different commit from master (or any other random branch)?\n\nMaybe this is the main question. I was also thinking about the (meaning of and the commit graph of) the refs/meta/requests branch history in both your and my proposal. While discussing it with Edwin, he even made another interesting question: do we need the history of the refs/meta/requests branch at all? Should the only purpose of refs/meta/requests branch be to push a branch creation request for review? On submit, the new branch is created, the change closed but the refs/meta/requests is not updated? Does it make sense?\n\n\u003e If you look for example at refs/meta/config or refs/notes/review all the commits are in sequence, based on the previous commit on the branch.\n\nAssuming we would like to merge the empty commits into the refs/meta/requests I could also imagine creation of merge commits on that branch so that we have still see the sequence between the branch creation requests.\n\nAgain, the main question for me right now is: does the history of the refs/meta/requests justify its existence?",
      "parentUuid": "bdd3f145_f6efa0e8",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bdd8516c_8ef83b02",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 18,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2013-06-05T18:34:42Z",
      "side": 1,
      "message": "I think that the history of refs/meta/requests should reflect all the requests that have been merged.  This provides an audit log for who requested new branches.  \n\nI also think that this history needs to be disconnected from the real repository branches because real branches may get deleted and obliterated and we don\u0027t want the references to objects on refs/meta/requests getting in the way of garbage collection/pruning of those objects.  \n\nAlso, how would these requests ever get merged to refs/meta/requests if they are connected to real branches, wouldn\u0027t that leave the whole thing open to meaningless merge conflicts?",
      "parentUuid": "fdb9e9f9_f8c2f12e",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e0305ecf_072d7696",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 41,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2013-05-23T02:55:02Z",
      "side": 1,
      "message": "The above 2 pieces don\u0027t feel 100% essential for this change and I propose you perhaps make them in a follow on change in order to keep this one simple.",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1decfd78_c120e2a6",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/MergeOp.java",
        "patchSetId": 3
      },
      "lineNbr": 590,
      "author": {
        "id": 1003883
      },
      "writtenOn": "2013-05-23T02:55:02Z",
      "side": 1,
      "message": "I really liked Gustaf\u0027s idea to make special merge options register interest in a branch instead of adding code to this class for each special case (or maybe it just registers interest in all branches?).  So perhaps make something like a MergeListener Interface with several methods that MergeOp would call.  Here it would call  validateChange(), and below it could call a preMerge() method, likely it would also have a postMerge() method.  But since you don\u0027t need that last one yet, it could come later.  We just created a listener for that last method and will be pushing the idea up for review soon, maybe it will be something you could build upon.",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "005e52fd_38a0c9dc",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/MergeOp.java",
        "patchSetId": 3
      },
      "lineNbr": 590,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2013-05-23T04:21:46Z",
      "side": 1,
      "message": "It looks like the CommitValidationListener framework could be reused here.  I\u0027ll have a play around with it this afternoon.",
      "parentUuid": "1decfd78_c120e2a6",
      "revId": "6132e14ae2594bb4a22bba9bbcbcdecc962aafbc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}