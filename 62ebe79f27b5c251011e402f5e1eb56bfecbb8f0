{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "4a8eb4c0_12d3098d",
        "filename": "Documentation/user-search.txt",
        "patchSetId": 7
      },
      "lineNbr": 345,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2022-09-28T13:47:57Z",
      "side": 1,
      "message": "It is not first 32766 characters but the number of characters that, when encoded, can first into 32766 bytes.",
      "revId": "62ebe79f27b5c251011e402f5e1eb56bfecbb8f0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "677d17d7_d6818a01",
        "filename": "Documentation/user-search.txt",
        "patchSetId": 7
      },
      "lineNbr": 345,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2022-09-28T15:08:59Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4a8eb4c0_12d3098d",
      "revId": "62ebe79f27b5c251011e402f5e1eb56bfecbb8f0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7c72653d_2e424a7d",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 7
      },
      "lineNbr": 1406,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2022-09-28T14:33:47Z",
      "side": 1,
      "message": "Can we use https://guava.dev/releases/19.0/api/docs/com/google/common/base/Ascii.html#truncate(java.lang.CharSequence,%20int,%20java.lang.String) instead?",
      "range": {
        "startLine": 1406,
        "startChar": 16,
        "endLine": 1406,
        "endChar": 31
      },
      "revId": "62ebe79f27b5c251011e402f5e1eb56bfecbb8f0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3d85c5f0_6af7a74b",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 7
      },
      "lineNbr": 1406,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2022-09-28T14:42:59Z",
      "side": 1,
      "message": "Looks like we cannot. From the Javadoc of that method:\n\n  Note: This method may work with certain non-ASCII text but is not safe for use with arbitrary Unicode text. It is mostly intended for use with text that is known to be safe for use with it (such as all-ASCII text) and for simple debugging text. When using this method, consider the following:\n  it may split surrogate pairs\nit may split characters and combining characters\nit does not consider word boundaries\nif truncating for display to users, there are other considerations that must be taken into account\nthe appropriate truncation indicator may be locale-dependent\nit is safe to use non-ASCII characters in the truncation indicator",
      "parentUuid": "7c72653d_2e424a7d",
      "range": {
        "startLine": 1406,
        "startChar": 16,
        "endLine": 1406,
        "endChar": 31
      },
      "revId": "62ebe79f27b5c251011e402f5e1eb56bfecbb8f0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9935656f_5d51225c",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 7
      },
      "lineNbr": 1407,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2022-09-28T13:47:57Z",
      "side": 1,
      "message": "This can allocate a lot of memory unnecessarily. We know that it can be at most maxBytes characters in the string (if they are all ASCII) so we can safely only use that prefix of the str:\n\n  str.substring(0, maxBytes).getBytes(UTF_8)",
      "range": {
        "startLine": 1407,
        "startChar": 22,
        "endLine": 1407,
        "endChar": 42
      },
      "revId": "62ebe79f27b5c251011e402f5e1eb56bfecbb8f0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c5be222d_2a59b481",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 7
      },
      "lineNbr": 1407,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2022-09-28T15:08:59Z",
      "side": 1,
      "message": "Done. However now one testcase fails, because substring() seems to split a 4-byte char in the middle, creating an invalid character. I will have another look at that.",
      "parentUuid": "9935656f_5d51225c",
      "range": {
        "startLine": 1407,
        "startChar": 22,
        "endLine": 1407,
        "endChar": 42
      },
      "revId": "62ebe79f27b5c251011e402f5e1eb56bfecbb8f0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "57c486cf_8ec2f756",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 7
      },
      "lineNbr": 1407,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2022-09-29T13:43:47Z",
      "side": 1,
      "message": "Java chars only support 16bit and thus 3- and 4-byte UTF-8 characters are stored in two chars (high- and low surrogate). String.substring() does not check for surrogate characters at the truncation sites.",
      "parentUuid": "c5be222d_2a59b481",
      "range": {
        "startLine": 1407,
        "startChar": 22,
        "endLine": 1407,
        "endChar": 42
      },
      "revId": "62ebe79f27b5c251011e402f5e1eb56bfecbb8f0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "86441f35_f41253c3",
        "filename": "javatests/com/google/gerrit/server/index/change/ChangeFieldTest.java",
        "patchSetId": 7
      },
      "lineNbr": 172,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2022-09-28T14:33:47Z",
      "side": 1,
      "message": "nit: I think probably s/clip/truncate/ everywhere, since that\u0027s the more commonly used term.",
      "range": {
        "startLine": 172,
        "startChar": 30,
        "endLine": 172,
        "endChar": 37
      },
      "revId": "62ebe79f27b5c251011e402f5e1eb56bfecbb8f0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "eac042f9_250105d8",
        "filename": "javatests/com/google/gerrit/server/index/change/ChangeFieldTest.java",
        "patchSetId": 7
      },
      "lineNbr": 172,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2022-09-28T15:08:59Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "86441f35_f41253c3",
      "range": {
        "startLine": 172,
        "startChar": 30,
        "endLine": 172,
        "endChar": 37
      },
      "revId": "62ebe79f27b5c251011e402f5e1eb56bfecbb8f0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}