{
  "comments": [
    {
      "key": {
        "uuid": "02aced05_8c36c73a",
        "filename": "Documentation/config-gerrit.txt",
        "patchSetId": 12
      },
      "lineNbr": 2837,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2016-03-03T13:16:46Z",
      "side": 1,
      "message": "Instead of requiring this configuration, would it be possible to make core Gerrit find the first plugin that implements the API?  And raise an error during startup if there are more than one?",
      "range": {
        "startLine": 2828,
        "startChar": 0,
        "endLine": 2837,
        "endChar": 17
      },
      "revId": "68714ba635a1ff9a539757388b9d4553d3c31f4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "425fc5cb_26e5d61f",
        "filename": "Documentation/config-gerrit.txt",
        "patchSetId": 12
      },
      "lineNbr": 2837,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2016-03-03T15:30:19Z",
      "side": 1,
      "message": "how could gerrit-core detect if a plugin wants to register a servlet on  \n\n com.google.gerrit.httpd.plugins.LfsPluginServlet.URL_REGEX\n\n?",
      "parentUuid": "02aced05_8c36c73a",
      "range": {
        "startLine": 2828,
        "startChar": 0,
        "endLine": 2837,
        "endChar": 17
      },
      "revId": "68714ba635a1ff9a539757388b9d4553d3c31f4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e2bfd930_43b1460d",
        "filename": "Documentation/config-gerrit.txt",
        "patchSetId": 12
      },
      "lineNbr": 2837,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2016-03-04T01:09:13Z",
      "side": 1,
      "message": "I was assuming in the same way that listeners are registered, but maybe I\u0027m missing something.\n\nIf we do it in the config like this, how about making the setting the explicit class name rather than just a plugin name?",
      "parentUuid": "425fc5cb_26e5d61f",
      "range": {
        "startLine": 2828,
        "startChar": 0,
        "endLine": 2837,
        "endChar": 17
      },
      "revId": "68714ba635a1ff9a539757388b9d4553d3c31f4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dc19de73_d3ff9478",
        "filename": "Documentation/dev-plugins.txt",
        "patchSetId": 12
      },
      "lineNbr": 2093,
      "author": {
        "id": 1010134
      },
      "writtenOn": "2016-03-14T12:23:26Z",
      "side": 1,
      "message": "how about abstracting this class into something like\n\n  public abstract LfsHttpPluginModule extends HttpPluginModule {\n    @Override\n    protected void configureServlets() {\n      serveRegex(URL_REGEX).with(lfsServletClass());\n    }\n\n    protected abstract Class\u003cLfsProtocolServlet\u003e lfsServletClass();\n  }\n\nthen plugin implementation would look like:\n\n  public class HttpModule extends LfsHttpPluginModule {\n    @Override\n    protected Class\u003cLfsProtocolServlet\u003e lfsServletClass() {\n      return LfsApiServlet.class;\n    }\n  }",
      "range": {
        "startLine": 2087,
        "startChar": 0,
        "endLine": 2093,
        "endChar": 1
      },
      "revId": "68714ba635a1ff9a539757388b9d4553d3c31f4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "425fc5cb_6622ee9c",
        "filename": "gerrit-httpd/src/main/java/com/google/gerrit/httpd/plugins/HttpPluginModule.java",
        "patchSetId": 12
      },
      "lineNbr": 36,
      "author": {
        "id": 1007114
      },
      "writtenOn": "2016-03-02T07:38:54Z",
      "side": 1,
      "message": "I am confused.In https://gerrit-review.googlesource.com/#/c/74585/10 you bind the LfsApiServlet to URL_REGEX. Wouldn\u0027t this be enough? What\u0027s the purpose of this LfsPluginServlet?",
      "range": {
        "startLine": 35,
        "startChar": 0,
        "endLine": 36,
        "endChar": 72
      },
      "revId": "68714ba635a1ff9a539757388b9d4553d3c31f4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "62684971_e76102b3",
        "filename": "gerrit-httpd/src/main/java/com/google/gerrit/httpd/plugins/HttpPluginModule.java",
        "patchSetId": 12
      },
      "lineNbr": 36,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2016-03-02T10:49:21Z",
      "side": 1,
      "message": "\u003e Wouldn\u0027t this be enough?\n\nNo, it wouldn\u0027t because when a plugin serves some path X then Gerrit\nexposes that under \"/plugins/\u003cplugin-name\u003e/X. Therefore the URL_REGEX would be served under /plugins/lfs-storage-s3/URL_REGEX. Consequently, this would require additional configuration of every git-lfs client because the LFS protocol endpoint is not at its default URL.\n\n\u003eWhat\u0027s the purpose of this LfsPluginServlet?\n\nIt has 2 purposes:\n1.  to expose the standard LFS endpoint to Gerrit clients:\n/project-name/info/lfs/objects/batch\n2. forward LFS protocol requests to configured LFS plugin.",
      "parentUuid": "425fc5cb_6622ee9c",
      "range": {
        "startLine": 35,
        "startChar": 0,
        "endLine": 36,
        "endChar": 72
      },
      "revId": "68714ba635a1ff9a539757388b9d4553d3c31f4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9c37666b_011e6aa5",
        "filename": "gerrit-httpd/src/main/java/com/google/gerrit/httpd/plugins/HttpPluginModule.java",
        "patchSetId": 12
      },
      "lineNbr": 36,
      "author": {
        "id": 1020422
      },
      "writtenOn": "2016-03-23T03:17:48Z",
      "side": 1,
      "message": "As LfsPluginServlet will forward LFS protocol requests to configured LFS\n\n plugin, the later then neednot bind the LfsApiServlet to URL_REGEX \n\nanymore except the purpose here  is to provide 2 ways for client to call. \n\n 1  /plugins/\u003cplugin-name\u003e/URL_REGEX\n\n 2  URL_REGEX\n\nbut this is not mentioned in commit message.",
      "parentUuid": "62684971_e76102b3",
      "range": {
        "startLine": 35,
        "startChar": 0,
        "endLine": 36,
        "endChar": 72
      },
      "revId": "68714ba635a1ff9a539757388b9d4553d3c31f4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "62684971_27015ae8",
        "filename": "gerrit-httpd/src/main/java/com/google/gerrit/httpd/plugins/LfsPluginServlet.java",
        "patchSetId": 12
      },
      "lineNbr": 58,
      "author": {
        "id": 1007114
      },
      "writtenOn": "2016-03-02T07:38:54Z",
      "side": 1,
      "message": "final?",
      "range": {
        "startLine": 58,
        "startChar": 2,
        "endLine": 58,
        "endChar": 9
      },
      "revId": "68714ba635a1ff9a539757388b9d4553d3c31f4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "62684971_e713423f",
        "filename": "gerrit-httpd/src/main/java/com/google/gerrit/httpd/plugins/LfsPluginServlet.java",
        "patchSetId": 12
      },
      "lineNbr": 64,
      "author": {
        "id": 1007114
      },
      "writtenOn": "2016-03-02T07:38:54Z",
      "side": 1,
      "message": "We should consider to have a dedicated LfsConfig class (depending on how ample the configuration will get).",
      "range": {
        "startLine": 64,
        "startChar": 22,
        "endLine": 64,
        "endChar": 59
      },
      "revId": "68714ba635a1ff9a539757388b9d4553d3c31f4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "425fc5cb_86504aac",
        "filename": "gerrit-httpd/src/main/java/com/google/gerrit/httpd/plugins/LfsPluginServlet.java",
        "patchSetId": 12
      },
      "lineNbr": 64,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2016-03-02T23:10:55Z",
      "side": 1,
      "message": "I think that\u0027s the only configuration needed in gerrit-core to delegate LFS calls to the configured plugin. All other lfs configuration will be done in the plugin.",
      "parentUuid": "62684971_e713423f",
      "range": {
        "startLine": 64,
        "startChar": 22,
        "endLine": 64,
        "endChar": 59
      },
      "revId": "68714ba635a1ff9a539757388b9d4553d3c31f4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "229d71d4_0d2c91db",
        "filename": "lib/JGIT_VERSION",
        "patchSetId": 12
      },
      "lineNbr": 0,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2016-03-03T13:13:32Z",
      "side": 1,
      "message": "JGit was already upgraded to this version on master [1].  If you rebase on master it\u0027s not necessary to change this file or any of the others under lib/ and then the Library-Compliance label will not be needed.\n\n[1] https://gerrit-review.googlesource.com/75359",
      "revId": "68714ba635a1ff9a539757388b9d4553d3c31f4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "425fc5cb_06e8daf6",
        "filename": "lib/JGIT_VERSION",
        "patchSetId": 12
      },
      "lineNbr": 0,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2016-03-03T15:30:19Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "229d71d4_0d2c91db",
      "revId": "68714ba635a1ff9a539757388b9d4553d3c31f4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}