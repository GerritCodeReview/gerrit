{
  "pushCert": "certificate version 0.1\npusher Dave Borowitz \u003cdborowitz@google.com\u003e 1467050222 -0400\nnonce ALCdEotvSTjuuvs4XNsTT8kFyZ/TXa50PK+jeJoQ7hWE//GA65zfts2iZQyZ15Bf/uGz1uIXo99+\n\n0000000000000000000000000000000000000000 696d956d294317db6d9746ab637bc4ae87222e65 refs/for/master\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQIcBAABAgAGBQJXcWjuAAoJEF/XxZqaEoiMhIYP/1Fd3bAX+JAgXTNXIkR/oDvi\nsP/5/ZvVZIbrafymkhNihNhT0xB0BBT6Fcc/4SiLkxBawGfa4/8wN0G/pejcl2Ea\nygujJ7dTQrfUJUXn9IlQs47pz5Xdw779BZ4Vgcj+aXIQ+a1ntbefBMiFoj0aqgUB\nTDo8+E7GAV1IsaqWxw51NI/oSx6+cKVsEDkcKtnyrkIA3KhdouUFxMeucXDRRduL\nDZrpalstvhCYL66siajkwCEthIxDSyDSZ0QfzqFy5b8pH1fBe5aPhOKuLJHGESpG\nHihXtMmkD90NKSvhtPy1iRyBUdjsjaQC1gvsV/Y+Hd2e8k08aWccixk9ITMtMZlZ\nSuRZkVCQOa3z8zV4M7/774bYYTzzxaxd8Br7OYvvKpDjKKelsn2dX/+57junlSS+\nLMCvmxPRRkoDz4S5ylxgUNk0v9nYbDLxKe71n/MEhtHFppdGw8VOakMJ4qS5Q0Nc\nRmR9lyBR6xiMtSre5eHiTwOSIIOZ8VLg6uba9o75Dsyfop8wT4dnxi4KA+Pu2AsO\no165ePrChrnWy/J5ywwlKyXtw8QApgLj8fuvQ30W4X6fx+sTWh0PBneidXX4Fn7O\nuD9ddXZWw/pIAEgjNF+Mx1DlyYTykqPyY12uHFgcZybDR4mV8Trhazjc/LqJvJQh\nqukS16fOFSRI5B9ReV0m\n\u003dShhV\n-----END PGP SIGNATURE-----\n",
  "comments": [
    {
      "key": {
        "uuid": "2043bf51_6fab5187",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NotesMigration.java",
        "patchSetId": 4
      },
      "lineNbr": 84,
      "author": {
        "id": 1019407
      },
      "writtenOn": "2016-06-27T18:30:02Z",
      "side": 1,
      "message": "This is only possible if write is true. If write is true, why would there be an error?\n\nIs \"commit\" the wrong error here? For read-only, you want to build the change but not actually commit it. Is \"stage\" better?",
      "range": {
        "startLine": 82,
        "startChar": 26,
        "endLine": 84,
        "endChar": 25
      },
      "revId": "696d956d294317db6d9746ab637bc4ae87222e65",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "002a3b7a_4eb093f3",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NotesMigration.java",
        "patchSetId": 4
      },
      "lineNbr": 84,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-27T18:34:48Z",
      "side": 1,
      "message": "\u003e Is \"commit\" the wrong error here?\n\nAssuming you mean s/error/verb/\n\n\u003e Is \"stage\" better?\n\nLooking at callers in BatchUpdate, this is called both before staging the updates (l. 812) and before committing (l. 653). So, neither?",
      "parentUuid": "2043bf51_6fab5187",
      "range": {
        "startLine": 82,
        "startChar": 26,
        "endLine": 84,
        "endChar": 25
      },
      "revId": "696d956d294317db6d9746ab637bc4ae87222e65",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2043bf51_0faa857f",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NotesMigration.java",
        "patchSetId": 4
      },
      "lineNbr": 84,
      "author": {
        "id": 1019407
      },
      "writtenOn": "2016-06-27T19:12:50Z",
      "side": 1,
      "message": "Yes \"staging\" the way I suggested here is overriding the main staging concept. This really seems to be more about rebuilding changes rather than writing them. \"rebuildChanges()\"?",
      "parentUuid": "002a3b7a_4eb093f3",
      "range": {
        "startLine": 82,
        "startChar": 26,
        "endLine": 84,
        "endChar": 25
      },
      "revId": "696d956d294317db6d9746ab637bc4ae87222e65",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "002a3b7a_aeb817d6",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NotesMigration.java",
        "patchSetId": 4
      },
      "lineNbr": 84,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-27T19:40:10Z",
      "side": 1,
      "message": "\u003e This really seems to be more about rebuilding changes rather than writing them\n\ncommitChangeWrites is about executing updates, it\u0027s called from BatchUpdate#executeChangeOps and BatchUpdate.ChangeTask#call. Within ChangeTask it\u0027s used to guard whether we should stage the update, because ChangeTasks never actually execute the update, because the execute step happens in the caller.\n\nI\u0027m inclined to stick with this name over \"stage\" because in ChangeTask it\u0027s asking whether the caller eventually plans to commit the update, even though the action it takes is not committing per se.\n\nTo get back to your original question...\n\n\u003e \u003e It is possible for commitChangeWrites() to return true and failChangeWrites() to still return false,\n\u003e This is only possible if write is true. If write is true, why would there be an error?\n\nI misspoke in this comment. The surprising thing is (commitChangeWrites \u003d\u003d true \u0026\u0026 failChangeWrites \u003d\u003d true), which can only happen when (read \u003d\u003d true \u0026\u0026 write \u003d\u003d false).\n\nThis scenario implies that staging the updates will work, but committing it will fail. Staging the updates needs to work for auto-rebuilding, which is the corner case that I think leads to the most confusion. But since write \u003d\u003d false, committing the update really needs to fail, that\u0027s what this whole change is about.",
      "parentUuid": "2043bf51_0faa857f",
      "range": {
        "startLine": 82,
        "startChar": 26,
        "endLine": 84,
        "endChar": 25
      },
      "revId": "696d956d294317db6d9746ab637bc4ae87222e65",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "002a3b7a_6ed0ef08",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NotesMigration.java",
        "patchSetId": 4
      },
      "lineNbr": 84,
      "author": {
        "id": 1019407
      },
      "writtenOn": "2016-06-27T20:02:58Z",
      "side": 1,
      "message": "Your updates to the JavaDoc make all of this much clearer, so commitChangeWrites() is ok. \n\nUnless executeUpdates/executeChangeUpdates is better, but it isn\u0027t clear to me that it is.",
      "parentUuid": "002a3b7a_aeb817d6",
      "range": {
        "startLine": 82,
        "startChar": 26,
        "endLine": 84,
        "endChar": 25
      },
      "revId": "696d956d294317db6d9746ab637bc4ae87222e65",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}