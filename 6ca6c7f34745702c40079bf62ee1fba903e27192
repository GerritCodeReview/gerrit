{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "e80746a3_263fdbff",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2023-09-26T12:52:48Z",
      "side": 1,
      "message": "How do we know when to update platform version ?",
      "revId": "6ca6c7f34745702c40079bf62ee1fba903e27192",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b807c5f9_46383807",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2023-09-26T13:32:25Z",
      "side": 1,
      "message": "Bazel would tell you. I just bumped locally the Bazel version [1].\nBy putting this in `.bazelversion`:\n\n.bazelversion\n```\n7.0.0-pre.20230917.3\n```\n\nand try running the tests:\n\n\n```\n$ bazelisk test javatests/...\nERROR: /home/davido/.cache/bazel/_bazel_davido/5c01f4f713b675540b8b424c5c647f63/external/platforms/os/BUILD: no such target \u0027@platforms//os:visionos\u0027: target \u0027visionos\u0027 not declared in package \u0027os\u0027 defined by /home/davido/.cache/bazel/_bazel_davido/5c01f4f713b675540b8b424c5c647f63/external/platforms/os/BUILD (Tip: use `query \"@platforms//os:*\"` to see all the targets in that package)\nERROR: /home/davido/projects/gerrit2/javatests/com/google/gerrit/acceptance/api/change/BUILD:3:18: every rule of type java_test implicitly depends upon the target \u0027@platforms//os:visionos\u0027, but this target could not be found because of: no such target \u0027@platforms//os:visionos\u0027: target \u0027visionos\u0027 not declared in package \u0027os\u0027 defined by /home/davido/.cache/bazel/_bazel_davido/5c01f4f713b675540b8b424c5c647f63/external/platforms/os/BUILD (Tip: use `query \"@platforms//os:*\"` to see all the targets in that package)\nERROR: Analysis of target \u0027//javatests/com/google/gerrit/acceptance/api/change:DisablePrivateChangesIT\u0027 failed; build aborted: Analysis failed\nINFO: Elapsed time: 10.640s\nINFO: 0 processes.\nERROR: Build did NOT complete successfully\nERROR: Couldn\u0027t start the build. Unable to run tests\n```\n\nBumping the `platforms` version fixed the issue with the missing `visionos` platform.\n\n[1]: https://github.com/bazelbuild/bazel/releases/tag/7.0.0-pre.20230917.3",
      "parentUuid": "e80746a3_263fdbff",
      "revId": "6ca6c7f34745702c40079bf62ee1fba903e27192",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f9ba4c89_10c01717",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2023-09-26T14:38:48Z",
      "side": 1,
      "message": "thanks, interesting\n\nIt seems updating to 7.0.0-pre.20230917.3 includes some errorprone updates so we have to fix or suppress the new problems its raising before we can update to that version. Similarly for 6.3.2.",
      "parentUuid": "b807c5f9_46383807",
      "revId": "6ca6c7f34745702c40079bf62ee1fba903e27192",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ffc5b3f5_dfc7918e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2023-09-26T14:52:33Z",
      "side": 1,
      "message": "Actually, I am looking into it right now. I noticed your change in JGit project, that updated Bazel version to 6.3.2 and wanted to sync the same (latest) Bazel version in gerrit as well.\n\nI fixed one issue, see change 387496 in this series. Other breakages are related to the generated code from auto-value projects, that shouldn\u0027t be actually reported, as those are excluded in this regex in `tools/BUILD`:\n\n```\n        # The XepDisableWarningsInGeneratedCode disables only warnings, but\n        # not errors. We should manually exclude all files generated by\n        # AutoValue; such files always start AutoValue_..., $AutoValue_...,\n        # $$AutoValue_... or AutoValueGson_...\n        # XepExcludedPaths is a regexp. If you need more paths - use | as\n        # separator.\n        \"-XepExcludedPaths:.*/\\\\\\\\$$?\\\\\\\\$$?AutoValue(Gson)?_.*\\\\.java\",\n```\n\nMy impression is, that this exclusion regex above stopped working in updated Bazel version, so that this diff that demoted the severity level to those bug patterns fixed the breakages:\n\n```\ndiff --git a/tools/BUILD b/tools/BUILD\nindex c6149a530c..b2f92b2578 100644\n--- a/tools/BUILD\n+++ b/tools/BUILD\n@@ -355,7 +355,7 @@ java_package_configuration(\n         \"-Xep:RestrictedApiChecker:ERROR\",\n         \"-Xep:RethrowReflectiveOperationExceptionAsLinkageError:ERROR\",\n         \"-Xep:ReturnFromVoid:ERROR\",\n-        \"-Xep:ReturnMissingNullable:ERROR\",\n+        \"-Xep:ReturnMissingNullable:WARN\",\n         \"-Xep:ReturnValueIgnored:ERROR\",\n         \"-Xep:RxReturnValueIgnored:ERROR\",\n         \"-Xep:SameNameButDifferent:ERROR\",\n@@ -423,7 +423,7 @@ java_package_configuration(\n         \"-Xep:UseBinds:ERROR\",\n         \"-Xep:UseCorrectAssertInTests:ERROR\",\n         \"-Xep:VarTypeName:ERROR\",\n-        \"-Xep:VariableNameSameAsType:ERROR\",\n+        \"-Xep:VariableNameSameAsType:WARN\",\n         \"-Xep:WaitNotInLoop:ERROR\",\n         \"-Xep:WakelockReleasedDangerously:ERROR\",\n         \"-Xep:WildcardImport:ERROR\",\n```\n\nBut this is probably not the right approach, though.",
      "parentUuid": "f9ba4c89_10c01717",
      "revId": "6ca6c7f34745702c40079bf62ee1fba903e27192",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e8518f69_0ae2291c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2023-09-26T22:09:59Z",
      "side": 1,
      "message": "raise a bug for no longer working exclusion regex upstream ?",
      "parentUuid": "ffc5b3f5_dfc7918e",
      "revId": "6ca6c7f34745702c40079bf62ee1fba903e27192",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0abdbedf_fa8a6e37",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2023-09-27T11:43:24Z",
      "side": 1,
      "message": "Done: [1].\n\n[1]: https://github.com/bazelbuild/bazel/issues/19647",
      "parentUuid": "e8518f69_0ae2291c",
      "revId": "6ca6c7f34745702c40079bf62ee1fba903e27192",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}