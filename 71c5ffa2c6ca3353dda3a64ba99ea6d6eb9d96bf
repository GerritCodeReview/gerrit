{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "02eb11cd_a841e6d6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "Once we will have all approvals (including copied) cached/indexed, I think we won\u0027t need them in NoteDb and the backfilling won\u0027t be necessary?\nIs it because they won\u0027t persist next time we drop caches/re-index changes excluding the evaluation path?\n\nI think it would make sense to have a one-off migration in that case.",
      "range": {
        "startLine": 28,
        "startChar": 3,
        "endLine": 32,
        "endChar": 7
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e85297ab_31232203",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-09-20T09:18:08Z",
      "side": 1,
      "message": "isn\u0027t there a middle road, where we compute the final vote for submitted changes once, add on top to the metadata? That might be slightly less invasive than rewriting all of the metadata.",
      "parentUuid": "02eb11cd_a841e6d6",
      "range": {
        "startLine": 28,
        "startChar": 3,
        "endLine": 32,
        "endChar": 7
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67173113_028f0619",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "Marija:\nOld changes will not have persisted copied votes with this change, so yes, a one-off migration makes sense. However, this is extra effort and is not necessary useful.\n\nAlternatively, we don\u0027t do that, and then at some point we \"turn off\" the computation and only look at persisted copied votes (using the cache, that would load them from NoteDb only). Old changes will not have any copied votes.\n\nI think both approaches are fine and we\u0027ll decide later, but I\u0027m leaning towards no migration unless we find a pain point.\n\nHan-Wen:\nI see a few options:\n1. We can do it once on read, and persist the votes on storage. Stop doing that after X time. I don\u0027t like it cause it means we write on a read operation.\n2. Do it forever on read on submitted changes. I\u0027m not a huge fan just cause of the complexity of keeping the approval copying algorithm in Gerrit. It will be an awesome tech debt reduction to get rid of this algorithm completely. That might be the least bad option.",
      "parentUuid": "02eb11cd_a841e6d6",
      "range": {
        "startLine": 28,
        "startChar": 3,
        "endLine": 32,
        "endChar": 7
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7f135c6f_fee1cb27",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-09-20T15:37:00Z",
      "side": 1,
      "message": "I was thinking of a Flume that writes a single commit on top of all existing metadata with the copied votes (if appropriate).\n\nOnce we have finished this migration, we can drop the old code. Maybe it makes sense to do the migration in 3.5 timeframe, and drop the code for 3.6, so people can do the migration while their server is online.\n\nMaybe it\u0027s not appreciably less complex than rewriting the whole metadata, though. It does avoid the impression that the votes were copied in this way during the review (which is untrue due to rule changes, right?)",
      "parentUuid": "67173113_028f0619",
      "range": {
        "startLine": 28,
        "startChar": 3,
        "endLine": 32,
        "endChar": 7
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d8a1f642_3c5e765f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-21T15:03:52Z",
      "side": 1,
      "message": "+1 for turning it off at some point and dropping the computation on read.\nAlso, +1 to the suggestion of a single commit on top of the existing metadata.\n\u003e\u003e Old changes will not have any copied votes.\nThis is somewhat undesired, because it is user visible:\n* for submitted changes it will look like the change was submitted without votes\n* for pending changes the vote will need to be re-applied.",
      "parentUuid": "7f135c6f_fee1cb27",
      "range": {
        "startLine": 28,
        "startChar": 3,
        "endLine": 32,
        "endChar": 7
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f19d33ae_25fda8fd",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-22T07:37:15Z",
      "side": 1,
      "message": "Ah, I think I was anyway implicitly thinking we don\u0027t need to rewrite the entire commit tree, thanks for clarifying.\n\nThe disadvantage for pending changes is negligible: We will wait let\u0027s say 4~ weeks before actually turning this on, so 99% of the changes will be submitted by then (citation needed).\n\nFor submitted changes - true.",
      "parentUuid": "d8a1f642_3c5e765f",
      "range": {
        "startLine": 28,
        "startChar": 3,
        "endLine": 32,
        "endChar": 7
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b35d0e20_aceae94c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-15T18:31:35Z",
      "side": 1,
      "message": "Hey, do you want to take the first look on this change?",
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8e08e0d0_2df83860",
        "filename": "java/com/google/gerrit/entities/PatchSetApproval.java",
        "patchSetId": 1
      },
      "lineNbr": 59,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "This will be set to the timestamp of patch set upload for the copied commits, right? Do you know how it is used?\nLooks like now the sticky vote (non-copy) has the timestamp of the original vote?",
      "range": {
        "startLine": 59,
        "startChar": 28,
        "endLine": 59,
        "endChar": 55
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "be7de155_3987ee48",
        "filename": "java/com/google/gerrit/entities/PatchSetApproval.java",
        "patchSetId": 1
      },
      "lineNbr": 59,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "I\u0027ll mention in the commit message.\nI think it\u0027s no big deal, especially since it\u0027s not even user visible.",
      "parentUuid": "8e08e0d0_2df83860",
      "range": {
        "startLine": 59,
        "startChar": 28,
        "endLine": 59,
        "endChar": 55
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "072b4739_3df79b67",
        "filename": "java/com/google/gerrit/server/approval/ApprovalInference.java",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "Could this just\n\n    PatchSet patchSet \u003d notes.load().getPatchSets().get(psId);\n    if (patchSet \u003d\u003d null) {\n      return Collections.emptyList();\n    }\n    return forPatchSet(notes, patchSet, rw, repoConfig);\n\nto avoid duplication?",
      "range": {
        "startLine": 102,
        "startChar": 29,
        "endLine": 103,
        "endChar": 95
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d73022e0_80cdb2f2",
        "filename": "java/com/google/gerrit/server/approval/ApprovalInference.java",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "072b4739_3df79b67",
      "range": {
        "startLine": 102,
        "startChar": 29,
        "endLine": 103,
        "endChar": 95
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a8374c6a_5add7573",
        "filename": "java/com/google/gerrit/server/approval/ApprovalInference.java",
        "patchSetId": 1
      },
      "lineNbr": 103,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "Done, that looks better now",
      "parentUuid": "072b4739_3df79b67",
      "range": {
        "startLine": 102,
        "startChar": 29,
        "endLine": 103,
        "endChar": 95
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d50c1279_23ba2407",
        "filename": "java/com/google/gerrit/server/approval/ApprovalInference.java",
        "patchSetId": 1
      },
      "lineNbr": 381,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "could this just call getForPatchSetWithoutNormalization(notes, project, patchSet, rw, repoConfig)?\n\nOr I guess it will be unused if you apply my previous comment.\n\n(At least none of the test failed when I changes the calls).",
      "range": {
        "startLine": 381,
        "startChar": 11,
        "endLine": 381,
        "endChar": 45
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "059a9c4b_7f05a96c",
        "filename": "java/com/google/gerrit/server/approval/ApprovalInference.java",
        "patchSetId": 1
      },
      "lineNbr": 381,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "I think you meant to put this comment in the other call for getForPatchSetWithoutNormalization, but I got it :)",
      "parentUuid": "d50c1279_23ba2407",
      "range": {
        "startLine": 381,
        "startChar": 11,
        "endLine": 381,
        "endChar": 45
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "af106245_8a8810b8",
        "filename": "java/com/google/gerrit/server/change/PatchSetInserter.java",
        "patchSetId": 1
      },
      "lineNbr": 289,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "Not sure, but could you, please, double-check: should copied approvals also be persisted in\n* ChangeInserter[1]\n* SubmitStrategyOp[2]\n?\n\n[1]https://gerrit.googlesource.com/gerrit/+/refs/heads/master/java/com/google/gerrit/server/change/ChangeInserter.java#466\n[2]https://gerrit.googlesource.com/gerrit/+/refs/heads/master/java/com/google/gerrit/server/submit/SubmitStrategyOp.java#346",
      "range": {
        "startLine": 289,
        "startChar": 4,
        "endLine": 289,
        "endChar": 97
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6fa393db_db1ae4d6",
        "filename": "java/com/google/gerrit/server/change/PatchSetInserter.java",
        "patchSetId": 1
      },
      "lineNbr": 289,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "1. ChangeInserter is used only for change creation of the first patchset, so there are no votes to copy yet.\n2. I see it\u0027s already copying votes automatically (not copied ones), so there is nothing we need to do here (we can change the votes to be considered \"copied\", but I don\u0027t see a good reason to make this change).",
      "parentUuid": "af106245_8a8810b8",
      "range": {
        "startLine": 289,
        "startChar": 4,
        "endLine": 289,
        "endChar": 97
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0d6bc69b_d020fa26",
        "filename": "java/com/google/gerrit/server/notedb/ChangeNotes.java",
        "patchSetId": 1
      },
      "lineNbr": 388,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "Since this method is only used in tests for now, can you, please, add a TODO/doc describing the plan to use it in index/cache?",
      "range": {
        "startLine": 388,
        "startChar": 62,
        "endLine": 388,
        "endChar": 84
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "228dafc0_4365dd04",
        "filename": "java/com/google/gerrit/server/notedb/ChangeNotes.java",
        "patchSetId": 1
      },
      "lineNbr": 388,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0d6bc69b_d020fa26",
      "range": {
        "startLine": 388,
        "startChar": 62,
        "endLine": 388,
        "endChar": 84
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a234e28b_265dc49f",
        "filename": "java/com/google/gerrit/server/notedb/ChangeNotesParser.java",
        "patchSetId": 1
      },
      "lineNbr": 805,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "Could you add a comment it is impossible to remove copied approval and why?",
      "range": {
        "startLine": 805,
        "startChar": 4,
        "endLine": 805,
        "endChar": 66
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ffafb4d2_3f141bd2",
        "filename": "java/com/google/gerrit/server/notedb/ChangeNotesParser.java",
        "patchSetId": 1
      },
      "lineNbr": 805,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a234e28b_265dc49f",
      "range": {
        "startLine": 805,
        "startChar": 4,
        "endLine": 805,
        "endChar": 66
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "812b5a37_ae40e83a",
        "filename": "java/com/google/gerrit/server/notedb/ChangeNotesParser.java",
        "patchSetId": 1
      },
      "lineNbr": 810,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "nit: since this is quite different from parseAddAproval, maybe rename to parseCopyApproval?",
      "range": {
        "startLine": 810,
        "startChar": 35,
        "endLine": 810,
        "endChar": 51
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3bcd9c88_ff600a94",
        "filename": "java/com/google/gerrit/server/notedb/ChangeNotesParser.java",
        "patchSetId": 1
      },
      "lineNbr": 810,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "Done (I just removed the redundant method).",
      "parentUuid": "812b5a37_ae40e83a",
      "range": {
        "startLine": 810,
        "startChar": 35,
        "endLine": 810,
        "endChar": 51
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "94a4b247_58fad6af",
        "filename": "java/com/google/gerrit/server/notedb/ChangeNotesParser.java",
        "patchSetId": 1
      },
      "lineNbr": 810,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "812b5a37_ae40e83a",
      "range": {
        "startLine": 810,
        "startChar": 35,
        "endLine": 810,
        "endChar": 51
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4d0c6a8e_2dd48d83",
        "filename": "java/com/google/gerrit/server/notedb/ChangeNotesParser.java",
        "patchSetId": 1
      },
      "lineNbr": 821,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "I find it hard to read parsing logic of some of the footers.\nI think it would be helpful to have examples for the new methods.\n\nCould you add a comment with an example of a full footer value here?",
      "range": {
        "startLine": 821,
        "startChar": 8,
        "endLine": 821,
        "endChar": 59
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d99aece9_c81e3d4e",
        "filename": "java/com/google/gerrit/server/notedb/ChangeNotesParser.java",
        "patchSetId": 1
      },
      "lineNbr": 821,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4d0c6a8e_2dd48d83",
      "range": {
        "startLine": 821,
        "startChar": 8,
        "endLine": 821,
        "endChar": 59
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3633226b_932e09dd",
        "filename": "java/com/google/gerrit/server/notedb/ChangeNotesParser.java",
        "patchSetId": 1
      },
      "lineNbr": 821,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "Done, I added it above the method header.",
      "parentUuid": "4d0c6a8e_2dd48d83",
      "range": {
        "startLine": 821,
        "startChar": 8,
        "endLine": 821,
        "endChar": 59
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a867ac3b_7124331b",
        "filename": "java/com/google/gerrit/server/notedb/ChangeUpdate.java",
        "patchSetId": 1
      },
      "lineNbr": 816,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "A nit on the format/alternative suggestion: \n\nNow for regular votes we have the format:\nLabel: Label-Name\u003d-1 Gerrit User x \u003c123@server_id\u003e\n\nWe could just have\nCopy-Label: Label-Name\u003d-1 Gerrit User x \u003c123@server_id\u003e: Gerrit User x \u003c123@server_id\u003e: TAG\n\nCopy-Label: Label-Name\u003d-1 Gerrit User x \u003c123@server_id\u003e: : \nCopy-Label: Label-Name\u003d-1 Gerrit User x \u003c123@server_id\u003e: : TAG\nCopy-Label: Label-Name\u003d-1 Gerrit User x \u003c123@server_id\u003e: Gerrit User x \u003c123@server_id\u003e: \n\nThat would save us some duplication: we just reuse the parsing for \u0027regular\u0027 label part and parse the remaining information if present. This will also save from any trouble with special characters in tag (everything remaining after the second \u0027:\u0027 is tag.\n\nAlso to me it looks a bit more readable.\n\nMaybe I am missing something and there are other advantages to the storage format you went for?",
      "range": {
        "startLine": 816,
        "startChar": 14,
        "endLine": 816,
        "endChar": 36
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cd3507e0_9c04206e",
        "filename": "java/com/google/gerrit/server/notedb/ChangeUpdate.java",
        "patchSetId": 1
      },
      "lineNbr": 816,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "The code in ChangeUpdate is not going to be unique anyway because of the different inputs, and the code in the ChangeNotesParser is also going to be different because of the different number of accounts that need to parsed.\n\nAnyway one advantage for the storage I chose is: If we ever want to add anything else to the storage, we can easily add it to the end of the current footer. If we put the tag in the end without \"\", we won\u0027t be able to add anything to the end because of fear that tags contain special characters.\n\nI\u0027ll keep it as optional then if you don\u0027t mind?",
      "parentUuid": "a867ac3b_7124331b",
      "range": {
        "startLine": 816,
        "startChar": 14,
        "endLine": 816,
        "endChar": 36
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "52906af7_ca1ea223",
        "filename": "java/com/google/gerrit/server/notedb/ChangeUpdate.java",
        "patchSetId": 1
      },
      "lineNbr": 816,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-21T15:03:52Z",
      "side": 1,
      "message": "Maybe at least change the ordering, so that the optional info is at the end? If we quote \u003cTAG\u003e, we don\u0027t actually need :tag:.\nAnother argument to use \u0027: \u0027 as a separator is to follow the similar logic as other change footers (e.g. SUBMITTED_WITH).\nI will keep my suggestion:\nCopied-Label:\u003cLABEL\u003e\u003dVOTE \u003cGerrit Account\u003e: \u003cGerrit Real Account\u003e: \"\u003cTAG\u003e\"\n but we can await other review\u0027s opinion",
      "parentUuid": "cd3507e0_9c04206e",
      "range": {
        "startLine": 816,
        "startChar": 14,
        "endLine": 816,
        "endChar": 36
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bc58ac80_32870fa3",
        "filename": "java/com/google/gerrit/server/notedb/ChangeUpdate.java",
        "patchSetId": 1
      },
      "lineNbr": 816,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-22T07:37:15Z",
      "side": 1,
      "message": "sure - I did that.",
      "parentUuid": "52906af7_ca1ea223",
      "range": {
        "startLine": 816,
        "startChar": 14,
        "endLine": 816,
        "endChar": 36
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "22fa0db6_162c1215",
        "filename": "java/com/google/gerrit/server/notedb/ChangeUpdate.java",
        "patchSetId": 1
      },
      "lineNbr": 826,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "Could you add a comment why the tag and realAuthor are only persisted for copied votes, but not for the regular ones?\n\nI guess for regular approval it is parsed from the commit where it was persisted, and for the copy it is not possible?",
      "range": {
        "startLine": 826,
        "startChar": 46,
        "endLine": 826,
        "endChar": 51
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8b685841_be3fbd53",
        "filename": "java/com/google/gerrit/server/notedb/ChangeUpdate.java",
        "patchSetId": 1
      },
      "lineNbr": 826,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "yep.",
      "parentUuid": "22fa0db6_162c1215",
      "range": {
        "startLine": 826,
        "startChar": 46,
        "endLine": 826,
        "endChar": 51
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3de925e5_5a006e69",
        "filename": "javatests/com/google/gerrit/acceptance/api/change/StickyApprovalsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 957,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "Unless it is covered by other IT, can you, please, add a test for deleting the sticky vote via API?",
      "range": {
        "startLine": 957,
        "startChar": 14,
        "endLine": 957,
        "endChar": 38
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cc53d8fb_6e644780",
        "filename": "javatests/com/google/gerrit/acceptance/api/change/StickyApprovalsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 957,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3de925e5_5a006e69",
      "range": {
        "startLine": 957,
        "startChar": 14,
        "endLine": 957,
        "endChar": 38
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "737e8a36_f2bf12c4",
        "filename": "javatests/com/google/gerrit/acceptance/api/change/StickyApprovalsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 1027,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "nit: Here and other tests:\ncan you, please, extract it to \nPatchSetApproval nonCopied \u003d patchSetApprovals.get(0)\nPatchSetApproval copied \u003d patchSetApprovals.get(1)",
      "range": {
        "startLine": 1027,
        "startChar": 15,
        "endLine": 1027,
        "endChar": 39
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "941a6784_12f66630",
        "filename": "javatests/com/google/gerrit/acceptance/api/change/StickyApprovalsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 1027,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "737e8a36_f2bf12c4",
      "range": {
        "startLine": 1027,
        "startChar": 15,
        "endLine": 1027,
        "endChar": 39
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c9782077_4147f2f6",
        "filename": "javatests/com/google/gerrit/acceptance/api/change/StickyApprovalsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 1027,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "737e8a36_f2bf12c4",
      "range": {
        "startLine": 1027,
        "startChar": 15,
        "endLine": 1027,
        "endChar": 39
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7e86a8c8_17e30ea2",
        "filename": "javatests/com/google/gerrit/server/notedb/ChangeNotesTest.java",
        "patchSetId": 1
      },
      "lineNbr": 567,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-20T07:58:39Z",
      "side": 1,
      "message": "Can you, please, add a test that notes.getApprovals() does not contain a removed approval?",
      "range": {
        "startLine": 567,
        "startChar": 14,
        "endLine": 567,
        "endChar": 41
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fe077086_1d640bbf",
        "filename": "javatests/com/google/gerrit/server/notedb/ChangeNotesTest.java",
        "patchSetId": 1
      },
      "lineNbr": 567,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-20T12:22:37Z",
      "side": 1,
      "message": "I can\u0027t, because it will always contain it. The way we mark removal is by setting the latest patch-set with \"0\" vote.\nAdded a comment.",
      "parentUuid": "7e86a8c8_17e30ea2",
      "range": {
        "startLine": 567,
        "startChar": 14,
        "endLine": 567,
        "endChar": 41
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ec00b941_2c05ebf1",
        "filename": "javatests/com/google/gerrit/server/notedb/ChangeNotesTest.java",
        "patchSetId": 1
      },
      "lineNbr": 567,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2021-09-21T15:03:52Z",
      "side": 1,
      "message": "Optional: contains approval with \u00270\u0027 value?",
      "parentUuid": "fe077086_1d640bbf",
      "range": {
        "startLine": 567,
        "startChar": 14,
        "endLine": 567,
        "endChar": 41
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "84551dd3_16323baa",
        "filename": "javatests/com/google/gerrit/server/notedb/ChangeNotesTest.java",
        "patchSetId": 1
      },
      "lineNbr": 567,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2021-09-22T07:37:15Z",
      "side": 1,
      "message": "The copied approval will never have a 0 value, actually, it will be \"overridden\" by a 0 vote of a non copied approval (that has the same key). I clarified the comment.",
      "parentUuid": "ec00b941_2c05ebf1",
      "range": {
        "startLine": 567,
        "startChar": 14,
        "endLine": 567,
        "endChar": 41
      },
      "revId": "71c5ffa2c6ca3353dda3a64ba99ea6d6eb9d96bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}