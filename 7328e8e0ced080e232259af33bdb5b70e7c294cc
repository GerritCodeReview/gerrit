{
  "comments": [
    {
      "key": {
        "uuid": "961c67fc_9acd0d9e",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/ChangeUpdate.java",
        "patchSetId": 4
      },
      "lineNbr": 446,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-13T06:02:05Z",
      "side": 1,
      "message": "Is this marker really necessary? If you can check, that it state is wrong (i. e. it was flagged, but parent collection is not empty) on the next line, couldn\u0027t you use this fact to add immutable footer and avoid create flag in the first place? E.g.:\n\n  if (commit.getParentIds().length \u003d\u003d 0) {\n    addImmutableFooters(msg);\n  }\n\nIn fact when i do that change above, and run ChangesNotesTest then all tests are successful, except one:\n\n  createInNonRootCommitFails()\n\nit doesn\u0027t fail now.",
      "range": {
        "startLine": 446,
        "startChar": 8,
        "endLine": 446,
        "endChar": 14
      },
      "revId": "7328e8e0ced080e232259af33bdb5b70e7c294cc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d6509fa6_3cfcf17f",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/ChangeUpdate.java",
        "patchSetId": 4
      },
      "lineNbr": 446,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2014-08-13T16:02:43Z",
      "side": 1,
      "message": "Not strictly necessary for change key and branch (except insofar as it means with a linear history we don\u0027t have to check for duplicates in multiple commits). Becomes necessary for owner and createdOn.\n\nAdded something to the commit message, and to the relevant part in when I added owner/createdOn support.",
      "parentUuid": "961c67fc_9acd0d9e",
      "range": {
        "startLine": 446,
        "startChar": 8,
        "endLine": 446,
        "endChar": 14
      },
      "revId": "7328e8e0ced080e232259af33bdb5b70e7c294cc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d6509fa6_dca62daf",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/ChangeUpdate.java",
        "patchSetId": 4
      },
      "lineNbr": 446,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-13T16:49:37Z",
      "side": 1,
      "message": "So the answer to my question \"Why do you need this flag in this commit?\" is \"I don\u0027t need this flag in this commit.\" In which case i expect this flag to be removed in this commit and introduced later when it is needed.\n\nSome of your tests are broken now. Because now you are missing update.create() in some locations. For example in this test:\n\n  ChangeNotesTest.approvalsOnePatchSet()\n\nBecause the call to update.create() is missing there, changeKey is erroneously not initialized in this change.",
      "parentUuid": "d6509fa6_3cfcf17f",
      "range": {
        "startLine": 446,
        "startChar": 8,
        "endLine": 446,
        "endChar": 14
      },
      "revId": "7328e8e0ced080e232259af33bdb5b70e7c294cc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "961c67fc_5abbf5c4",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/ChangeUpdate.java",
        "patchSetId": 4
      },
      "lineNbr": 446,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2014-08-13T16:57:45Z",
      "side": 1,
      "message": "\u003e In which case i expect this flag to be removed in this commit and introduced later when it is needed.\n\nIt is not worth my time to implement different behavior now, test that behavior, then change the behavior two commits down the line.\n\n\u003e Some of your tests are broken now.\n\nThose tests are not broken; they pass fine. They are essentially testing the \"notedb.write \u003d true before RebuildNoteDb\" case, which was and continues to be valid. We can change/duplicate them to test other cases, but that is beyond the scope of this change.",
      "parentUuid": "d6509fa6_dca62daf",
      "range": {
        "startLine": 446,
        "startChar": 8,
        "endLine": 446,
        "endChar": 14
      },
      "revId": "7328e8e0ced080e232259af33bdb5b70e7c294cc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "961c67fc_1a8a5d09",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/ChangeUpdate.java",
        "patchSetId": 4
      },
      "lineNbr": 446,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-13T22:43:23Z",
      "side": 1,
      "message": "OK, i missed the fact that in the transition period we can have notedb.write \u003d true but RebuildNoteDb wasn\u0027t run. I hink that when we are done with convertion we can define that every root commit identifies change creation and we can drop this create flag. Now I wonder if ChangeRebuilder should be extended in this change and set create flag as well to trigger filling of immutable fields in footer?",
      "parentUuid": "961c67fc_5abbf5c4",
      "range": {
        "startLine": 446,
        "startChar": 8,
        "endLine": 446,
        "endChar": 14
      },
      "revId": "7328e8e0ced080e232259af33bdb5b70e7c294cc",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}