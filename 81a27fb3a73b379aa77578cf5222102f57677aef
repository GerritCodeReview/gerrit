{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "05e6e978_68f33601",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1148215
      },
      "writtenOn": "2023-04-14T09:12:44Z",
      "side": 1,
      "message": "I am not sure I understand how does the matching between unsaved comment and saved comment happens.\n\nIs it possible that there is a comment with client_id that was saving -\u003e we then requests comments from REST_API which will return the saved comment -\u003e we don\u0027t know that it\u0027s the same comment -\u003e We render it twice? \n\nCould you explain how do we avoid this problem?",
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4316843d_88cd5756",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2023-04-14T09:58:54Z",
      "side": 1,
      "message": "After a draft was saved we keep the client_id and also keep using it for identifying the comment.\n\nDrafts are not loaded continuously or partially. They are just loaded once along with the change. At that point the entire model is replaced.\n\nI have added a longer comment to `id()` in comment-util.ts.",
      "parentUuid": "05e6e978_68f33601",
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e00e733c_958d4009",
        "filename": "polygerrit-ui/app/elements/change/gr-reply-dialog/gr-reply-dialog.ts",
        "patchSetId": 4
      },
      "lineNbr": 711,
      "author": {
        "id": 1148215
      },
      "writtenOn": "2023-04-14T09:12:44Z",
      "side": 1,
      "message": "I don\u0027t really understand what\u0027s happening here, Could you explain (and/or add a comment with the explanation)\n\nIt seems that we wait until the dialog is rendered, to create a draft in the model, causing the subscriber to trigger causing one more update to the element. Is this correct?\n\nIf so, can we avoid the double update cycle? Why do we have to do this here and not earlier?",
      "range": {
        "startLine": 703,
        "startChar": 3,
        "endLine": 711,
        "endChar": 5
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "12030db4_bb82ca49",
        "filename": "polygerrit-ui/app/elements/change/gr-reply-dialog/gr-reply-dialog.ts",
        "patchSetId": 4
      },
      "lineNbr": 711,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2023-04-14T09:58:54Z",
      "side": 1,
      "message": "Added a TODO. You are correct, this should rather be moved to the comments model.\n\nMoving it from render() to updated() was already an improvement IMO. :-)",
      "parentUuid": "e00e733c_958d4009",
      "range": {
        "startLine": 703,
        "startChar": 3,
        "endLine": 711,
        "endChar": 5
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "046f5167_4c37bff3",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment-thread/gr-comment-thread.ts",
        "patchSetId": 4
      },
      "lineNbr": 479,
      "author": {
        "id": 1148215
      },
      "writtenOn": "2023-04-14T09:12:44Z",
      "side": 1,
      "message": "This comment is not clear to me:\n\n- What exactly needs to be changed and what would be the benefit\n- The next line doesn\u0027t have id() or .id",
      "range": {
        "startLine": 478,
        "startChar": 4,
        "endLine": 479,
        "endChar": 49
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f9dd316a_884c1ec8",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment-thread/gr-comment-thread.ts",
        "patchSetId": 4
      },
      "lineNbr": 479,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2023-04-14T09:58:54Z",
      "side": 1,
      "message": "We were splitting the rendering into two parts: repeat() for all published comments and then render draft separately. That is not needed anymore really. We can as well just render everything in one repeat().\n\nThe `.id` refers to the repeat() directive above.\n\nChanged the comment.",
      "parentUuid": "046f5167_4c37bff3",
      "range": {
        "startLine": 478,
        "startChar": 4,
        "endLine": 479,
        "endChar": 49
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "111dae5e_13f7b004",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment-thread/gr-comment-thread_test.ts",
        "patchSetId": 4
      },
      "lineNbr": 137,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2023-04-14T09:17:11Z",
      "side": 1,
      "message": "Is it ok that unsaved creates link? Will this link work after it really saves?",
      "range": {
        "startLine": 137,
        "startChar": 19,
        "endLine": 137,
        "endChar": 68
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b175a1b2_aec50bd2",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment-thread/gr-comment-thread_test.ts",
        "patchSetId": 4
      },
      "lineNbr": 137,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2023-04-14T09:58:54Z",
      "side": 1,
      "message": "Yes, this is the link to the file, not the comment. It is only used in the \"Comments\" tab.",
      "parentUuid": "111dae5e_13f7b004",
      "range": {
        "startLine": 137,
        "startChar": 19,
        "endLine": 137,
        "endChar": 68
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6ac98ca4_8ce06574",
        "filename": "polygerrit-ui/app/models/comments/comments-model.ts",
        "patchSetId": 4
      },
      "lineNbr": 642,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2023-04-14T09:17:11Z",
      "side": 1,
      "message": "Does this work in race condition?\n\nWhen user clicks discard on unsaved draft that was saved on server but response didn\u0027t arrive yet. Will we call deleteDiffDraft once we save this draft since it was discard during saving?",
      "range": {
        "startLine": 642,
        "startChar": 4,
        "endLine": 642,
        "endChar": 49
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "810c8cd7_0fdfdb3e",
        "filename": "polygerrit-ui/app/models/comments/comments-model.ts",
        "patchSetId": 4
      },
      "lineNbr": 642,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2023-04-14T09:58:54Z",
      "side": 1,
      "message": "Good point. Let me add a !SAVING check to change 369394.",
      "parentUuid": "6ac98ca4_8ce06574",
      "range": {
        "startLine": 642,
        "startChar": 4,
        "endLine": 642,
        "endChar": 49
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fc315faa_d3146b7d",
        "filename": "polygerrit-ui/app/services/gr-rest-api/gr-rest-api-impl.ts",
        "patchSetId": 4
      },
      "lineNbr": 2591,
      "author": {
        "id": 1148215
      },
      "writtenOn": "2023-04-14T09:12:44Z",
      "side": 1,
      "message": "If this is an async method. Can\u0027t this be simply \"return {}\"?",
      "range": {
        "startLine": 2591,
        "startChar": 26,
        "endLine": 2591,
        "endChar": 45
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "69926d60_d24376e1",
        "filename": "polygerrit-ui/app/services/gr-rest-api/gr-rest-api-impl.ts",
        "patchSetId": 4
      },
      "lineNbr": 2591,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2023-04-14T09:58:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fc315faa_d3146b7d",
      "range": {
        "startLine": 2591,
        "startChar": 26,
        "endLine": 2591,
        "endChar": 45
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a4d2a04d_409eda32",
        "filename": "polygerrit-ui/app/services/gr-rest-api/gr-rest-api-impl.ts",
        "patchSetId": 4
      },
      "lineNbr": 2597,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2023-04-14T09:17:11Z",
      "side": 1,
      "message": "Nit:\n```suggestion\n    })) as {[path: string]: DraftInfo[]} | undefined;\n```",
      "range": {
        "startLine": 2597,
        "startChar": 11,
        "endLine": 2597,
        "endChar": 32
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4010d22b_52320726",
        "filename": "polygerrit-ui/app/services/gr-rest-api/gr-rest-api-impl.ts",
        "patchSetId": 4
      },
      "lineNbr": 2597,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2023-04-14T09:58:54Z",
      "side": 1,
      "message": "You like it? Replaced `PathToCommentsInfoMap` everywhere! :-)",
      "parentUuid": "a4d2a04d_409eda32",
      "range": {
        "startLine": 2597,
        "startChar": 11,
        "endLine": 2597,
        "endChar": 32
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7efa3e67_7d81bccc",
        "filename": "polygerrit-ui/app/types/common.ts",
        "patchSetId": 4
      },
      "lineNbr": 721,
      "author": {
        "id": 1148215
      },
      "writtenOn": "2023-04-14T09:12:44Z",
      "side": 1,
      "message": "I am not sure I understand the intended flow here.\n\n1) If the comment is created it\u0027s UNSAVED and when it\u0027s starts saving transitions to SAVING\n2) If the comment is SAVED, wouldn\u0027t it go to UNSAVED, before it goes to SAVING?\n\nWhy do we make the distinction between SAVED and UNSAVED, but don\u0027t make the distinction between UNSAVED_SAVING and SAVED_SAVING?",
      "range": {
        "startLine": 720,
        "startChar": 2,
        "endLine": 721,
        "endChar": 18
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fd44d668_11be74d3",
        "filename": "polygerrit-ui/app/types/common.ts",
        "patchSetId": 4
      },
      "lineNbr": 721,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2023-04-14T09:58:54Z",
      "side": 1,
      "message": "UNSAVED and SAVED are similar. UNSAVED just does not have an `id` (set by the backend). So it is not know at all to the backend and would be gone, if your browser crashed or your network connection was cut off.\n\nI don\u0027t see a benefit by distinguishing UNSAVED_SAVING and SAVED_SAVING. But we could make that distinction.\n\nMaybe we should renamed UNSAVED to NEW. Would that make it clearer?",
      "parentUuid": "7efa3e67_7d81bccc",
      "range": {
        "startLine": 720,
        "startChar": 2,
        "endLine": 721,
        "endChar": 18
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f9fcb940_6c3d4888",
        "filename": "polygerrit-ui/app/types/common.ts",
        "patchSetId": 4
      },
      "lineNbr": 721,
      "author": {
        "id": 1148215
      },
      "writtenOn": "2023-04-14T12:03:13Z",
      "side": 1,
      "message": "Yes, I think NEW would be clearer.\n\nWhat\u0027s the case when draft is UNSAVED? Why wouldn\u0027t a new draft immediately go into SAVING state? Is it the case of \"was created, but the autosave timer didn\u0027t reach it yet? If so, then it would be the same for SAVED, in which case I find both names confusing (since SAVED indicates to me, that the state of the model corresponds to state of the server). \n\nIt seems to me that UNSAVED/SAVED describe a different dimension (having a backend representation) vs. SAVING/\u003cOK\u003e/ERROR (Status of the write, Is there request in flight, was the latest update successful). So I would split them correspondingly into two.",
      "parentUuid": "fd44d668_11be74d3",
      "range": {
        "startLine": 720,
        "startChar": 2,
        "endLine": 721,
        "endChar": 18
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f6b80d37_64c4b363",
        "filename": "polygerrit-ui/app/types/common.ts",
        "patchSetId": 4
      },
      "lineNbr": 728,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2023-04-14T09:17:11Z",
      "side": 1,
      "message": "Cool, thanks - this is useful!",
      "range": {
        "startLine": 701,
        "startChar": 2,
        "endLine": 728,
        "endChar": 21
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e34f5bf3_79496b4d",
        "filename": "polygerrit-ui/app/types/common.ts",
        "patchSetId": 4
      },
      "lineNbr": 784,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2023-04-14T09:17:11Z",
      "side": 1,
      "message": "I assume this can be removed in future, it\u0027s little bit confusing semantically that draft is not draft because it\u0027s not saved.",
      "range": {
        "startLine": 774,
        "startChar": 0,
        "endLine": 784,
        "endChar": 1
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "db5b6e29_f4a96ec5",
        "filename": "polygerrit-ui/app/types/common.ts",
        "patchSetId": 4
      },
      "lineNbr": 784,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2023-04-14T09:58:54Z",
      "side": 1,
      "message": "Yeah, added a TODO. `isDraftOrUnsaved` should eventually become just `isDraft()`.",
      "parentUuid": "e34f5bf3_79496b4d",
      "range": {
        "startLine": 774,
        "startChar": 0,
        "endLine": 784,
        "endChar": 1
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d7230dbb_8b030795",
        "filename": "polygerrit-ui/app/utils/common-util.ts",
        "patchSetId": 4
      },
      "lineNbr": 180,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2023-04-14T09:17:11Z",
      "side": 1,
      "message": "This can be used in gr-change-actions and gr-confirm-cherrypick",
      "range": {
        "startLine": 180,
        "startChar": 9,
        "endLine": 180,
        "endChar": 49
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "18505c1d_349b8967",
        "filename": "polygerrit-ui/app/utils/common-util.ts",
        "patchSetId": 4
      },
      "lineNbr": 180,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2023-04-14T09:58:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d7230dbb_8b030795",
      "range": {
        "startLine": 180,
        "startChar": 9,
        "endLine": 180,
        "endChar": 49
      },
      "revId": "81a27fb3a73b379aa77578cf5222102f57677aef",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}