{
  "comments": [
    {
      "key": {
        "uuid": "d6e25f1a_4c0c9f5c",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/change/ChangeScreen2.java",
        "patchSetId": 21
      },
      "lineNbr": 213,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-11T21:57:36Z",
      "side": 1,
      "message": "Since the endpoint was changed to return EditInfo direclty when it exists and throw 404 when it doesn\u0027t, this code fails to recover. All optional stuff in REST API works that way: Map when optional, e. g. ListDrafts.",
      "range": {
        "startLine": 209,
        "startChar": 12,
        "endLine": 213,
        "endChar": 14
      },
      "revId": "836a2bbe81a00d24674782430875f58e941fd188",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "960e27b4_0a1b1b8f",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/change/ChangeScreen2.java",
        "patchSetId": 21
      },
      "lineNbr": 213,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2014-08-11T22:06:19Z",
      "side": 1,
      "message": "If this is widespread in the REST API I guess I can live with that. But ListDrafts is different: it\u0027s a map with 0 or more elements.\n\nCan you point me to some examples where we use a 0-or-1 element map is used for a single optional value? It seems like we have plenty of non-list \"GET\" endpoints, e.g. GetChange.\n\nI would be surprised to find that there is no way to handle a 404 in the callback code, but I\u0027m not deeply familiar with how these Throwables are constructed.",
      "parentUuid": "d6e25f1a_4c0c9f5c",
      "range": {
        "startLine": 209,
        "startChar": 12,
        "endLine": 213,
        "endChar": 14
      },
      "revId": "836a2bbe81a00d24674782430875f58e941fd188",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "36f49bd0_8f2ef5a9",
        "filename": "gerrit-gwtui/src/main/java/com/google/gerrit/client/change/ChangeScreen2.java",
        "patchSetId": 21
      },
      "lineNbr": 213,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-11T22:12:58Z",
      "side": 1,
      "message": "I think i\u0027ve found a possible solution: return none 204 instead of 404. Still have to validate that it also works with change edit. For taht i need to rebase the whole series.\n\nThe problem seems to be in CannbackGroup code:\n\n  @Override\n    public void onFailure(Throwable caught) {\n      if (failed) {\n        return;\n      }\n\n      failed \u003d true;\n      failedThrowable \u003d caught;\n      for (CallbackImpl\u003c?\u003e cb : callbacks) {\n        cb.delegate.onFailure(failedThrowable);\n        cb.delegate \u003d null;\n        cb.result \u003d null;\n      }\n      callbacks.clear();\n      remaining.clear();\n    }\n\nThe callback group, particularly the line:\n\n  cb.delegate.onFailure(failedThrowable);\n\nis get called, that hits isNoSuchEntity(caught) case and calls ErrorDialog:\n\n  public abstract class GerritCallback\u003cT\u003e implements\n    com.google.gwtjsonrpc.common.AsyncCallback\u003cT\u003e,\n    com.google.gwt.user.client.rpc.AsyncCallback\u003cT\u003e {\n  public void onFailure(final Throwable caught) {\n    if (isNotSignedIn(caught) || isInvalidXSRF(caught)) {\n      new NotSignedInDialog().center();\n\n    } else if (isNoSuchEntity(caught)) {\n      if (Gerrit.isSignedIn()) {\n        new ErrorDialog(Gerrit.C.notFoundBody()).center();",
      "parentUuid": "960e27b4_0a1b1b8f",
      "range": {
        "startLine": 209,
        "startChar": 12,
        "endLine": 213,
        "endChar": 14
      },
      "revId": "836a2bbe81a00d24674782430875f58e941fd188",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}