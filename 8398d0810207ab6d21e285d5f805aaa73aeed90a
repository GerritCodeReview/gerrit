{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "a6f57e6f_4c0d3332",
        "filename": "Documentation/rest-api-changes.txt",
        "patchSetId": 16
      },
      "lineNbr": 8727,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T10:40:06Z",
      "side": 1,
      "message": "nit: this only applies to queries, right? If RevisionInfo is returned from e.g. change/detail in change info, this will be always set?",
      "range": {
        "startLine": 8727,
        "startChar": 1,
        "endLine": 8727,
        "endChar": 40
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2c74e974_ca9097f7",
        "filename": "Documentation/rest-api-changes.txt",
        "patchSetId": 16
      },
      "lineNbr": 8727,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-28T11:31:54Z",
      "side": 1,
      "message": "No, this applies to both change/detail and change queries a-like (similar to how all other change query options work). If the option is supplied, the revisions map will have the parents_data field set.",
      "parentUuid": "a6f57e6f_4c0d3332",
      "range": {
        "startLine": 8727,
        "startChar": 1,
        "endLine": 8727,
        "endChar": 40
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "42a4879c_9cd977f9",
        "filename": "java/com/google/gerrit/entities/ParentCommitData.java",
        "patchSetId": 16
      },
      "lineNbr": 82,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T10:40:06Z",
      "side": 1,
      "message": "since branchName is optional, why do we need this boolean?\n\nIsn\u0027t it equivalent to branchName.isPresent()?",
      "range": {
        "startLine": 82,
        "startChar": 27,
        "endLine": 82,
        "endChar": 51
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "48c96c90_c1ae9222",
        "filename": "java/com/google/gerrit/entities/ParentCommitData.java",
        "patchSetId": 16
      },
      "lineNbr": 82,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-28T11:31:54Z",
      "side": 1,
      "message": "No. branch name is the name of the target branch that the current change is intended to be merged into. e.g. if you do a push for review to refs/for/master, then master is the destination branch.\n\nAdditionally, since branch can be moved between patchsets (see the Move Change REST endpoint), target branches can be different for different patch-sets.\n\nThe boolean \u0027isMergedInTargetBranch\u0027 has a different meaning: it\u0027s true if the parent commit is reachable from the tip of the target branch. So if you checkout master and uploaded a change on top of it, this boolean will be true (because the parent is a merged commit in the target branch), but if you uploaded a stack of two changes, the top-most change will have this boolean as false, since its parent is pending (i.e. not yet merged).",
      "parentUuid": "42a4879c_9cd977f9",
      "range": {
        "startLine": 82,
        "startChar": 27,
        "endLine": 82,
        "endChar": 51
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "36a66352_20ed6704",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 58,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T10:40:06Z",
      "side": 1,
      "message": "nit: why not returning a builder from getFromGerritChange (since we do not set isMergedInTargetBranch correctly there?",
      "range": {
        "startLine": 58,
        "startChar": 8,
        "endLine": 58,
        "endChar": 27
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2564f05a_0e555837",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 58,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-28T11:31:54Z",
      "side": 1,
      "message": "This is because \u0027getFromGerritChange\u0027 can also return empty (if the parent commit does not correspond to a PS of any other change).\n\nI\u0027ll prefer keeping as is.",
      "parentUuid": "36a66352_20ed6704",
      "range": {
        "startLine": 58,
        "startChar": 8,
        "endLine": 58,
        "endChar": 27
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3d06a472_a3f43ec0",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 58,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T11:42:00Z",
      "side": 1,
      "message": "I can return an empty builder. I think it is suspicious to set sMergedInTargetBranch to a wrong value in the method (e.g. than in is possible that we forget to override it).",
      "parentUuid": "2564f05a_0e555837",
      "range": {
        "startLine": 58,
        "startChar": 8,
        "endLine": 58,
        "endChar": 27
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "49daf6a8_3023b97c",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 58,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-29T08:42:56Z",
      "side": 1,
      "message": "I removed isMergedInTargetBranch from the method to avoid setting to the wrong value.",
      "parentUuid": "3d06a472_a3f43ec0",
      "range": {
        "startLine": 58,
        "startChar": 8,
        "endLine": 58,
        "endChar": 27
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "235c1f17_63a2f75f",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 60,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T10:40:06Z",
      "side": 1,
      "message": "Is the case when !inTargetBrach \u0026\u0026 fromGerritChange.isEmpty() valid?\n\nWhat should we return then?",
      "range": {
        "startLine": 60,
        "startChar": 6,
        "endLine": 60,
        "endChar": 30
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bc1260fd_8ef7c87d",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 60,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-28T11:31:54Z",
      "side": 1,
      "message": "Yes, this case is valid. In this case we return an empty Optional, and it\u0027s handled in RevisionJson:348\n\n`p.ifPresent(parentData::add);`\n\nSo in this case we don\u0027t return a parents_data entity on the API.\n\nEdit: after your other comment in L62, we will return a ParentCommitData with the parent ID and the `isMergedInTargetBranch` boolean will be false. So we never return empty. I reworked the code.",
      "parentUuid": "235c1f17_63a2f75f",
      "range": {
        "startLine": 60,
        "startChar": 6,
        "endLine": 60,
        "endChar": 30
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7d10f74e_54129750",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 62,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T10:40:06Z",
      "side": 1,
      "message": "why not:\n\nif(fromGerritChange.isEmpty()){\n  return ParentCommitData.builder()\n                .branchName(Optional.of(targetBranch))\n                .commitId(Optional.of(commitId))\n                .isMergedInTargetBranch(inTargetBranch)\n                .autoBuild());\n}\nreturn fromGerritChange.map( f -\u003e f.isMergedInTargetBranch(inTargetBranch).autoBuild());\n\nI think this is easier to distinguish the two cases (change/no change) in this case.",
      "range": {
        "startLine": 59,
        "startChar": 3,
        "endLine": 62,
        "endChar": 37
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8d03fdcf_a59e3166",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 62,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-28T11:31:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7d10f74e_54129750",
      "range": {
        "startLine": 59,
        "startChar": 3,
        "endLine": 62,
        "endChar": 37
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8364af5c_49215a71",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 77,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T10:40:06Z",
      "side": 1,
      "message": "nit:parentCommitId",
      "range": {
        "startLine": 77,
        "startChar": 57,
        "endLine": 77,
        "endChar": 65
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0f4bfd97_0acc89e3",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 77,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-28T11:31:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8364af5c_49215a71",
      "range": {
        "startLine": 77,
        "startChar": 57,
        "endLine": 77,
        "endChar": 65
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d39de62a_4aa4fe97",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 100,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T10:40:06Z",
      "side": 1,
      "message": "nit: from the comment, it may seem that the method verifies if it is a parent commit or now.\n\nMaybe: Returns {@link ParentCommitData} if there is a change associated with {@code parentCommitId)",
      "range": {
        "startLine": 100,
        "startChar": 45,
        "endLine": 100,
        "endChar": 58
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f8bb052c_b4e37781",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 100,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-28T11:31:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d39de62a_4aa4fe97",
      "range": {
        "startLine": 100,
        "startChar": 45,
        "endLine": 100,
        "endChar": 58
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5d3c4828_47e3e2f1",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 104,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T10:40:06Z",
      "side": 1,
      "message": "nit: could we give this variable a more descriptive name? parentCommitId?",
      "range": {
        "startLine": 104,
        "startChar": 40,
        "endLine": 104,
        "endChar": 49
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "15ff1567_38855b2e",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 104,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-28T11:31:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5d3c4828_47e3e2f1",
      "range": {
        "startLine": 104,
        "startChar": 40,
        "endLine": 104,
        "endChar": 49
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "82173e95_084b5181",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 108,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T10:40:06Z",
      "side": 1,
      "message": "nit: could we add list of change ids in the log?",
      "range": {
        "startLine": 108,
        "startChar": 11,
        "endLine": 108,
        "endChar": 88
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5c14862d_cc3cc126",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 108,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-28T11:31:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "82173e95_084b5181",
      "range": {
        "startLine": 108,
        "startChar": 11,
        "endLine": 108,
        "endChar": 88
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7eaaa963_c945c158",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 120,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T10:40:06Z",
      "side": 1,
      "message": "this looks suspicious: don\u0027t we have targetBranch in changeData?\n\nIs it possible that there is a mismatch?",
      "range": {
        "startLine": 120,
        "startChar": 36,
        "endLine": 120,
        "endChar": 49
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d6616ceb_7425993b",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 120,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-28T11:31:54Z",
      "side": 1,
      "message": "targetBranch is now part of patch-set data (see predecessor change), since changes can be moved between patch-sets.\n\nThis field contains the target patch-set that **current** commit is intended to be merged into, then we provide information whether the parent is reachable from this branch.",
      "parentUuid": "7eaaa963_c945c158",
      "range": {
        "startLine": 120,
        "startChar": 36,
        "endLine": 120,
        "endChar": 49
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7e9fb58c_b25fa2fc",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 120,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T11:42:00Z",
      "side": 1,
      "message": "Why do we need to provide information about the current commit in ParrentInfo?\nThis can be always inferred from RevisionInfo? I think it would be cleaner to keep the field empty if the commit does not belong to the branch.",
      "parentUuid": "d6616ceb_7425993b",
      "range": {
        "startLine": 120,
        "startChar": 36,
        "endLine": 120,
        "endChar": 49
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cf4ad5bd_29665e69",
        "filename": "java/com/google/gerrit/server/change/ParentDataProvider.java",
        "patchSetId": 16
      },
      "lineNbr": 120,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-29T08:42:56Z",
      "side": 1,
      "message": "\u003e  I think it would be cleaner to keep the field empty if the commit does not belong to the branch.\n\nBut the targetBranch field is still saying \"which\" branch the parent commit is/isn\u0027t reachable from.\n\n\u003e Why do we need to provide information about the current commit in ParrentInfo?\n\nYou\u0027re right. I just realised this is the same branch field in RevisionInfo (patch-set), so your main point here I guess is to remove this field altogether. I have no strong argument, but I can keep as is for now as to provide clearer means for user to understand the target branch name on which we computed if parent is included.",
      "parentUuid": "7e9fb58c_b25fa2fc",
      "range": {
        "startLine": 120,
        "startChar": 36,
        "endLine": 120,
        "endChar": 49
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1bbf0bd1_99aa5e4c",
        "filename": "java/com/google/gerrit/server/change/RevisionJson.java",
        "patchSetId": 16
      },
      "lineNbr": 345,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T10:40:06Z",
      "side": 1,
      "message": "Looking at GetDetail implementation, I think we will not return the new info from change/detail endpoint.\n\nIs that expected? Which endpoints should return the new info?\n\nhttp://go/grev/Documentation/rest-api-changes.html#get-change-detail",
      "range": {
        "startLine": 343,
        "startChar": 18,
        "endLine": 345,
        "endChar": 46
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b2bd113d_d5ed275d",
        "filename": "java/com/google/gerrit/server/change/RevisionJson.java",
        "patchSetId": 16
      },
      "lineNbr": 345,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-28T11:31:54Z",
      "side": 1,
      "message": "We will (please see tests). the \u0027Get Change Detail\u0027 has a \u0027revisions\u0027 field of type RevisionInfo, which contains the new data.",
      "parentUuid": "1bbf0bd1_99aa5e4c",
      "range": {
        "startLine": 343,
        "startChar": 18,
        "endLine": 345,
        "endChar": 46
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5301737f_38dd7c64",
        "filename": "java/com/google/gerrit/server/change/RevisionJson.java",
        "patchSetId": 16
      },
      "lineNbr": 345,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2023-06-28T11:42:00Z",
      "side": 1,
      "message": "Thank you, that makes sense.\n\nSince this is potentially an expensive computation (also involving the index, that can be stale), can we roll out this option with experiment? (I expect it will be an UI experiment, so there is no action needed on this change - just something to keep in mind).",
      "parentUuid": "b2bd113d_d5ed275d",
      "range": {
        "startLine": 343,
        "startChar": 18,
        "endLine": 345,
        "endChar": 46
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5c773708_853f19ad",
        "filename": "java/com/google/gerrit/server/change/RevisionJson.java",
        "patchSetId": 16
      },
      "lineNbr": 345,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2023-06-29T08:42:56Z",
      "side": 1,
      "message": "Yes. We can gate with a UI experiment flag since the new data is gated with a list change option. Thanks for the heads up!\n\nYou\u0027re right. Ideally I\u0027d have wanted us to have a \u0027Get Revision\u0027 endpoint but unfortunately we don\u0027t have it. So yes, requesting it for all patch-sets of the change might be expensive. If this became expensive, we can add a Get Revision EP and FE would need to request it two times (once per patchset for both patchsets getting diffed).",
      "parentUuid": "5301737f_38dd7c64",
      "range": {
        "startLine": 343,
        "startChar": 18,
        "endLine": 345,
        "endChar": 46
      },
      "revId": "8398d0810207ab6d21e285d5f805aaa73aeed90a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}