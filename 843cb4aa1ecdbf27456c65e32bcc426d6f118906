{
  "comments": [
    {
      "key": {
        "uuid": "8382b54f_b2a82089",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NoteDbUpdateManager.java",
        "patchSetId": 1
      },
      "lineNbr": 385,
      "author": {
        "id": 1019407
      },
      "writtenOn": "2016-06-24T19:46:31Z",
      "side": 1,
      "message": "s/is programmer/is a programmer/",
      "range": {
        "startLine": 385,
        "startChar": 54,
        "endLine": 385,
        "endChar": 67
      },
      "revId": "843cb4aa1ecdbf27456c65e32bcc426d6f118906",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6385c158_d15b6474",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NoteDbUpdateManager.java",
        "patchSetId": 1
      },
      "lineNbr": 385,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-27T16:11:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8382b54f_b2a82089",
      "range": {
        "startLine": 385,
        "startChar": 54,
        "endLine": 385,
        "endChar": 67
      },
      "revId": "843cb4aa1ecdbf27456c65e32bcc426d6f118906",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6385c158_11a1eca7",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NotesMigration.java",
        "patchSetId": 1
      },
      "lineNbr": 73,
      "author": {
        "id": 1019407
      },
      "writtenOn": "2016-06-24T19:46:31Z",
      "side": 1,
      "message": "The writeChanges \u003d true requirement is quite counter intuitive.\n\nThe 3 states here are really writeOnlyChanges (currently writeChanges) readWriteChanges (currently readChanges) and this new readOnlyChanges. Can you rename them and use them alone, without requiring dependencies between the three?",
      "range": {
        "startLine": 73,
        "startChar": 0,
        "endLine": 73,
        "endChar": 77
      },
      "revId": "843cb4aa1ecdbf27456c65e32bcc426d6f118906",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6385c158_f1aea895",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NotesMigration.java",
        "patchSetId": 1
      },
      "lineNbr": 73,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-24T20:04:37Z",
      "side": 1,
      "message": "Hm. I see where you\u0027re coming from. You basically want what we have in com.google.gerrit.testutil.NoteDbMode (minus CHECK), which is an enum of the exact configurations that are actually possible.\n\nOne downside is code that currently says \"if (migration.writeChanges())\" now has to say \"if (migration.readChanges() || migration.readWriteChanges())\"\n\nThe other, bigger issue is that we currently have a 1-to-1 mapping between config options and these boolean methods. So if we change the methods we either have to change the config options as well[1], or have a less-than-obvious mapping of config options to methods.\n\nThe real, essential difference between !writeAccounts() and readOnlyAccounts() is what happens when you try to write: in the former case it\u0027s a no-op, NoteDb is completely disabled; in the latter it\u0027s a hard error. Can we maybe think of a better name for readOnlyChanges() that would convey this without being confusing? Something like \"failOnWriteChanges\" or something?\n\n[1] This is a bit of a nonstarter for us, as it requires a flag and config migration on our various googlesource.com hosts, and we\u0027re currently far behind on rolling out new code because $reasons.",
      "parentUuid": "6385c158_11a1eca7",
      "revId": "843cb4aa1ecdbf27456c65e32bcc426d6f118906",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8382b54f_d2f7e492",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NotesMigration.java",
        "patchSetId": 1
      },
      "lineNbr": 73,
      "author": {
        "id": 1019407
      },
      "writtenOn": "2016-06-24T21:30:16Z",
      "side": 1,
      "message": "Previously there were two booleans that defined 4 states, one of which (read without write) was unused (which is why this states \"read requires write\"). This change adds a 3rd boolean to enable that state. Explaining that is confusing. To stick with booleans, what was there before was sufficient,  it just needs to get rid of the \"read requires write\" requirement.\n\nFor readability I was suggesting more of an enumeration-style but just using the original two booleans to express the read-only state is fairly clear too.",
      "parentUuid": "6385c158_f1aea895",
      "revId": "843cb4aa1ecdbf27456c65e32bcc426d6f118906",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8382b54f_d2ca8427",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NotesMigration.java",
        "patchSetId": 1
      },
      "lineNbr": 73,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2016-06-27T16:11:50Z",
      "side": 1,
      "message": "I understand now, thanks for explaining.\n\nI still added some more convenience methods, since now we need to phrase things in terms of the combination of readChanges/writeChanges. But these are strictly convenience methods and are not set from magical new config parameters.",
      "parentUuid": "8382b54f_d2f7e492",
      "revId": "843cb4aa1ecdbf27456c65e32bcc426d6f118906",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}