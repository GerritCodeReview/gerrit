{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "190bf646_627cc725",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2022-11-25T09:43:08Z",
      "side": 1,
      "message": "Looks good to me! left few comments.",
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "12a32a02_2db14d23",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 466,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2022-11-25T09:43:08Z",
      "side": 1,
      "message": "Why did we add it?",
      "range": {
        "startLine": 466,
        "startChar": 11,
        "endLine": 466,
        "endChar": 17
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fc3ebaa3_42f5288b",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 466,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2022-11-25T11:09:51Z",
      "side": 1,
      "message": "See my comment in https://gerrit.googlesource.com/gerrit/+/refs/changes/54/352554/8/java/com/google/gerrit/index/IndexedField.java#252\n\nIntegerRange is always stored in FieldDef:\nhttps://gerrit.googlesource.com/gerrit/+/refs/changes/54/352554/8/java/com/google/gerrit/index/FieldDef.java#55\n\nwhile I don\u0027t really see my this fields has to be stored, I think we have to keep it for compatibility reasons.",
      "parentUuid": "12a32a02_2db14d23",
      "range": {
        "startLine": 466,
        "startChar": 11,
        "endLine": 466,
        "endChar": 17
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c198efe4_e165ac81",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 466,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2022-11-28T09:29:06Z",
      "side": 1,
      "message": "thanks for explaining. I\u0027m a bit confused, since this is an \"integer\" field, not an \"intRange\". Am I missing something?",
      "parentUuid": "fc3ebaa3_42f5288b",
      "range": {
        "startLine": 466,
        "startChar": 11,
        "endLine": 466,
        "endChar": 17
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "253f3744_69734e30",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 466,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2022-11-28T10:54:00Z",
      "side": 1,
      "message": "In our new definitions, \u0027range\u0027 is a search spec, IndexedFields are only types for storage purposes (so IndexedField is an integer, but SearchSpec is a Field (see Line 469).\n\nI think this is actually not correct, since the \u0027stored\u0027 property defines if the field is allowed to be returned from the index, and applies per search.\n\nI changed this property to apply to the search spec in https://gerrit-review.git.corp.google.com/c/gerrit/+/353215",
      "parentUuid": "c198efe4_e165ac81",
      "range": {
        "startLine": 466,
        "startChar": 11,
        "endLine": 466,
        "endChar": 17
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d17ce5d6_48c6755f",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 466,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2022-11-28T11:08:39Z",
      "side": 1,
      "message": "Ah right. L469 has that. Thanks!\n\nAre you sure we should move stored property to spec? e.g. it looks to me if we have {one field, with 3 specs}, we should specify if the field is stored for the field, not the spec? i.e. from the server POV we want the change \"ID\" to be stored, such that when we recover ChangeData from an index document (row, etc...) we are able to deserialize the \"ID\" field into ChangeData. That shouldn\u0027t be related to how this field is searchable (e.g. full_text, vs. exact)?\n\nIn other words, what does it mean to have the \"full_text\" spec stored, but not the \"exact\"?",
      "parentUuid": "253f3744_69734e30",
      "range": {
        "startLine": 466,
        "startChar": 11,
        "endLine": 466,
        "endChar": 17
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "50f430b6_8a924a38",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 466,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2022-11-28T11:18:43Z",
      "side": 1,
      "message": "Agree, let\u0027s keep it as is.",
      "parentUuid": "d17ce5d6_48c6755f",
      "range": {
        "startLine": 466,
        "startChar": 11,
        "endLine": 466,
        "endChar": 17
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "305ae998_c653a744",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 466,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2022-11-28T11:19:25Z",
      "side": 1,
      "message": "Resolving, please +2 if looks good :)",
      "parentUuid": "50f430b6_8a924a38",
      "range": {
        "startLine": 466,
        "startChar": 11,
        "endLine": 466,
        "endChar": 17
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b483c722_375017f0",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 759,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2022-11-25T09:43:08Z",
      "side": 1,
      "message": "[Optional] we can extract all \"Indexfield\"s\u0027 names to static final Strings at the top, and add Javadocs of how these names are used? (I recall you said we don\u0027t need them internally, and only spec names are mapped to our storage defs)\n\nwe discussed before that we only use Specs, but Lucene/Elastic need the field name, they can then reference these constants if we added them here.",
      "range": {
        "startLine": 759,
        "startChar": 54,
        "endLine": 759,
        "endChar": 60
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7ea83c6a_7cd19342",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 759,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2022-11-25T11:09:51Z",
      "side": 1,
      "message": "All indexes only reference fields, never field names directly. I think that is actually the reason why the field names are not separate constants.\nI would keep it as is. I.e. if we introduce such public constant,imagine someone changes the value of such constant, but the field name remains the same. If index implementation rely on the constant, but the field is stored under a different name, they can easily break.",
      "parentUuid": "b483c722_375017f0",
      "range": {
        "startLine": 759,
        "startChar": 54,
        "endLine": 759,
        "endChar": 60
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cf51fce9_1a0823a1",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 759,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2022-11-28T09:29:06Z",
      "side": 1,
      "message": "Ack. Thanks for explaining.",
      "parentUuid": "7ea83c6a_7cd19342",
      "range": {
        "startLine": 759,
        "startChar": 54,
        "endLine": 759,
        "endChar": 60
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "44bac6f7_4f8f8e97",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 785,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2022-11-25T09:43:08Z",
      "side": 1,
      "message": "Q: why did we add required here but, e.g., we didn\u0027t add it in the previous field \"TrackingFooter\"? What fields are we marking as required? (if relevant, can you also add the reason to the commit message)?\n\n(It can also be that a patchset still has no votes, hence this field might be empty. How is this working while we\u0027re enforcing required?)",
      "range": {
        "startLine": 785,
        "startChar": 62,
        "endLine": 785,
        "endChar": 70
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "02e71db3_43ce2ecc",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 785,
      "author": {
        "id": 1118500
      },
      "writtenOn": "2022-11-25T11:09:51Z",
      "side": 1,
      "message": "required just means NOT NULL, so it is always true for the Iterable, unless we return NULL instead of a list somewhere.\n\nI only added required for the fields that (I think) the basic change info, e.g. the info that the change can not be surfaced without on the UI (such as labels, owner, id ...).\n\nI could set required for tracking footers, but this is not strictly necessary.",
      "parentUuid": "44bac6f7_4f8f8e97",
      "range": {
        "startLine": 785,
        "startChar": 62,
        "endLine": 785,
        "endChar": 70
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f1e8fb90_a1acade3",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 785,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2022-11-28T09:29:06Z",
      "side": 1,
      "message": "Ack.",
      "parentUuid": "02e71db3_43ce2ecc",
      "range": {
        "startLine": 785,
        "startChar": 62,
        "endLine": 785,
        "endChar": 70
      },
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5977e98b_051bc48d",
        "filename": "java/com/google/gerrit/server/index/change/ChangeField.java",
        "patchSetId": 8
      },
      "lineNbr": 1040,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2022-11-25T09:43:08Z",
      "side": 1,
      "message": "Why not drop this, and define two specs (exact, fulltext) for the same COMMIT_MESSAGE_FIELD?\n\nanswer: we truncate commit message exact.",
      "revId": "97d02874ba625ec3a1c06ddeb1040a9e0076cc4f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}