{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "b88da6f3_441cb95b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 14,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-03-03T20:33:40Z",
      "side": 1,
      "message": "in site program like Reindex. The problem was: plugins are not loaded in site program in general and in Reindex in particular. BatchModule solved that.",
      "range": {
        "startLine": 14,
        "startChar": 30,
        "endLine": 14,
        "endChar": 51
      },
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e6ea3718_f2e4434f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 14,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-03-04T00:44:29Z",
      "side": 1,
      "message": "\u003e in site program like Reindex.\n\nAck.\n\n\u003e The problem was: plugins are not loaded in site program in general and in Reindex in particular. BatchModule solved that.\n\nThat isn\u0027t true: the init is honouring also the loading and execution of the plugin\u0027s init step, from the very beginning. The thing is that the batch programs are not Gerrit and therefore they do not have all the injections ready as in the real runtime.",
      "parentUuid": "b88da6f3_441cb95b",
      "range": {
        "startLine": 14,
        "startChar": 30,
        "endLine": 14,
        "endChar": 51
      },
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0fe7c817_43a91671",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 14,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-03-04T06:32:18Z",
      "side": 1,
      "message": "\u003e That isn\u0027t true [...]\n\nInit step has nothing to do with site program. \n\n  $ java -jar gerrit.war init\n\nis init step, but:\n\n  $ java -jar gerrit.war reindex\n\nis site program call. My statement was plugins were not supported in site program and that\u0027s why batch module in plugins was introduced. Your answer was: init step always supported plugins.\n\nThis change is about site program and not init step.\n\nAgain, what you need to epmhasize is the fact, that libModule overloading is now also supported in site program.",
      "parentUuid": "e6ea3718_f2e4434f",
      "range": {
        "startLine": 14,
        "startChar": 30,
        "endLine": 14,
        "endChar": 51
      },
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1cec38f3_8430c4d5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 21,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-03-03T20:33:40Z",
      "side": 1,
      "message": "Mention that the plugin could then expose BatchModule to be loaded  in site program like Reindex for new plugin classes (was already possible before this change) and in addition, override gerrit classes from core in site program like Reindex (this change). One use case would be to override H2 cache backend during reindex operation with alternative cache backend. This is needed, because reindex populates diff caches.",
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "df969e93_b5249c61",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 21,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-03-04T00:50:03Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1cec38f3_8430c4d5",
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6c120730_678f7659",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 25,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-03-03T20:33:40Z",
      "side": 1,
      "message": "\"site program\" would be more clear in this context, like Reindex?",
      "range": {
        "startLine": 24,
        "startChar": 59,
        "endLine": 25,
        "endChar": 4
      },
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9c0e2b0d_9ff551f0",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 25,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-03-04T00:50:03Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6c120730_678f7659",
      "range": {
        "startLine": 24,
        "startChar": 59,
        "endLine": 25,
        "endChar": 4
      },
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "80862fde_3ef6e651",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 26,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-03-03T20:33:40Z",
      "side": 1,
      "message": "I think daemon and site program as \"two contexts\" here is rather confusing. libModule is already there and BatchModul is also there. The reason why we add new libModule kind is to allow the plugins to override gerrit core classes in site program. May be remove mention of daemon here?",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 26,
        "endChar": 49
      },
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e824ea8d_7c0e51f3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-03-03T00:41:03Z",
      "side": 1,
      "message": "Ping ...",
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5046af99_b85f0433",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-03-03T20:33:40Z",
      "side": 1,
      "message": "Should we wait with merging this until libBatchModule is exposed in modules/cache-chroniclemap project and we verified with this series that reindex works as expected (because we cannot really test this change otherwise, beside that reindex works again with multi-site plugin installed)?",
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "21af8a67_5de85193",
        "filename": "Documentation/config-gerrit.txt",
        "patchSetId": 7
      },
      "lineNbr": 2190,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-03-03T20:33:40Z",
      "side": 1,
      "message": "Mention that Gerrit plugin could contribute to libBatchModule, similarly that  plugins can expose BatchModule, and it would be loaded in site program (like Reindex) and could override gerrit core bindings.",
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fbbd6889_f9443ec3",
        "filename": "Documentation/config-gerrit.txt",
        "patchSetId": 7
      },
      "lineNbr": 2190,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-03-03T23:48:21Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "21af8a67_5de85193",
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1364099a_974900bd",
        "filename": "java/com/google/gerrit/server/LibModuleType.java",
        "patchSetId": 7
      },
      "lineNbr": 23,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-03-03T20:33:40Z",
      "side": 1,
      "message": "dbInjector, as you are passing dbInjector to BatchProgramModule ctor:\n\n  modules.add(new BatchProgramModule(dbInjector));",
      "range": {
        "startLine": 23,
        "startChar": 26,
        "endLine": 23,
        "endChar": 37
      },
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d5087c89_20a769ae",
        "filename": "java/com/google/gerrit/server/LibModuleType.java",
        "patchSetId": 7
      },
      "lineNbr": 23,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-03-03T23:48:21Z",
      "side": 1,
      "message": "The batch module is a child injector of dbInjector, but cannot override modules of it.",
      "parentUuid": "1364099a_974900bd",
      "range": {
        "startLine": 23,
        "startChar": 26,
        "endLine": 23,
        "endChar": 37
      },
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a3f8768a_00325eb9",
        "filename": "java/com/google/gerrit/server/LibModuleType.java",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2021-03-03T20:33:40Z",
      "side": 1,
      "message": "DB_BATCH_MODULE?",
      "range": {
        "startLine": 24,
        "startChar": 2,
        "endLine": 24,
        "endChar": 6
      },
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d1c4fde6_76f9d46f",
        "filename": "java/com/google/gerrit/server/LibModuleType.java",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-03-03T23:48:21Z",
      "side": 1,
      "message": "See above: it isn\u0027t an override of the db module, hence it would be misleading to think about that is equivalent to the DB_MODULE",
      "parentUuid": "a3f8768a_00325eb9",
      "range": {
        "startLine": 24,
        "startChar": 2,
        "endLine": 24,
        "endChar": 6
      },
      "revId": "99c1a8b129169718ef01dfb603563e17a82b5357",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}