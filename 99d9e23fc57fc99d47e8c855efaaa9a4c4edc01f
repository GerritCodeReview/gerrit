{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "9c0e18c7_c6da0b55",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2021-04-12T12:53:21Z",
      "side": 1,
      "message": "Looks nice! Just two nits.",
      "revId": "99d9e23fc57fc99d47e8c855efaaa9a4c4edc01f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "368fc55f_710b7e2a",
        "filename": "java/com/google/gerrit/entities/SubmitRequirement.java",
        "patchSetId": 4
      },
      "lineNbr": 59,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2021-04-12T12:53:21Z",
      "side": 1,
      "message": "Following the meaning and JavaDoc, should we call this \"canOverride\".\n\ncanInherit\u003dfalse would suggest to me that this requirement is applicable only to the current project and will not inherit further down. But that\u0027s not the functionality we need. Admins/owners want to make it so that this requirement is enforced in all child projects and child project owners can\u0027t turn it off.",
      "range": {
        "startLine": 59,
        "startChar": 26,
        "endLine": 59,
        "endChar": 36
      },
      "revId": "99d9e23fc57fc99d47e8c855efaaa9a4c4edc01f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e076a5f6_4a0090e4",
        "filename": "java/com/google/gerrit/entities/SubmitRequirement.java",
        "patchSetId": 4
      },
      "lineNbr": 59,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2021-04-12T15:33:40Z",
      "side": 1,
      "message": "mmm, we just saw that `canOverride` confuses with `overrideExpression` (especially that it has nothing to do with it), so I renamed it to canInherit. See my discussion with Edwin in [1].\n\nI can rename to \"allowOverrideInSubprojects\" or something similar. WDYT?\n\n[1] https://gerrit-review.googlesource.com/c/gerrit/+/301927/1..4/java/com/google/gerrit/entities/SubmitRequirement.java#b59.",
      "parentUuid": "368fc55f_710b7e2a",
      "range": {
        "startLine": 59,
        "startChar": 26,
        "endLine": 59,
        "endChar": 36
      },
      "revId": "99d9e23fc57fc99d47e8c855efaaa9a4c4edc01f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "161ce2e5_2a4de030",
        "filename": "java/com/google/gerrit/entities/SubmitRequirement.java",
        "patchSetId": 4
      },
      "lineNbr": 59,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2021-04-13T12:27:41Z",
      "side": 1,
      "message": "I don\u0027t mind the name that much, actually. We just can\u0027t change the semantic. We can invert the boolean if we like an inverted name better. It has to work as \"this SR can\u0027t be overridden in child projects\". So it can\u0027t be \"this SR can inherit to child projects\".\n\nHow about: allowOverrideInChildProjects (default \u003d true)\n\n(most places call a sub project \u0027child\u0027 in the existing code).",
      "parentUuid": "e076a5f6_4a0090e4",
      "range": {
        "startLine": 59,
        "startChar": 26,
        "endLine": 59,
        "endChar": 36
      },
      "revId": "99d9e23fc57fc99d47e8c855efaaa9a4c4edc01f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "309e80e7_93c0b5ca",
        "filename": "java/com/google/gerrit/entities/SubmitRequirementExpression.java",
        "patchSetId": 4
      },
      "lineNbr": 25,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2021-04-12T12:53:21Z",
      "side": 1,
      "message": "I think before we do that we\u0027d need to run benchmarks to proof that it\u0027s actually necessary (i.e. the parsing of the string using our grammar is slower than X milliseconds).\n\nCaching a string is elegant because it\u0027s immutable and takes almost no space. So a I think we need a justification for a more complex alternative.",
      "range": {
        "startLine": 25,
        "startChar": 12,
        "endLine": 25,
        "endChar": 26
      },
      "revId": "99d9e23fc57fc99d47e8c855efaaa9a4c4edc01f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "19c51089_b50fc9f0",
        "filename": "java/com/google/gerrit/entities/SubmitRequirementExpression.java",
        "patchSetId": 4
      },
      "lineNbr": 25,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2021-04-12T15:33:40Z",
      "side": 1,
      "message": "The discussion was in https://gerrit-review.googlesource.com/c/gerrit/+/301927/1..4/java/com/google/gerrit/entities/SubmitRequirement.java#b36.\n\nThe advantages are:\n1) The ability to perform syntax validation.\n2) Sparing parsing the expression many times by multiple callers. SR will be parsed once when loaded from the project\u0027s config.\n\nFor caching, we could still cache it as a String and reload the parse tree while serializing.",
      "parentUuid": "309e80e7_93c0b5ca",
      "range": {
        "startLine": 25,
        "startChar": 12,
        "endLine": 25,
        "endChar": 26
      },
      "revId": "99d9e23fc57fc99d47e8c855efaaa9a4c4edc01f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "33e06282_161ea90d",
        "filename": "java/com/google/gerrit/entities/SubmitRequirementExpression.java",
        "patchSetId": 4
      },
      "lineNbr": 25,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2021-04-13T12:27:41Z",
      "side": 1,
      "message": "I don\u0027t understand why we can do syntax validation only if we cache the parsed tree (vs. the string)?\n\nFrom my experience, it\u0027s actually the opposite: If we cache the parsed tree, that means we have to parse it when we deserialize the string from the persisted cache. That\u0027s a bad place to throw a InvalidSubmitRequirementException.\n\nA better place to throw such an exception is when the SR is actually used (the best place is o.c. before the bad config is created).\n\n(2) Is a good argument in case parsing is not trivially cheap.\n\nI think Edwin was mostly asking for this interface to return the parsed tree, not necessarily that we cache the parsed tree? (note that if we cache it, it has to be deeply immutable).\n\nAnyway, happy to chat about this later when we actually want to cache a tree. The code now does not do that, so seems good in any case :-)",
      "parentUuid": "19c51089_b50fc9f0",
      "range": {
        "startLine": 25,
        "startChar": 12,
        "endLine": 25,
        "endChar": 26
      },
      "revId": "99d9e23fc57fc99d47e8c855efaaa9a4c4edc01f",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}