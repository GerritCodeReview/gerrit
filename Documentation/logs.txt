= Gerrit Code Review - Logs

Gerrit writes log files in the `$site/logs/` folder tracking requests,
background and plugin activity and errors. By default logs are written
in text format, optionally in json format. By default log files are compressed
at server startup and then daily at 11pm and rotated every midnight.

== Logs

The following logs are written.

=== HTTPD Log

The httpd log tracks HTTP requests processed by Gerrit's http daemon
and is written to `$site/logs/httpd_log`.

Format is an enhanced
link:https://httpd.apache.org/docs/2.4/logs.html#combined[NCSA combined log],
if a log field is not present, a "-" is substituted:

* `host`: The IP address or host/subdomain name of the HTTP client that
  made the HTTP resource request.
* `[thread name]`: name of the Java thread executing the request.
* `remote logname`:  the identifier used to
  link: https://tools.ietf.org/html/rfc1413[identify the client making the HTTP request],
  Gerrit always logs a dash `-`.
* `username`: the username, or user ID used by the client for authentication.
* `[date:time]`: The date and time stamp of the HTTP request.
  The time that the request was received. The format is until Gerrit 3.1
  `[dd/MMM/yyyy:HH:mm:ss.SSS ZZZZ]`. For Gerrit 3.2 or newer
  link:https://www.w3.org/TR/NOTE-datetime[ISO 8601 format] `[yyyy-MM-dd'T'HH:mm:ss,SSSZ]`
  is used for all timestamps.
* `request`: The request line from the client is given in double quotes.
** the HTTP method used by the client.
** the resource the client requested.
** the protocol used by the client.
* `statuscode`: the link:https://tools.ietf.org/html/rfc2616#section-10[HTTP status code]
  that the server sent back to the client.
* `response size`: the number of bytes of data transferred as part of the HTTP
  request, not including the HTTP header.
* `latency`: response time in milliseconds.
* `referer`: the `Referer` HTTP request header. This gives the site that
  the client reports having been referred from.
* `client agent`: the client agent which sent the request.

=== SSHD Log

The sshd log tracks ssh requests processed by Gerrit's ssh daemon
and is written to `$site/logs/sshd_log`.

Log format:

* `[date time]`: The time that the request was received.
  The format is until Gerrit 3.1 `[yyyy-mm-dd HH:mm:ss.SSS ZZZZ]`.
  For Gerrit 3.2 or newer
  link:https://www.w3.org/TR/NOTE-datetime[ISO 8601 format] `[yyyy-MM-dd'T'HH:mm:ss,SSSZ]`
  is used for all timestamps.
* `sessionid`: hexadecimal session identifier, all requests of the
  same session share the same sessionid.
* `[thread name]`: name of the Java thread executing the request.
* `username`: the username, or user ID used by the client for authentication.
* `accountid`: identifier of the Gerrit account which is logged on.
* `command`: the command being executed via ssh.
** `LOGIN FROM <host>`: login and start new SSH session from the given host.
** `AUTH FAILURE FROM <host> <message>`: failed authentication from given host and cause of failure.
** `LOGOUT`: logout and terminate SSH session.
** `git-upload-pack.<projectname>`: git fetch or clone command for given project.
** `git-receive-pack.<projectname>`: git push command for given project.
** Gerrit ssh commands which may be logged in this field are documented
   link:/Documentation/cmd-index.html#_server[here].
* `wait`: command wait time, time in milliseconds the command waited for an execution thread.
* `exec`: command execution time, time in milliseconds to execute the command.
* `status`: status code.

The `git-upload-pack` command provides the following additional fields after the `exec`
and before the `status` field. All times are in milliseconds, or -1 if not available:

* `time negotiating`: time for negotiating which objects need to be transferred.
* `time searching for reuse`: time jgit searched for deltas which can be reused.
* `time searching for sizes`: time jgit was searching for sizes.
* `time counting`: time jgit was counting objects.
* `time compressing`: time jgit was compressing objects.
* `time writing`: time jgit needed to write packfile.
* `total time in UploadPack`: total time jgit spent in upload-pack.
* `bitmap index misses`: number of misses when trying to use bitmap index,
  -1 means no bitmap index available.
* `total deltas`: total number of deltas transferred.
* `total objects`: total number of objects transferred.
* `total bytes`: total number of bytes transferred.
* `client agent`: the client agent which sent the request.

=== Error Log

The error log tracks errors and stack traces and is written to
`$site/logs/error_log`.

Log format:

* `[date time]`: The time that the request was received.
  The format is until Gerrit 3.1 `[yyyy-mm-dd HH:mm:ss.SSS ZZZZ]`.
  For Gerrit 3.2 or newer
  link:https://www.w3.org/TR/NOTE-datetime[ISO 8601 format] `[yyyy-MM-dd'T'HH:mm:ss,SSSZ]`
  is used for all timestamps.
* `[thread name]`: : name of the Java thread executing the request.
* `level`: log level (ERROR, WARN, INFO, DEBUG).
* `logger`: name of the logger.
* `message`: log message.
* `stacktrace`: Java stacktrace when an execption was caught.

=== GC Log

The gc log tracks git garbage collection running in a background thread
if enabled and is written to `$site/logs/gc_log`.

Log format:

* `[date time]`: The time that the request was received.
  The format is until Gerrit 3.1 `[yyyy-mm-dd HH:mm:ss.SSS ZZZZ]`.
  For Gerrit 3.2 or newer
  link:https://www.w3.org/TR/NOTE-datetime[ISO 8601 format] `[yyyy-MM-dd'T'HH:mm:ss,SSSZ]`
  is used for all timestamps.
* `level`: log level (ERROR, WARN, INFO, DEBUG).
* `message`: log message.

=== Plugin Logs

Some plugins write their own log file.
E.g. the replication plugin writes its log to `$site/logs/replication_log`.

GERRIT
------
Part of link:index.html[Gerrit Code Review]

SEARCHBOX
---------
