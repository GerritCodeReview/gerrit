{
  "pushCert": "certificate version 0.1\npusher A0D0EF51 1497434179 +0200\nnonce AH5c86AHylzL1WEGb2dMv4H/fc6gGYUCyBsE+cxjaNOD+i+4Ooate4ZQL2FZ8ygXmxFPImEUvupX\n\n0000000000000000000000000000000000000000 a11098f3d62360e434ebbd2789cdd974a4948cad refs/for/master\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQEcBAABAgAGBQJZQQhDAAoJEFG1/Zeg0O9Ru2wH/2+Aiay56kY0YheIHUISoihE\nu7YohSV35p2g+rwn4Hzg6kyyURv9yAbxJBoNF0vfuiYdl3TNvXVb57AaHf3PPScb\n62PBaZz8+SsEuz7Jx676x6fsAEjt1ewf2aR596AtNu1zeCWCuFebnECqqX+fTHDx\nAk2qD/XDRiOYr8unKz+spsoKwf490pFmPEin+M+Zi2vqpPAGQMVq4FzurVffw77R\nylxBQl1q7bYvJOswV9vIrd3uXlEygRUzSWhDW/hSzaesqWGkHo9AQoYgGvZZWA7m\nmOXDO0zIpgn1DhwuNPb14xXzj45m26rG5Yd4oo+yBkr81AIS97NMiHguG89929E\u003d\n\u003doQ3x\n-----END PGP SIGNATURE-----\n",
  "comments": [
    {
      "key": {
        "uuid": "803b3a8a_a03e6832",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/config/SetPreferences.java",
        "patchSetId": 1
      },
      "lineNbr": 94,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-06-14T20:15:02Z",
      "side": 1,
      "message": "This is going to take a super long time if anybody calls this endpoint on one of our hosts with thousands of accounts. I guess maybe we don\u0027t care, because we trust admins to not DoS us?\n\nI don\u0027t suppose there is some way to filter this list to only users it would be applicable to? Then again, maybe it would be applicable to almost all users, i.e. anybody who has the default preferences.",
      "revId": "a11098f3d62360e434ebbd2789cdd974a4948cad",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "27f86b1b_e63bfb60",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/config/SetPreferences.java",
        "patchSetId": 1
      },
      "lineNbr": 94,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2017-06-16T08:24:46Z",
      "side": 1,
      "message": "\u003e This is going to take a super long time if anybody calls this\n \u003e endpoint on one of our hosts with thousands of accounts. I guess\n \u003e maybe we don\u0027t care, because we trust admins to not DoS us?\n\nYes, we expect that this REST endpoint is rarely invoked.\n\n \u003e I don\u0027t suppose there is some way to filter this list to only users\n \u003e it would be applicable to? Then again, maybe it would be applicable\n \u003e to almost all users, i.e. anybody who has the default preferences.\n\nActually what we need is to flush all accounts from the account cache, but reindex is actually not needed. Flushing from the account cache is needed because the general preferences are stored within the account object. Reindexing is not needed since non of the account index fields is based on the preferences.\n\nSo we could do the following:\n\na) Rename AccountCache#evictAll() to AccountCache#evictAllNoReindex() and remove the indexing functionality from that method\n\nb) Document that AccountCache#evictAll() doesn\u0027t reindex and remove the indexing functionality from that method\n\nc) Keep this change as it is and be okay with the unneeded reindex of all accounts which takes a long time.\n\nWhat do you prefer a) or b)?",
      "parentUuid": "803b3a8a_a03e6832",
      "revId": "a11098f3d62360e434ebbd2789cdd974a4948cad",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9a425c83_abb8e9e3",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/config/SetPreferences.java",
        "patchSetId": 1
      },
      "lineNbr": 94,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-06-16T14:10:54Z",
      "side": 1,
      "message": "I would prefer (a). It\u0027s the same behavior as (b) but the documentation is right there in the method name :)",
      "parentUuid": "27f86b1b_e63bfb60",
      "revId": "a11098f3d62360e434ebbd2789cdd974a4948cad",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}