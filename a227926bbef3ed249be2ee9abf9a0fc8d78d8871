{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "06214b52_4c505177",
        "filename": "java/com/google/gerrit/server/mail/send/SmtpEmailSender.java",
        "patchSetId": 3
      },
      "lineNbr": 167,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2024-03-08T09:14:46Z",
      "side": 1,
      "message": "Why not also change this one to `atWarning` like the other two?\n\nOptional:\nIf this is done, then the `logger.atWarning().atMostEvery(1, HOURS)` can be factored out into a variable or logging could be factored out into a method.",
      "range": {
        "startLine": 167,
        "startChar": 13,
        "endLine": 167,
        "endChar": 19
      },
      "revId": "a227926bbef3ed249be2ee9abf9a0fc8d78d8871",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "07ebdb65_029122b4",
        "filename": "java/com/google/gerrit/server/mail/send/SmtpEmailSender.java",
        "patchSetId": 3
      },
      "lineNbr": 167,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2024-03-08T10:11:58Z",
      "side": 1,
      "message": "I would rather tend to change log level of all these calls to fine. If the admin configured that he wants to deny some recipient why should this be logged as a warning when it happens ? Do we need to remind the admin in the logs what he configured in the gerrit configuration ?\n\nRate limiting the current behavior is a compromise between flooding the logs by default or changing this to debug trace.",
      "parentUuid": "06214b52_4c505177",
      "range": {
        "startLine": 167,
        "startChar": 13,
        "endLine": 167,
        "endChar": 19
      },
      "revId": "a227926bbef3ed249be2ee9abf9a0fc8d78d8871",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "536fb811_eee013ef",
        "filename": "java/com/google/gerrit/server/mail/send/SmtpEmailSender.java",
        "patchSetId": 3
      },
      "lineNbr": 167,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2024-03-08T12:57:17Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "07ebdb65_029122b4",
      "range": {
        "startLine": 167,
        "startChar": 13,
        "endLine": 167,
        "endChar": 19
      },
      "revId": "a227926bbef3ed249be2ee9abf9a0fc8d78d8871",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f93ce4f9_93794281",
        "filename": "java/com/google/gerrit/server/mail/send/SmtpEmailSender.java",
        "patchSetId": 3
      },
      "lineNbr": 187,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2024-03-08T07:41:34Z",
      "side": 1,
      "message": "Does this ensure that every affected email address is at least logged once, i.e. each unique log message is logged once per hour, or is it rate limiting on the call independent of the message content, i.e. just the first email send hitting this line will be logged?",
      "range": {
        "startLine": 187,
        "startChar": 23,
        "endLine": 187,
        "endChar": 34
      },
      "revId": "a227926bbef3ed249be2ee9abf9a0fc8d78d8871",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "26aaa6c7_9c381906",
        "filename": "java/com/google/gerrit/server/mail/send/SmtpEmailSender.java",
        "patchSetId": 3
      },
      "lineNbr": 187,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2024-03-08T09:14:46Z",
      "side": 1,
      "message": "AFAIK, the rate limit is on the call independent of the message. Rate limit is on the logger, not on the message.",
      "parentUuid": "f93ce4f9_93794281",
      "range": {
        "startLine": 187,
        "startChar": 23,
        "endLine": 187,
        "endChar": 34
      },
      "revId": "a227926bbef3ed249be2ee9abf9a0fc8d78d8871",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2ceef3d8_cd68e003",
        "filename": "java/com/google/gerrit/server/mail/send/SmtpEmailSender.java",
        "patchSetId": 3
      },
      "lineNbr": 187,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2024-03-08T10:52:28Z",
      "side": 1,
      "message": "Hm.. would that then not mean, if we have another log statement in this class that it would also be affected, even if it does not explicitly set this option, but is called after this line?",
      "parentUuid": "26aaa6c7_9c381906",
      "range": {
        "startLine": 187,
        "startChar": 23,
        "endLine": 187,
        "endChar": 34
      },
      "revId": "a227926bbef3ed249be2ee9abf9a0fc8d78d8871",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9ffbf59a_5d835200",
        "filename": "java/com/google/gerrit/server/mail/send/SmtpEmailSender.java",
        "patchSetId": 3
      },
      "lineNbr": 187,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2024-03-08T10:58:18Z",
      "side": 1,
      "message": "https://google.github.io/flogger/best_practice.html#log-site sounds like the rate limit is applied per call site.",
      "parentUuid": "2ceef3d8_cd68e003",
      "range": {
        "startLine": 187,
        "startChar": 23,
        "endLine": 187,
        "endChar": 34
      },
      "revId": "a227926bbef3ed249be2ee9abf9a0fc8d78d8871",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b472c125_49cc1b90",
        "filename": "java/com/google/gerrit/server/mail/send/SmtpEmailSender.java",
        "patchSetId": 3
      },
      "lineNbr": 187,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2024-03-08T11:19:13Z",
      "side": 1,
      "message": "Ok. However, we would still miss some blocked emails in the log, e.g. the first log would be for `foo@example.com` and would be logged. If now 10 minutes later `bar@example.com` would be the address, it wouldn\u0027t be logged. This might make it hard to analyse issues with email sending for certain configurations.\nMaybe we could instead just make those debug logs?",
      "parentUuid": "9ffbf59a_5d835200",
      "range": {
        "startLine": 187,
        "startChar": 23,
        "endLine": 187,
        "endChar": 34
      },
      "revId": "a227926bbef3ed249be2ee9abf9a0fc8d78d8871",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "61df40cd_981430fc",
        "filename": "java/com/google/gerrit/server/mail/send/SmtpEmailSender.java",
        "patchSetId": 3
      },
      "lineNbr": 187,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2024-03-08T12:57:17Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b472c125_49cc1b90",
      "range": {
        "startLine": 187,
        "startChar": 23,
        "endLine": 187,
        "endChar": 34
      },
      "revId": "a227926bbef3ed249be2ee9abf9a0fc8d78d8871",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}