{
  "comments": [
    {
      "key": {
        "uuid": "83d2d79c_fe1d668c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 13,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-09-02T20:48:06Z",
      "side": 1,
      "message": "I don\u0027t think this improves performance of email sending. It moves email sending to the background (and uses more threads). This commit message does not discuss the tradeoff of more threads and the unboundedness this creates. If email sending is slow, a giant backlog of threads could result. I think this needs more discussion in this change.",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 53
      },
      "revId": "a32ca03c9bd360edeb0981e6db20e004130a7c78",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "450729ba_5534f9ec",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 13,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2020-09-02T21:31:59Z",
      "side": 1,
      "message": "It\u0027s actually fully configurable - you\u0027re free to set the poolThreadSize to 0 on your host, and then this change is a no-op for you.\nThe default is \"1\", as in, only 1 thread would be added (so if you try to send 2 emails, it will send those 2 emails with 1 additional thread).\n\nAlso, the most frequent emails are already sent async (with this config I mentioned above as the limit for number of threads).\n\nI don\u0027t think a giant backlog could result with these limitations.",
      "parentUuid": "83d2d79c_fe1d668c",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 53
      },
      "revId": "a32ca03c9bd360edeb0981e6db20e004130a7c78",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bae66972_52f5b22c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 13,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-09-02T22:21:23Z",
      "side": 1,
      "message": "Oh, I see, I think you\u0027re referring to https://gerrit-review.googlesource.com/Documentation/config-gerrit.html#sendemail.threadPoolSize ?\n\nThat config doesn\u0027t mention what happens if you set it to 0. It sounds like you\u0027re saying a direct executor is used when it\u0027s 0?\n\nI don\u0027t think that prevents a backlog, just prevents more threads being used. You could still have many emails waiting on a small thread pool and a situation where new \"emails to send\" outpace \"emails sent\". I think that\u0027s just a general design concern with sending emails async.",
      "parentUuid": "450729ba_5534f9ec",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 53
      },
      "revId": "a32ca03c9bd360edeb0981e6db20e004130a7c78",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7817c059_78f9a807",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 13,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2020-09-03T08:45:51Z",
      "side": 1,
      "message": "Yes - that\u0027s what I was referring to.\nAnd yes, when it\u0027s 0, a direct executor is used (see SysExecutorModule#provideSendEmailExecutor).\nI can clarify the docs.",
      "parentUuid": "bae66972_52f5b22c",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 53
      },
      "revId": "a32ca03c9bd360edeb0981e6db20e004130a7c78",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "edfc4408_0c53b29b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 13,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2020-09-03T14:44:19Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "7817c059_78f9a807",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 53
      },
      "revId": "a32ca03c9bd360edeb0981e6db20e004130a7c78",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}