{
  "comments": [
    {
      "key": {
        "uuid": "d73267d2_8aedeb18",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/RevisionResource.java",
        "patchSetId": 2
      },
      "lineNbr": 91,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-02-03T19:02:59Z",
      "side": 1,
      "message": "This is no good. I count 7 /revisions requests to serve the change screen; we can\u0027t be doing this ETag computation for every single one of them, when the only one that we actually care about is /revisions/X/actions.\n\nIt\u0027s possible (read: likely) that the REST API glue only knows how to handle HasETag on a RestResource, not on a RestReadView. We need to fix that.",
      "revId": "a5ce54ab0edcd8073426d9012ccd22422f02ac68",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "972c6f7c_68ac43b4",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/RevisionResource.java",
        "patchSetId": 2
      },
      "lineNbr": 91,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-02-04T21:48:02Z",
      "side": 1,
      "message": "Can you give some rough guidance on how I\u0027d start fixing that before I dive into the correct ETag computation?",
      "parentUuid": "d73267d2_8aedeb18",
      "revId": "a5ce54ab0edcd8073426d9012ccd22422f02ac68",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d73267d2_0a23bba7",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/RevisionResource.java",
        "patchSetId": 2
      },
      "lineNbr": 91,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-02-04T22:03:02Z",
      "side": 1,
      "message": "Look at RestApiServlet.notModified. That checks if the resource\u0027s ETag changed. You need a similar interface like ETagView that with a method getETag(RestResource) that views can implement. In notModified, the view ETag would take precedence over the resource ETag if both have them. notModified is only called late enough in the pipeline that you have the actual view object already available.\n\n(The view implementation could also check if the RestResource argument has its own ETag and include that in its computation of course, but I don\u0027t think your implementation would do that.)",
      "parentUuid": "972c6f7c_68ac43b4",
      "revId": "a5ce54ab0edcd8073426d9012ccd22422f02ac68",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}