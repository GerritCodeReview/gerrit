{
  "comments": [
    {
      "key": {
        "uuid": "8ee2c6c4_4d545b11",
        "filename": "polygerrit-ui/app/elements/change/gr-file-list/gr-file-list.js",
        "patchSetId": 6
      },
      "lineNbr": 1282,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2020-06-15T08:59:25Z",
      "side": 1,
      "message": "Would you also want to do this for 100+ files? Or should we only prefetch the first 20 files here?",
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6df37d44_83be1422",
        "filename": "polygerrit-ui/app/elements/change/gr-file-list/gr-file-list.js",
        "patchSetId": 6
      },
      "lineNbr": 1282,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2020-06-15T13:57:56Z",
      "side": 1,
      "message": "It\u0027s limited by number of files shown - which by default is 200. I don\u0027t think we need another limit, but if you do, please reopen this comment.\n\nAlso this is run only when user press expand all.",
      "parentUuid": "8ee2c6c4_4d545b11",
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "15f55f64_32b7be3a",
        "filename": "polygerrit-ui/app/elements/change/gr-file-list/gr-file-list.js",
        "patchSetId": 6
      },
      "lineNbr": 1286,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2020-06-15T08:59:25Z",
      "side": 1,
      "message": "I am ok with doing this here for now, but maybe we want to do the prefetching even earlier, e.g. when the change page has finished loading?",
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "63db0a3b_e9017157",
        "filename": "polygerrit-ui/app/elements/change/gr-file-list/gr-file-list.js",
        "patchSetId": 6
      },
      "lineNbr": 1286,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2020-06-15T13:57:56Z",
      "side": 1,
      "message": "Yes, that will be prefetched by service worker. But until then this is quick solution for this pain point.",
      "parentUuid": "15f55f64_32b7be3a",
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a036a606_5d6e0210",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 221,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2020-06-15T08:59:25Z",
      "side": 1,
      "message": "maybe rename to _fetchDiffPromise",
      "range": {
        "startLine": 221,
        "startChar": 6,
        "endLine": 221,
        "endChar": 26
      },
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "86cbbe25_8ca66588",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 221,
      "author": {
        "id": 1085901
      },
      "writtenOn": "2020-06-15T09:11:15Z",
      "side": 1,
      "message": "nit: prefetch (to make it consistent with other places)",
      "range": {
        "startLine": 221,
        "startChar": 10,
        "endLine": 221,
        "endChar": 11
      },
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "483fd6dd_6dc62aad",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 221,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2020-06-15T13:57:56Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "86cbbe25_8ca66588",
      "range": {
        "startLine": 221,
        "startChar": 10,
        "endLine": 221,
        "endChar": 11
      },
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a032ff62_7c551d61",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 221,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2020-06-15T13:57:56Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a036a606_5d6e0210",
      "range": {
        "startLine": 221,
        "startChar": 6,
        "endLine": 221,
        "endChar": 26
      },
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "64a1a867_80c4ae99",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 544,
      "author": {
        "id": 1085901
      },
      "writtenOn": "2020-06-15T09:11:15Z",
      "side": 1,
      "message": "It seems, that every call to prefetch starts a new requests, i.e. it is not recommended to call prefetchDiff multiple times. Do we really need this limitation?",
      "range": {
        "startLine": 544,
        "startChar": 2,
        "endLine": 544,
        "endChar": 14
      },
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ed0b4688_0f185ac2",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 544,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2020-06-15T13:57:56Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "64a1a867_80c4ae99",
      "range": {
        "startLine": 544,
        "startChar": 2,
        "endLine": 544,
        "endChar": 14
      },
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4ca44c04_e5e150c8",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 545,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2020-06-15T08:59:25Z",
      "side": 1,
      "message": "Maybe check whether _preFetchDiffPromise is still null to avoid kicking this off twice.",
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1b9fe2e7_c79b3642",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 545,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2020-06-15T13:57:56Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4ca44c04_e5e150c8",
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b51d729b_9481e6c6",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 552,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2020-06-15T08:59:25Z",
      "side": 1,
      "message": "maybe rename to _fetchDiff",
      "range": {
        "startLine": 552,
        "startChar": 2,
        "endLine": 552,
        "endChar": 10
      },
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7ec50553_254eced7",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 552,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2020-06-15T13:57:56Z",
      "side": 1,
      "message": "I don\u0027t plan to change more than necessary.",
      "parentUuid": "b51d729b_9481e6c6",
      "range": {
        "startLine": 552,
        "startChar": 2,
        "endLine": 552,
        "endChar": 10
      },
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8c6fca46_a6be99cf",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 553,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2020-06-15T08:59:25Z",
      "side": 1,
      "message": "I think I would move this to line 342:\n\n  const fetchDiffPromise \u003d this._fetchDiffPromise ?\n                           this._fetchDiffPromise : this._fetchDiff();\n  this._fetchDiffPromise \u003d null;",
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "80fcea2f_d96a9cf8",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 553,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2020-06-15T13:57:56Z",
      "side": 1,
      "message": "I actually had it like that in first patchset. Then I moved it here, so\n\n1, the logic is in this part only. \n2, reload is much simpler\n\nIf you disagree, please reopen this.",
      "parentUuid": "8c6fca46_a6be99cf",
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "be5d7be0_3ef9a1e1",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 555,
      "author": {
        "id": 1085901
      },
      "writtenOn": "2020-06-15T09:11:15Z",
      "side": 1,
      "message": "Why the _preFetchDiffPromise is resetted on each call? Is it possible to return it without reset?",
      "range": {
        "startLine": 555,
        "startChar": 11,
        "endLine": 555,
        "endChar": 31
      },
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1c36eb0f_18b5cf15",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 555,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2020-06-15T13:57:56Z",
      "side": 1,
      "message": "This is simple invalidation. I will do this better, once I will move this caching to rest-api-interface",
      "parentUuid": "be5d7be0_3ef9a1e1",
      "range": {
        "startLine": 555,
        "startChar": 11,
        "endLine": 555,
        "endChar": 31
      },
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0d5b36ac_df6ee03c",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 566,
      "author": {
        "id": 1085901
      },
      "writtenOn": "2020-06-15T09:11:15Z",
      "side": 1,
      "message": "The changeNum, patchRange and path are binded. The _getIgnoreWhitespace can be changed.\nIt seems, the _preFetchDiffPromise must be reset every time when one of the parameter for getDiff is changed.\nAnd probably, it should be rejected, so other code doesn\u0027t get old data (not sure about this part)\n\nP.S. As an alternative solution, can we cache diff content in the restAPI instead (like we do with some other data?)\nFor example, we can keep last 100 requests for diff. Then we can get performance improvements also in a separate diff view.",
      "range": {
        "startLine": 562,
        "startChar": 10,
        "endLine": 566,
        "endChar": 38
      },
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9fdcb726_d7c1751c",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-host/gr-diff-host.js",
        "patchSetId": 6
      },
      "lineNbr": 566,
      "author": {
        "id": 1085182
      },
      "writtenOn": "2020-06-15T13:57:56Z",
      "side": 1,
      "message": "1. I added reset on whitespace change\n\nYes, I plan to cache in rest api in future, so then I will not need to cache promise here. I will just call _getDiff. I will do this as follow-up this change. But I need to clean up cache to be used for more complex request than it is now.",
      "parentUuid": "0d5b36ac_df6ee03c",
      "range": {
        "startLine": 562,
        "startChar": 10,
        "endLine": 566,
        "endChar": 38
      },
      "revId": "a89fdb7f50e36deca31bac83c1c3ae2abf9be659",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}