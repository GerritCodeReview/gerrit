{
  "comments": [
    {
      "key": {
        "uuid": "e385d975_7a4e174f",
        "filename": "javatests/com/google/gerrit/acceptance/api/change/ChangeIT.java",
        "patchSetId": 3
      },
      "lineNbr": 1408,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2019-08-21T12:57:27Z",
      "side": 1,
      "message": "Can\u0027t you simply open the repository directly and do repo.exactRef ?\n\nSee line 751.",
      "range": {
        "startLine": 1408,
        "startChar": 15,
        "endLine": 1408,
        "endChar": 23
      },
      "revId": "aae38d640c8bfc7c3d68a608afa73627b745a812",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "55faa38e_121bdf38",
        "filename": "javatests/com/google/gerrit/acceptance/api/change/ChangeIT.java",
        "patchSetId": 3
      },
      "lineNbr": 1408,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2019-08-21T13:41:52Z",
      "side": 1,
      "message": "In that example he only doesn\u0027t look at user refs. Since I need refs/users, I will apparently need to fetch it first (which will just make it more complicated than the current solution imo).",
      "parentUuid": "e385d975_7a4e174f",
      "range": {
        "startLine": 1408,
        "startChar": 15,
        "endLine": 1408,
        "endChar": 23
      },
      "revId": "aae38d640c8bfc7c3d68a608afa73627b745a812",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9feb17b8_e3910760",
        "filename": "javatests/com/google/gerrit/acceptance/api/change/ChangeIT.java",
        "patchSetId": 3
      },
      "lineNbr": 1408,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2019-08-22T13:21:46Z",
      "side": 1,
      "message": "oh right.  But the suggestion is valid, I think.\n\nSee l.1375, just 30 lines above.",
      "parentUuid": "55faa38e_121bdf38",
      "range": {
        "startLine": 1408,
        "startChar": 15,
        "endLine": 1408,
        "endChar": 23
      },
      "revId": "aae38d640c8bfc7c3d68a608afa73627b745a812",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6dea445b_e7417488",
        "filename": "javatests/com/google/gerrit/acceptance/api/change/ChangeIT.java",
        "patchSetId": 3
      },
      "lineNbr": 1408,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2019-08-22T16:10:19Z",
      "side": 1,
      "message": "Thanks for the suggestion.\nI remember I tried it before but I tried again just in case. I don\u0027t fully understand why it doesn\u0027t work, but when using repo.getRefDatabase().getRefs() it does not show me the edits there (before the deletion, of course). It does show the drafts in the other test, and a few other refs, but that\u0027s not helpful.\nMaybe that\u0027s why that test didn\u0027t exist before, because it required using something non-trivial (lsremote) to find the problem.",
      "parentUuid": "9feb17b8_e3910760",
      "range": {
        "startLine": 1408,
        "startChar": 15,
        "endLine": 1408,
        "endChar": 23
      },
      "revId": "aae38d640c8bfc7c3d68a608afa73627b745a812",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c2ff2374_34f90a24",
        "filename": "javatests/com/google/gerrit/acceptance/api/change/ChangeIT.java",
        "patchSetId": 3
      },
      "lineNbr": 1408,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2019-08-26T12:16:20Z",
      "side": 1,
      "message": "it looks like I was wrong with some hunches. The change edit is in the same repo as the main change ref, \n\n  https://gerrit.googlesource.com/gerrit/+/283ac230a4b1320627debea83f1a3fde22c90863/java/com/google/gerrit/server/edit/ChangeEditUtil.java#120\n\nso to write the test you have to do\n\n    try (Repository repo \u003d repoManager.openRepository(reponame)) {\n\nthe reponame should be the same one as here: \n\nhttps://gerrit.googlesource.com/gerrit/+/283ac230a4b1320627debea83f1a3fde22c90863/java/com/google/gerrit/acceptance/AbstractDaemonTest.java#260\n\nyour lsRemote() lists the refs through the Git wire protocol. That is a useful exercise to try, but since we have all of the data inside the same JVM process, you should just access it directly.\n\nsince the refs are in the same repo as the change, you could try adding the deletion into the same BatchRefUpdate.",
      "parentUuid": "6dea445b_e7417488",
      "range": {
        "startLine": 1408,
        "startChar": 15,
        "endLine": 1408,
        "endChar": 23
      },
      "revId": "aae38d640c8bfc7c3d68a608afa73627b745a812",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9b206266_d4c37ace",
        "filename": "javatests/com/google/gerrit/acceptance/api/change/ChangeIT.java",
        "patchSetId": 3
      },
      "lineNbr": 4203,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2019-08-21T10:49:02Z",
      "side": 1,
      "message": "There\u0027s a similar method in RefAdvertisementIT.  Can that be extracted somewhere and reused instead of duplicating here?",
      "range": {
        "startLine": 4198,
        "startChar": 2,
        "endLine": 4203,
        "endChar": 3
      },
      "revId": "aae38d640c8bfc7c3d68a608afa73627b745a812",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "69116a97_51bb2ede",
        "filename": "javatests/com/google/gerrit/acceptance/api/change/ChangeIT.java",
        "patchSetId": 3
      },
      "lineNbr": 4203,
      "author": {
        "id": 1085183
      },
      "writtenOn": "2019-08-21T11:31:48Z",
      "side": 1,
      "message": "I could put the method in AbstractDaemonTest, do you think it\u0027s better?",
      "parentUuid": "9b206266_d4c37ace",
      "range": {
        "startLine": 4198,
        "startChar": 2,
        "endLine": 4203,
        "endChar": 3
      },
      "revId": "aae38d640c8bfc7c3d68a608afa73627b745a812",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}