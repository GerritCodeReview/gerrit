{
  "comments": [
    {
      "key": {
        "uuid": "7a993712_52734ddc",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/project/ProjectControl.java",
        "patchSetId": 8
      },
      "lineNbr": 615,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-04-26T12:55:11Z",
      "side": 1,
      "message": "This is a significant behavior change, which was fortunately caught by our smoke tests.\n\nIf you do BLOCK refs/heads/foo, then allRefsAreVisible returns false. This even applies for project owners, so callers that depend on allRefsAreVisible to bypass refs filtering would see *false*, entering the filtering codepath.\n\nLater in this series you make allRefsAreVisible private, and encourage callers to convert to \"project(project).can(READ)\". But because of this \"|| isOwner()\" clause, callers that depend on can(READ) to bypass refs filtering will now see *true*, bypassing filtering.",
      "range": {
        "startLine": 615,
        "startChar": 57,
        "endLine": 615,
        "endChar": 66
      },
      "revId": "abab3e99d969a2e877d054acae52afee8f295cca",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "44581657_222173c9",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/project/ProjectControl.java",
        "patchSetId": 8
      },
      "lineNbr": 615,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-04-26T12:57:57Z",
      "side": 1,
      "message": "tl;dr: it is now impossible to block a project owner from from seeing some refs.\n\nIf you strongly believe this new behavior is more correct, we can just fix the configuration of our tests. (Hopefully. Might not be easy, for reasons I\u0027ll explain in person.)",
      "parentUuid": "7a993712_52734ddc",
      "range": {
        "startLine": 615,
        "startChar": 57,
        "endLine": 615,
        "endChar": 66
      },
      "revId": "abab3e99d969a2e877d054acae52afee8f295cca",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d81ce2ca_a45590bf",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/project/ProjectControl.java",
        "patchSetId": 8
      },
      "lineNbr": 615,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-04-26T13:10:01Z",
      "side": 1,
      "message": "Here is a use case where this might matter. (Not commenting on whether it\u0027s realistic or important to preserve.)\n\n* Project B inherits from A\n* A has BLOCK Read refs/heads/foo for group X. Intention is that nobody in X can read refs/heads/foo anywhere, ever.\n* B has ALLOW Project Owner for group X.\n\nPrior to this change: members of group X can modify access controls in B, but because BLOCK takes precedence over DENY, nothing group X can do with their project ownership will grant them read access to refs/heads/foo.\n\nAfter this change: BLOCK in A has no effect for group X in B. Group X can always read all refs in B, i.e. user(memberOfX).project(B).can(READ) always returns true. There is literally no way to set an ACL entry for Read permission that will prevent X from reading any ref in B, i.e. there is no way user(memberOfX).project(B).can(READ) will ever return false.",
      "parentUuid": "44581657_222173c9",
      "range": {
        "startLine": 615,
        "startChar": 57,
        "endLine": 615,
        "endChar": 66
      },
      "revId": "abab3e99d969a2e877d054acae52afee8f295cca",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "90ae8699_bddeba4a",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/project/ProjectControl.java",
        "patchSetId": 8
      },
      "lineNbr": 615,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-04-26T13:14:32Z",
      "side": 1,
      "message": "\u003e Prior to this change: members of group X can modify access controls in B, but because BLOCK takes precedence over DENY\n\ns/DENY/ALLOW/\n\nIOW, a member of group X could try adding \"ALLOW Read refs/heads/foo\" to work around the restriction from the superproject, but it would have no effect, because that\u0027s the whole point of BLOCK.",
      "parentUuid": "d81ce2ca_a45590bf",
      "range": {
        "startLine": 615,
        "startChar": 57,
        "endLine": 615,
        "endChar": 66
      },
      "revId": "abab3e99d969a2e877d054acae52afee8f295cca",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aa4702f6_a0373009",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/project/ProjectControl.java",
        "patchSetId": 8
      },
      "lineNbr": 615,
      "author": {
        "id": 1001240
      },
      "writtenOn": "2017-04-26T14:11:34Z",
      "side": 1,
      "message": "Good catch. I sent I63097dda719ae6d1e0fb4916b8e548e0735f38a7 to remove this branch.",
      "revId": "abab3e99d969a2e877d054acae52afee8f295cca",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}