{
  "comments": [
    {
      "key": {
        "uuid": "7b610c89_dd69295d",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 14,
      "author": {
        "id": 1014252
      },
      "writtenOn": "2018-02-16T09:59:55Z",
      "side": 1,
      "message": "I\u0027m having a hard time comprehending how you can find the commit message misleading since it clearly states:\n\n    SSH commands: Set task name for ReviewCommand\n\n    Task name is otherwise set to the command line which in ReviewCommands\n    case can be a multi line string which leads to  pretty unreadable and\n    bordering on unparseable \"loglines\" like:\n\n    [2018-01-10 09:59:17,619] [SSH gerrit review 12345,4 --message \u0027Build:\n\n    http://jenkins.company.com/job/JOB_NAME/job/identifier/182/ : UNSTABLE\n\n    http://jenkins.company.com/job/JOB_NAME/job/other/13677/ : SUCCESS\u0027\\\n    --verified -1 --code-review 0 (jenkins)] WARN \u003cclass\u003e : \u003cmessage\u003e\n\nWherein would you say the contradiction lies? The subject, which is part of the subject of this commit, says exactly what the commit does.\nI would kindly ask you to remove these erroneous statements from the commit message.",
      "range": {
        "startLine": 12,
        "startChar": 15,
        "endLine": 14,
        "endChar": 8
      },
      "revId": "ac31d8b94c3c2b2953f74c35b3df48c61195a844",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e48a82c8_01b83e6b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 14,
      "author": {
        "id": 1060002
      },
      "writtenOn": "2018-02-16T15:08:58Z",
      "side": 1,
      "message": "Hello Sven: \n\nI am sorry for the confusion. I think the title of your commit message indicates that you were fixing the task name, however from the commit message body it looks like you were actually fixing the logs instead of task names because the \"loglines\" you were posting was actually the logs (from sshd_log file) and the original task name (from show-queue command) looked like this: \n\nTask     State        StartTime         Command\n------------------------------------------------------------------------------\nQueue: SSH-Interactive-Worker\n3ce351ff              09:25:40.823      gerrit review--project pg3 --message GMDC Tests started: UPC_EBT_DUS52\nJob links:\n_LRATKI/9431\n d7d689a0c0 (eztaobo)\n\nthat\u0027s why I think there is a contradiction where the message title and message body talk about different things. Can you please let me know if I am right or wrong? Thank you.",
      "parentUuid": "7b610c89_dd69295d",
      "range": {
        "startLine": 12,
        "startChar": 15,
        "endLine": 14,
        "endChar": 8
      },
      "revId": "ac31d8b94c3c2b2953f74c35b3df48c61195a844",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b9f000a5_e629a04a",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 14,
      "author": {
        "id": 1014252
      },
      "writtenOn": "2018-02-16T16:06:18Z",
      "side": 1,
      "message": "The reverted commit fixes the task name. Before the patch this could be multi-line due to the --message arg.\n\nBut since taskName in TaskThunk#run is used to name the thread:\n\n    thisThread.setName(\"SSH \" + taskName);\n\nwe now have a multi-line thread name.\n\nThe \"log-line\" that I pasted in the commit message is actually _not_ from sshd_log, it\u0027s from error_log:\n[timestamp] [thread name] log-level class : message.\n\nI did not change anything but the thread name, so I don\u0027t see how that would affect the sshd_log (where the thread-name is not used) or the show-queue command that doesn\u0027t contain the thread-name either. It could be that I\u0027m missing something, if that is the case please enlighten me.\n\nThe information that my patch removed was useful in fringe cases. For instance if the add-reviewer workflow failed somewhere and the cause was an ill-formatted \"gerrit review\" command (don\u0027t even know if that\u0027s possible). You lost the immediate traceability between a log line in the error_log and the arguments of the \"gerrit review\" command, and I fail to see when the loss of that immediate connection would be fatal. You can always compare the timestamps in the sshd_log and at least narrow it down to 2-3 review commands that could have been the instigator. That being said I fail to see how that would ever be useful.",
      "parentUuid": "e48a82c8_01b83e6b",
      "range": {
        "startLine": 12,
        "startChar": 15,
        "endLine": 14,
        "endChar": 8
      },
      "revId": "ac31d8b94c3c2b2953f74c35b3df48c61195a844",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c3214c28_100135de",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 14,
      "author": {
        "id": 1012987
      },
      "writtenOn": "2018-02-16T18:22:43Z",
      "side": 1,
      "message": "\u003e The reverted commit fixes the task name. Before the patch this\n \u003e could be multi-line due to the --message arg.\n \u003e \n \u003e But since taskName in TaskThunk#run is used to name the thread:\n \u003e \n \u003e thisThread.setName(\"SSH \" + taskName);\n \u003e \n \u003e we now have a multi-line thread name.\n \u003e \n \u003e The \"log-line\" that I pasted in the commit message is actually\n \u003e _not_ from sshd_log, it\u0027s from error_log:\n \u003e [timestamp] [thread name] log-level class : message.\n\nThat is where we were confused, we(Borui and I) thought that the intention was to fix sshd_log, not error_log. Now it\u0027s all clear.\n\n \u003e I did not change anything but the thread name, so I don\u0027t see how\n \u003e that would affect the sshd_log (where the thread-name is not used)\n \u003e or the show-queue command that doesn\u0027t contain the thread-name\n \u003e either. It could be that I\u0027m missing something, if that is the case\n \u003e please enlighten me.\n\nYou are right, it\u0027s not affecting the sshd_log but this change is also affecting the output of show-queue command in addition to the thread name in error_log. The taskName variable in TaskThunk class is also used in the toString() method which is used by show-queue command.\n\n \u003e \n \u003e The information that my patch removed was useful in fringe cases.\n \u003e For instance if the add-reviewer workflow failed somewhere and the\n \u003e cause was an ill-formatted \"gerrit review\" command (don\u0027t even know\n \u003e if that\u0027s possible). You lost the immediate traceability between a\n \u003e log line in the error_log and the arguments of the \"gerrit review\"\n \u003e command, and I fail to see when the loss of that immediate\n \u003e connection would be fatal. You can always compare the timestamps in\n \u003e the sshd_log and at least narrow it down to 2-3 review commands\n \u003e that could have been the instigator. That being said I fail to see\n \u003e how that would ever be useful.\n\nWe were not concerned at all by loosing the information in the error_log. We are concerned about loosing the info in the show-queue command. We use show-queue command to see what is going on on our servers. When there is a build up of tasks, we can quickly identify from the command column(taskname) of show-queue if the build up is for a specific change, project, type of task,... Setting the task name to \"gerrit review\" is removing the information about which change is being reviewed.\n\nThat is not a big deal but I would prefer to keep this information if possible. This is why we are proposing to revert this change and proposing one that will keep the command line as the task name and trim any multi line argument so we do not end up with a mutli line thread name in error_log or a multi line task name in output of show-queue.\n\nFor the sake of consistency, the proposed change is also fixing the command line in sshd_log to no span over multiple lines.",
      "parentUuid": "b9f000a5_e629a04a",
      "range": {
        "startLine": 12,
        "startChar": 15,
        "endLine": 14,
        "endChar": 8
      },
      "revId": "ac31d8b94c3c2b2953f74c35b3df48c61195a844",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "963678f8_6d5146fd",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 14,
      "author": {
        "id": 1014252
      },
      "writtenOn": "2018-02-20T09:39:29Z",
      "side": 1,
      "message": "Then I am sorry, I missed the link between taskName and show-queue completely.\n\nFor a follow up change:\nIs it fair to say that we still don\u0027t want to name the thread to the command and all it\u0027s argument since we seem to agree that this information is just cluttering the error_log?\nIs there any instance when the command is _not_ the first two \u0027sections\u0027 of the args string?\n\n    \"gerrit review ...\"\n    \"gerrit show-queue ...\"\n    etc.\n\nIf not we could do a \u0027non-intelligent\u0027 split of the args string and use the first two elements of the array as thread name.\n\nIf we cannot trust that this will be the case I would suggest that we do not revert this but instead only use the specific command override of taskDescriptiion when naming the thread, and still go for the \"truncate multi-line arguments\" approach in the follow-up commit for the sshd_log",
      "parentUuid": "c3214c28_100135de",
      "range": {
        "startLine": 12,
        "startChar": 15,
        "endLine": 14,
        "endChar": 8
      },
      "revId": "ac31d8b94c3c2b2953f74c35b3df48c61195a844",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "41130b22_3c6af52e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1014252
      },
      "writtenOn": "2018-02-16T09:59:55Z",
      "side": 1,
      "message": "I would not say that it \"hides\" information, it removes the data about which change,patchset is reviewed and which labels are being set and which message are being posted from the task-name.\nThis behavior is also not restricted to the show-queue command it is also true for the logs.",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 19,
        "endChar": 19
      },
      "revId": "ac31d8b94c3c2b2953f74c35b3df48c61195a844",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ca44b79a_b278aec3",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1060002
      },
      "writtenOn": "2018-02-16T15:08:58Z",
      "side": 1,
      "message": "From my site I ran some tests on your change. Basically I did the ssh review command and I opened the sshd_log file and show-queue to see the changes in the logs and task names respectively. It turned out that the task names were changed to \"gerrit review\" but the logs remained unchanged. Can you please let me know that did I miss anything or was there something wrong with my test?\n\nAnd yeah maybe it\u0027s not appropriate to use \"hide information\". I can rephrase this. Thank you.",
      "parentUuid": "41130b22_3c6af52e",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 19,
        "endChar": 19
      },
      "revId": "ac31d8b94c3c2b2953f74c35b3df48c61195a844",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e590fa49_2b7b92f4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1014252
      },
      "writtenOn": "2018-02-16T16:06:18Z",
      "side": 1,
      "message": "As I clarified in my other comment, the patch did not affect the sshd_log, it was fixing the fact that a multi-line thread-name was logged in error_log.",
      "parentUuid": "ca44b79a_b278aec3",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 19,
        "endChar": 19
      },
      "revId": "ac31d8b94c3c2b2953f74c35b3df48c61195a844",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}