{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "0229c107_fb4ec225",
        "filename": "java/com/google/gerrit/server/project/CreateRefControl.java",
        "patchSetId": 3
      },
      "lineNbr": 90,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2022-06-30T00:24:27Z",
      "side": 1,
      "message": "Why would having UDPATE be acceptable too? Is that a pattern used elsewhere?",
      "range": {
        "startLine": 90,
        "startChar": 56,
        "endLine": 90,
        "endChar": 96
      },
      "revId": "acbca1861868d6bb380802fc342101ecb6a9d6bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ea35398a_96515c41",
        "filename": "java/com/google/gerrit/server/project/CreateRefControl.java",
        "patchSetId": 3
      },
      "lineNbr": 90,
      "author": {
        "id": 1096442
      },
      "writtenOn": "2022-06-30T11:21:06Z",
      "side": 1,
      "message": "Observed on line 155, we are returning if the user can UPDATE without checking for READ.",
      "parentUuid": "0229c107_fb4ec225",
      "range": {
        "startLine": 90,
        "startChar": 56,
        "endLine": 90,
        "endChar": 96
      },
      "revId": "acbca1861868d6bb380802fc342101ecb6a9d6bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "513367c3_df2fc701",
        "filename": "java/com/google/gerrit/server/project/CreateRefControl.java",
        "patchSetId": 3
      },
      "lineNbr": 90,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2022-06-30T14:27:48Z",
      "side": 1,
      "message": "\u003e Observed on line 155, we are returning if the user can UPDATE without checking for READ.\n\nThat\u0027s for the destBranch ref, not the source, and has to do with the user including new commits. It\u0027s a shortcut around seeing if we need to validate the new commit. See the comment on lines 166-169.",
      "parentUuid": "ea35398a_96515c41",
      "range": {
        "startLine": 90,
        "startChar": 56,
        "endLine": 90,
        "endChar": 96
      },
      "revId": "acbca1861868d6bb380802fc342101ecb6a9d6bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "144ade29_f18b9aa4",
        "filename": "java/com/google/gerrit/server/project/CreateRefControl.java",
        "patchSetId": 3
      },
      "lineNbr": 90,
      "author": {
        "id": 1096442
      },
      "writtenOn": "2022-06-30T15:14:14Z",
      "side": 1,
      "message": "ok. listBranches_branchVisiblityIsRespected test in gitiles plugin is failing without the additional check. Test is trying to create a branch with those permissions [1], and expects to create branch visible and invisible. Is that wrong assumption?\n\n\n[1]\n\n  projectOperations\n        .project(project)\n        .forUpdate()\n        .add(allow(Permission.READ).ref(\"refs/heads/visible\").group(ANONYMOUS_USERS))\n        .add(allow(Permission.CREATE).ref(\"refs/*\").group(ANONYMOUS_USERS))\n        .add(allow(Permission.PUSH).ref(\"refs/*\").group(ANONYMOUS_USERS))\n        .update();\n    gApi.projects().name(project.get()).branch(\"refs/heads/visible\").create(new BranchInput());\n    gApi.projects().name(project.get()).branch(\"refs/heads/invisible\").create(new BranchInput());",
      "parentUuid": "513367c3_df2fc701",
      "range": {
        "startLine": 90,
        "startChar": 56,
        "endLine": 90,
        "endChar": 96
      },
      "revId": "acbca1861868d6bb380802fc342101ecb6a9d6bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "596e2f1d_b7f6512d",
        "filename": "java/com/google/gerrit/server/project/CreateRefControl.java",
        "patchSetId": 3
      },
      "lineNbr": 90,
      "author": {
        "id": 1096442
      },
      "writtenOn": "2022-07-04T11:41:49Z",
      "side": 1,
      "message": "Removed the additional check on PUSH as discussed.",
      "parentUuid": "144ade29_f18b9aa4",
      "range": {
        "startLine": 90,
        "startChar": 56,
        "endLine": 90,
        "endChar": 96
      },
      "revId": "acbca1861868d6bb380802fc342101ecb6a9d6bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dcfdd850_805a3681",
        "filename": "java/com/google/gerrit/server/project/CreateRefControl.java",
        "patchSetId": 3
      },
      "lineNbr": 97,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2022-06-30T00:24:27Z",
      "side": 1,
      "message": "It doesn\u0027t make sense that I need \"READ\" to create a new ref. Did you mean something like \"Must have READ on existing ref to create new ref from it\"?",
      "range": {
        "startLine": 97,
        "startChar": 24,
        "endLine": 97,
        "endChar": 44
      },
      "revId": "acbca1861868d6bb380802fc342101ecb6a9d6bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4b88892e_af27f3ac",
        "filename": "java/com/google/gerrit/server/project/CreateRefControl.java",
        "patchSetId": 3
      },
      "lineNbr": 97,
      "author": {
        "id": 1096442
      },
      "writtenOn": "2022-06-30T11:21:06Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "dcfdd850_805a3681",
      "range": {
        "startLine": 97,
        "startChar": 24,
        "endLine": 97,
        "endChar": 44
      },
      "revId": "acbca1861868d6bb380802fc342101ecb6a9d6bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "00762c7d_28010ee8",
        "filename": "java/com/google/gerrit/server/project/CreateRefControl.java",
        "patchSetId": 3
      },
      "lineNbr": 101,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2022-06-30T00:24:27Z",
      "side": 1,
      "message": "If you say \"an existing ref\" then it\u0027s ambiguous if the ref they tried to use is not visible or doesn\u0027t exist, which is the behavior we want for visibility.",
      "range": {
        "startLine": 101,
        "startChar": 21,
        "endLine": 101,
        "endChar": 26
      },
      "revId": "acbca1861868d6bb380802fc342101ecb6a9d6bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9206cd02_df12666a",
        "filename": "java/com/google/gerrit/server/project/CreateRefControl.java",
        "patchSetId": 3
      },
      "lineNbr": 101,
      "author": {
        "id": 1096442
      },
      "writtenOn": "2022-06-30T11:21:06Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "00762c7d_28010ee8",
      "range": {
        "startLine": 101,
        "startChar": 21,
        "endLine": 101,
        "endChar": 26
      },
      "revId": "acbca1861868d6bb380802fc342101ecb6a9d6bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5934d928_141f3dee",
        "filename": "java/com/google/gerrit/server/restapi/project/CreateBranch.java",
        "patchSetId": 3
      },
      "lineNbr": 133,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2022-06-30T00:24:27Z",
      "side": 1,
      "message": "Do we care to search for it or can we use exactRef()? I feel like if we\u0027re going for optimization, using exactRef() makes more sense.",
      "range": {
        "startLine": 133,
        "startChar": 27,
        "endLine": 133,
        "endChar": 34
      },
      "revId": "acbca1861868d6bb380802fc342101ecb6a9d6bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e6697b12_5ba3cacf",
        "filename": "java/com/google/gerrit/server/restapi/project/CreateBranch.java",
        "patchSetId": 3
      },
      "lineNbr": 133,
      "author": {
        "id": 1096442
      },
      "writtenOn": "2022-06-30T11:21:06Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5934d928_141f3dee",
      "range": {
        "startLine": 133,
        "startChar": 27,
        "endLine": 133,
        "endChar": 34
      },
      "revId": "acbca1861868d6bb380802fc342101ecb6a9d6bf",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}