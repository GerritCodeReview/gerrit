{
  "comments": [
    {
      "key": {
        "uuid": "cad4668d_b877f902",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 27,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2020-07-14T07:07:10Z",
      "side": 1,
      "message": "This sounds to me like it was only ever a preflight check. Is the eca plugin auto-submitting at the end of the push? Why is it not OK to create a change that the uploader can\u0027t submit (but someone else might)?\n\nThe refactoring happened over 3 years ago, and no one complained until now, so I am trying to understand the use case fully.\n\nChecking \"Submit\" on a ref feels unidiomatic because you can\u0027t submit a ref, you can only submit a change. If we have to we could name it SUBMIT_TO, so that you can check if a user can \"submit to\" a ref.",
      "range": {
        "startLine": 21,
        "startChar": 0,
        "endLine": 27,
        "endChar": 0
      },
      "revId": "b4481420d4a629b0303aa89aaf60a856f4254f80",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6ff415cc_3d16106b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 27,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-07-14T07:48:25Z",
      "side": 1,
      "message": "The plugin source code is here: [1]. And my wrong migration to permission backend is here: [2].\n\n\u003e Why is it not OK to create a change that the uploader can\u0027t submit (but someone else might)?\n\nHave you noticed the javadoc?\n\n  /**\n   * Can submit changes for this ref.\n   *\n   * \u003cp\u003eThis is the same as {@link ChangePermission#SUBMIT} except that it can be used without\n   * having a change instance. This could be useful when checking for submit permission in a {@link\n   * CommitValidationListener} implementation to perform or skip additional tests.\n   */\n\nThe use case is simple. Two contributors Bob and Alice are uploading a change to project Foo. Bob must sign CLA and include \"Signed-off-by\" otherwise the push will be rejected. Alice must not sign CLA and include \"Signed-off-by\" footer, because she is committer of the project Foo. To determine that Alice is committer and Bob is not a committer of the project Foo, SUBMIT permission is checked. \n\n \u003e The refactoring happened over 3 years ago, and no one complained until now, so I am trying to understand the use case fully.\n\nIt took years to migrate Eclipse Foundation\u0027s Gerrit site from 2.14 release to 3.x: [3].\n\n\u003e If we have to we could name it SUBMIT_TO, so that you can check if a user can \"submit to\" a ref.\n\nI have no problem to rename RefPermission.SUBMIT to RefPermission.SUBMIT_TO.\n\n[1] https://github.com/EclipseFdn/gerrit-eca-plugin\n[2] https://github.com/EclipseFdn/gerrit-eca-plugin/pull/16\n[3] https://bugs.eclipse.org/bugs/show_bug.cgi?id\u003d541221",
      "parentUuid": "cad4668d_b877f902",
      "range": {
        "startLine": 21,
        "startChar": 0,
        "endLine": 27,
        "endChar": 0
      },
      "revId": "b4481420d4a629b0303aa89aaf60a856f4254f80",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ae67c447_92fc5aa0",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 27,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2020-07-14T12:50:01Z",
      "side": 1,
      "message": "\u003e To determine that Alice is committer and Bob is not a committer of the project Foo, SUBMIT permission is checked. \n\nSo if I have \"submit\" permission, I am a committer (no CLA) and if not a contributor (needs CLA) and you need this for gating the CLA check. Is there another link between \"committer\" and a permission you could check instead? E.g. are committers project owners? (WRITE_CONFIG is granted).\n\nCould you make a simple group membership check instead?\nif (uploader is member of \"submitter group\") {\n  // don\u0027t check CLA\n} {\n  //check CLA\n}\n\nIn other words I am trying to understand where the ground truth of \"who is a committer\" is stored. Usually it\u0027s group membership, not a permission that distinguishes such users.\n\nHave you considered adding \"committers\" to the autoVerify group of the CLA? This makes the CLA check pass without them having to sign it.\n\n[1] https://github.com/EclipseFdn/gerrit-eca-plugin",
      "parentUuid": "6ff415cc_3d16106b",
      "range": {
        "startLine": 21,
        "startChar": 0,
        "endLine": 27,
        "endChar": 0
      },
      "revId": "b4481420d4a629b0303aa89aaf60a856f4254f80",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f3d1a9e4_476398d3",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 27,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2020-07-14T12:52:16Z",
      "side": 1,
      "message": "The docs say \"An individual is assumed to be a committer if they have PUSH access to the Gerrit project (repository).\"\n\nIf so, I really think these users should be organized in a (Gerrit) group that is then leveraged as autoVerify/accepted in the CLA.",
      "parentUuid": "ae67c447_92fc5aa0",
      "range": {
        "startLine": 21,
        "startChar": 0,
        "endLine": 27,
        "endChar": 0
      },
      "revId": "b4481420d4a629b0303aa89aaf60a856f4254f80",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f23d4067_e1f5e067",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 27,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-07-14T13:01:14Z",
      "side": 1,
      "message": "\u003e E.g. are committers project owners? (WRITE_CONFIG is granted).\n\nI am not author of this plugin, and I don\u0027t know what actualy the intention is. In fact, I considered exactly this check WRITE_CONFIG instead of checking SUBMIT permission on \"refs/heads/*\", and even uploaded this PR: [1], that I however abandoned, as it is semantical change \"compared\" to plugin implementation in 2.14 branch.\n\nNote, that I am not involved in development or infrastructure team of Eclipse Foundation. I am just a seasoned contributor, and trynig to unblock their installation being inherently broken after migration to 3.x because working feature was lost during refactoring.\n\nWhatever fancy suggestion we can come up with, it doesn\u0027t change the fact the Gerrit project did incompatible change during migration to permission backend.\n\nI\u0027m going to comment on their issue and the option we have.\n\nI still think that this is non-invasiv change and could be release ASAP and if needed reverted later, after they have migrated to a better approach of detecting  submitter role.\n\n[1] https://github.com/EclipseFdn/gerrit-eca-plugin/pull/19",
      "parentUuid": "f3d1a9e4_476398d3",
      "range": {
        "startLine": 21,
        "startChar": 0,
        "endLine": 27,
        "endChar": 0
      },
      "revId": "b4481420d4a629b0303aa89aaf60a856f4254f80",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "581e6f13_194b784a",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 27,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2020-07-14T13:02:42Z",
      "side": 1,
      "message": "At Eclipse permissions are managed centrally by Gerrit administrators.\nCommitters don\u0027t have the owner privilege on their repositories.\n\nEach Eclipse project using Gerrit has a permission-only project granting committer permissions to an ldap group having project committers as members. \nE.g. for jgit this group is named ldap/technology.jgit. \"technology\" is the top level project above \"jgit\" in the Eclipse project hierarchy.\nAll repositories of a project inherit permissions from that permission-only project.\n\nThe CLA check is implemented externally and the eca-plugin davido mentioned calls an external service to check if a user has signed the CLA.",
      "parentUuid": "f3d1a9e4_476398d3",
      "range": {
        "startLine": 21,
        "startChar": 0,
        "endLine": 27,
        "endChar": 0
      },
      "revId": "b4481420d4a629b0303aa89aaf60a856f4254f80",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1a7efa76_b1ccf43c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 27,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-07-14T13:25:19Z",
      "side": 1,
      "message": "\u003e I\u0027m going to comment on their issue and the option we have.\n\nhttps://bugs.eclipse.org/bugs/show_bug.cgi?id\u003d564939#c23",
      "parentUuid": "581e6f13_194b784a",
      "range": {
        "startLine": 21,
        "startChar": 0,
        "endLine": 27,
        "endChar": 0
      },
      "revId": "b4481420d4a629b0303aa89aaf60a856f4254f80",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6ca4b400_4b54fb9a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-07-15T06:29:59Z",
      "side": 1,
      "message": "There is ongoing discussion on the upstream issue linked to this CL, so that we should wait with the review process here.",
      "revId": "b4481420d4a629b0303aa89aaf60a856f4254f80",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "29fde9e5_29ec75d5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2020-07-15T10:49:07Z",
      "side": 1,
      "message": "Ok. Removing myself from the attention set for now. Let me know when you want to continue.",
      "parentUuid": "6ca4b400_4b54fb9a",
      "revId": "b4481420d4a629b0303aa89aaf60a856f4254f80",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a46617da_0986a0b1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-07-28T09:09:41Z",
      "side": 1,
      "message": "The decision upstream was to refactor the plugin and not to require to differentiate \nthe plugin behaviour based on whether or not uploader was granted submit permission.",
      "revId": "b4481420d4a629b0303aa89aaf60a856f4254f80",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "76192014_78c18249",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2020-07-28T11:37:56Z",
      "side": 1,
      "message": "Thank you for following up on this, David!",
      "revId": "b4481420d4a629b0303aa89aaf60a856f4254f80",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}