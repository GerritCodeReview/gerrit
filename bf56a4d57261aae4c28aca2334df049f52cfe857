{
  "pushCert": "certificate version 0.1\npusher Dave Borowitz \u003cdborowitz@google.com\u003e 1489611834 -0400\npushee rpc://gerrit/gerrit\nnonce AIcUUg8I1vFWp5pS2lwR6rW2JWbQNEz6uZHtxziHHsinUSqytjl6XztWQd/5/J3BykvxvG1kD4CU\n\n0000000000000000000000000000000000000000 bf56a4d57261aae4c28aca2334df049f52cfe857 refs/for/master\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQIcBAABAgAGBQJYyaw6AAoJEF/XxZqaEoiMsbAQANh6DMFoOLGW4+3jGjehsX/k\n79lQ35+tm2sanKzW526GXp+LJ/ARepmT7QGvf/zQfAwa1wJt//v1+rl3NBa2iSsb\niO8KGNBV0N4ta0j/uN3dL1eVxBANib9L8znIxTu1VcoDZIsGS0co31ZUrc+qd1Mt\nZMXkVJf4Ph5i9hIqdZPndwn9bxXpeZr6pbikHuHoEafLcJKYu5fFJWGPkTF16d8e\nKxcslmQmnLZipZ2c10g+/+SVKJxOUbSZ94pG1DpiukSaqFsES3ppOmAQKtCtFga8\nMPaNrkc6BDMX0EjfcnpRYnYkPNhBjl9eSYfuQ89FvroNvSTabgg5pQvMTj8LNrw1\nEMPYhCZMd0YwnVxEyBBIYjlRIeT0x1pSWskAo8O3EPlaal9Z3koQQbYnXFyvK2Bt\nYmjdleynh3MY9InOpiDbxtIoDMD6M5chS/zGNHoR8hYIiU0+5Kr4Uqb922jcO24V\nhN8orlFKOLLBm+mDBk8eqeAeV0Cb5AtY//IzDwoSW8UDBBMplpQciVQHo934e8If\n8WQny+yETVTm9SppAgQ9vjF/W4M+oNSYP1f/gGTnQYURMdamDpS9dtOVFRPlBpp/\nM3+vEnAXassUA0ntISwYG6Fl2Ml6xFG+1ua87s8EUaEdmivabCIWTEkGrd4PaYE1\nfAc/Qx7arPAwfiPB6p8X\n\u003dLVRg\n-----END PGP SIGNATURE-----\n",
  "comments": [
    {
      "key": {
        "uuid": "2ceef1ec_89ee0880",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NoteDbUpdateManager.java",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-03-15T23:36:45Z",
      "side": 1,
      "message": "We still want to throw IOException if a later command failed for a different reason.",
      "tag": "mailMessageId\u003d\u003cCAD0k6qT0DgDceOqX0EtaTsW4moaVZ1S62h9CaCAo6AH4jSOe0Q@mail.gmail.com\u003e",
      "revId": "bf56a4d57261aae4c28aca2334df049f52cfe857",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "803474c5_415d4796",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NoteDbUpdateManager.java",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-03-16T12:43:47Z",
      "side": 1,
      "message": "I meant for this to be an inline comment, filed issue 5794",
      "parentUuid": "2ceef1ec_89ee0880",
      "revId": "bf56a4d57261aae4c28aca2334df049f52cfe857",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dcff195f_5664956d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NoteDbUpdateManager.java",
        "patchSetId": 1
      },
      "lineNbr": 485,
      "author": {
        "id": 1019407
      },
      "writtenOn": "2017-03-16T00:28:58Z",
      "side": 1,
      "message": "nit: Why \"continue\" here and \"break\" two lines down?",
      "range": {
        "startLine": 485,
        "startChar": 10,
        "endLine": 485,
        "endChar": 18
      },
      "revId": "bf56a4d57261aae4c28aca2334df049f52cfe857",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "44f734a3_8d1417b1",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NoteDbUpdateManager.java",
        "patchSetId": 1
      },
      "lineNbr": 485,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2017-03-16T00:32:42Z",
      "side": 1,
      "message": "If this one is OK we still want to continue checking if any of the others failed, but on any failure we want to exit the loop immediately.",
      "parentUuid": "dcff195f_5664956d",
      "range": {
        "startLine": 485,
        "startChar": 10,
        "endLine": 485,
        "endChar": 18
      },
      "revId": "bf56a4d57261aae4c28aca2334df049f52cfe857",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7b9c2d3c_41c91558",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NoteDbUpdateManager.java",
        "patchSetId": 1
      },
      "lineNbr": 485,
      "author": {
        "id": 1011842
      },
      "writtenOn": "2017-03-16T00:37:43Z",
      "side": 1,
      "message": "Does that work? I\u0027d expect the \"break\" to break from the switch instead of the loop.",
      "parentUuid": "44f734a3_8d1417b1",
      "range": {
        "startLine": 485,
        "startChar": 10,
        "endLine": 485,
        "endChar": 18
      },
      "revId": "bf56a4d57261aae4c28aca2334df049f52cfe857",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "82aaeb7d_09c5929f",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NoteDbUpdateManager.java",
        "patchSetId": 1
      },
      "lineNbr": 485,
      "author": {
        "id": 1011842
      },
      "writtenOn": "2017-03-16T00:42:50Z",
      "side": 1,
      "message": "In other words, agreed with Terry that \"continue\" in the next one would be clearer.",
      "parentUuid": "7b9c2d3c_41c91558",
      "range": {
        "startLine": 485,
        "startChar": 10,
        "endLine": 485,
        "endChar": 18
      },
      "revId": "bf56a4d57261aae4c28aca2334df049f52cfe857",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7b990f34_fcf00853",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NoteDbUpdateManager.java",
        "patchSetId": 1
      },
      "lineNbr": 485,
      "author": {
        "id": 1019407
      },
      "writtenOn": "2017-03-16T00:57:41Z",
      "side": 1,
      "message": "The for loop contains a single switch statement--the if(lockFailure) is outside the loop. Functionally \"break\" and \"continue\" are equivalent here--the break should be applying to the scope of the switch statement. Having them be different indicates they should be doing different things but they aren\u0027t.",
      "parentUuid": "82aaeb7d_09c5929f",
      "range": {
        "startLine": 485,
        "startChar": 10,
        "endLine": 485,
        "endChar": 18
      },
      "revId": "bf56a4d57261aae4c28aca2334df049f52cfe857",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3aeedbb9_c88f2b60",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NoteDbUpdateManager.java",
        "patchSetId": 1
      },
      "lineNbr": 485,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-03-16T12:43:47Z",
      "side": 1,
      "message": "Wow, I never expected this to generate such contentious debate. Clearly a switch statement inside a loop did not improve readability, I will go back to the if/else I had before.",
      "parentUuid": "7b990f34_fcf00853",
      "range": {
        "startLine": 485,
        "startChar": 10,
        "endLine": 485,
        "endChar": 18
      },
      "revId": "bf56a4d57261aae4c28aca2334df049f52cfe857",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "44c6606f_6303cee4",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/notedb/NoteDbUpdateManager.java",
        "patchSetId": 1
      },
      "lineNbr": 488,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2017-03-15T23:26:14Z",
      "side": 1,
      "message": "Why not throw the LockFailureException here?",
      "range": {
        "startLine": 487,
        "startChar": 10,
        "endLine": 488,
        "endChar": 16
      },
      "revId": "bf56a4d57261aae4c28aca2334df049f52cfe857",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e440367b_77c5742f",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/ReviewDbBatchUpdate.java",
        "patchSetId": 1
      },
      "lineNbr": 638,
      "author": {
        "id": 1011842
      },
      "writtenOn": "2017-03-16T00:42:50Z",
      "side": 1,
      "message": "nit: Can this happen as a separate \u0027catch\u0027 instead of instanceof? One way to do that would be to put that in a nested \u0027try\u0027:\n\n try {\n   try {\n     ...\n   } catch (LockFailureException e) {\n     // LOCK_FAILURE is ....\n     throw new ResourceConflictException(...)\n   }\n } catch (IOException e) {\n    if (allReviewDbPrimary) {\n      ...\n\nThat would allow narrowing the scope of the \u0027try\u0027 that catches LockFailureException.",
      "revId": "bf56a4d57261aae4c28aca2334df049f52cfe857",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dded5528_ce8636cb",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/ReviewDbBatchUpdate.java",
        "patchSetId": 1
      },
      "lineNbr": 638,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-03-16T12:43:47Z",
      "side": 1,
      "message": "Then we would have to duplicate the allMatch(REVIEW_DB) logic in that other catch block. Even factoring out a method for that, I don\u0027t think it\u0027s a win.\n\nCan reduce a level of nesting here, though.",
      "parentUuid": "e440367b_77c5742f",
      "revId": "bf56a4d57261aae4c28aca2334df049f52cfe857",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2d46e4c5_f245c7dd",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/update/ReviewDbBatchUpdate.java",
        "patchSetId": 1
      },
      "lineNbr": 638,
      "author": {
        "id": 1011842
      },
      "writtenOn": "2017-03-16T17:31:11Z",
      "side": 1,
      "message": "That duplication could be avoided by nesting the \u0027try\u0027s, as I suggested.\n\nThat said, what you have here is fine. Once PrimaryStorage.REVIEW_DB is eliminated, the complexity will go away.",
      "parentUuid": "dded5528_ce8636cb",
      "revId": "bf56a4d57261aae4c28aca2334df049f52cfe857",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}