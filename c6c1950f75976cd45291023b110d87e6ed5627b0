{
  "comments": [
    {
      "key": {
        "uuid": "a4ef7afe_10cc6472",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/edit/ChangeEditModifier.java",
        "patchSetId": 1
      },
      "lineNbr": 130,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-12-12T09:17:47Z",
      "side": 1,
      "message": "This is not equivalent replacement and is not sufficient with new ref scheme. The base revision was encoded in old ref name:\n\n  refs/users/UU/UUUU/edit-CCCC/P\n\nWith new approach other means needed not to lose this information. This must be respected in all change edit operations that touch refs: create, delete and rebase change edit.",
      "range": {
        "startLine": 130,
        "startChar": 8,
        "endLine": 130,
        "endChar": 68
      },
      "revId": "c6c1950f75976cd45291023b110d87e6ed5627b0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e4e5f21c_d22ee47d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/edit/ChangeEditUtil.java",
        "patchSetId": 1
      },
      "lineNbr": 101,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-12-12T09:17:47Z",
      "side": 1,
      "message": "This is backward incompatible change. Even though we haven\u0027t (officially) released any Gerrit versions with inline edit feature enabled yet, some sites in the wild (most notably *.googlsource.com) rely on the bleeding edge and are affected by this change and would incur total data lost, after Gerrit site was upgraded to new version that contains this change. If this is intended, a big warning must be added in the commit message. If not, refs migration is needed, or this change must be backwards compatible: e. g. reading from old ref scheme combined with deleting and writing to new scheme.",
      "range": {
        "startLine": 97,
        "startChar": 6,
        "endLine": 101,
        "endChar": 7
      },
      "revId": "c6c1950f75976cd45291023b110d87e6ed5627b0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "84bfd6dd_f70200fe",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/edit/ChangeEditUtil.java",
        "patchSetId": 1
      },
      "lineNbr": 182,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2014-12-12T03:01:53Z",
      "side": 1,
      "message": "Getting a 500 internal server error from this line when saving a change edit from the UI\n\n ERROR com.google.gerrit.httpd.restapi.RestApiServlet : Error in PUT /changes/113/edit/FF\n java.lang.NumberFormatException: For input string: \"1000000-113\"\n \tat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n \tat java.lang.Integer.parseInt(Integer.java:492)\n \tat java.lang.Integer.valueOf(Integer.java:582)\n \tat com.google.gerrit.server.edit.ChangeEditUtil.getBasePatchSet(ChangeEditUtil.java:182)\n \tat com.google.gerrit.server.edit.ChangeEditUtil.byChange(ChangeEditUtil.java:106)\n \tat com.google.gerrit.server.change.ChangeEdits$Create.createEdit(ChangeEdits.java:191)\n \tat com.google.gerrit.server.change.ChangeEdits$Create.apply(ChangeEdits.java:179)\n \tat com.google.gerrit.server.change.ChangeEdits$Create.apply(ChangeEdits.java:1)",
      "range": {
        "startLine": 181,
        "startChar": 0,
        "endLine": 182,
        "endChar": 50
      },
      "revId": "c6c1950f75976cd45291023b110d87e6ed5627b0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "84bfd6dd_7717103d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/edit/ChangeEditUtil.java",
        "patchSetId": 1
      },
      "lineNbr": 182,
      "author": {
        "id": 1001240
      },
      "writtenOn": "2014-12-12T03:51:19Z",
      "side": 1,
      "message": "I know. To use this naming scheme I actually need two refs, e.g.:\n\n  refs/draft-edits/51/10051-1234\n  refs/draft-edits/51/10051-1234.base\n\nI don\u0027t like the idea of having the base patch set encoded in the ref, as it means the user can have two edits open against different patch sets at the same time. That is an error and shouldn\u0027t be allowed.\n\nUsing fixed names per change prevents that, but we lose information and need the second ref to store the SHA-1 of the \"base\" of this edit. That base is necessary to perform a rebase of your edit onto a future patch set supplied by someone else.",
      "parentUuid": "84bfd6dd_f70200fe",
      "range": {
        "startLine": 181,
        "startChar": 0,
        "endLine": 182,
        "endChar": 50
      },
      "revId": "c6c1950f75976cd45291023b110d87e6ed5627b0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "44d15e3e_d5c13c62",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/edit/ChangeEditUtil.java",
        "patchSetId": 1
      },
      "lineNbr": 182,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2014-12-12T04:40:49Z",
      "side": 1,
      "message": "I\u0027m also getting a few \"GC overhead limit exceeded\" errors in the acceptance tests, but I\u0027m not sure if those are related.",
      "parentUuid": "84bfd6dd_7717103d",
      "range": {
        "startLine": 181,
        "startChar": 0,
        "endLine": 182,
        "endChar": 50
      },
      "revId": "c6c1950f75976cd45291023b110d87e6ed5627b0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e4e5f21c_b29da078",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/edit/ChangeEditUtil.java",
        "patchSetId": 1
      },
      "lineNbr": 182,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-12-12T07:03:55Z",
      "side": 1,
      "message": "| That base is necessary to perform a rebase of your edit onto a future patch set supplied by someone else.\n\nAnother use case where we need the base is to sort the edit in the right place into the list of patch sets on the client side:\n\n  1 2 3 4 edit 5\n\nTo be able to do that we have to know that 4 is the base patch set of the edit.",
      "parentUuid": "84bfd6dd_7717103d",
      "range": {
        "startLine": 181,
        "startChar": 0,
        "endLine": 182,
        "endChar": 50
      },
      "revId": "c6c1950f75976cd45291023b110d87e6ed5627b0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e4e5f21c_723e18af",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/edit/ChangeEditUtil.java",
        "patchSetId": 1
      },
      "lineNbr": 182,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-12-12T09:17:47Z",
      "side": 1,
      "message": "I wonder if splitting this change in two would be less error-prone and easier to follow for reviewers:\n\n* 1. change: don\u0027t hard code base patch set in change edit ref: i. e. split refs/users/UU/UUUU/edit-CCCC/P to refs/users/UU/UUUU/edit-CCCC and refs/users/UU/UUUU/edit-CCCC.base (or similar)\n* 2. change: move ref scheme from to refs/users/UU/UUUU/edit-CCCC* to refs/draft-edits/51/10051-1234*",
      "parentUuid": "84bfd6dd_7717103d",
      "range": {
        "startLine": 181,
        "startChar": 0,
        "endLine": 182,
        "endChar": 50
      },
      "revId": "c6c1950f75976cd45291023b110d87e6ed5627b0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}