{
  "pushCert": "certificate version 0.1\npusher A0D0EF51 1503055595 +0200\nnonce AHIDc+N1jRIAzUj6rh1W6SKFf8g9ofs2o8IQhcDcsRTyWOLWzo+msd1hhg9gbuw/TarnUuudxYpO\n\n0000000000000000000000000000000000000000 c9fe3d20f8aee30007f08274b9ab62d6bc735d09 refs/for/master\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQEcBAABAgAGBQJZls7sAAoJEFG1/Zeg0O9RCeMIAJpfhPkqzXmi/ppqvufZcMp5\n7H7L6XB0qDnSRNpIHSHoiV28aqzc4xkwe2m9MpYR6fX9Q59llyKMS8Cs9PbwguvA\nDdJwOrFEp75s9dRCfAjWHZJw8f/vaCB0tnYMz3B6LTdu2Vwjcu+c+dHHnx0YUUOX\nGqqMn+ATMQcZBZPz6aFCUlbCqVhz6mDNkjWIZi1todZx88C3ZgnEGQoEXmEje1wH\nxLdfE9ipqJQaFowf4hdOGr5q5CSqHe2SIT/x3xiTcQk6BZZN7GCphLFSKwwAT7+c\neQiLsmTUXm/l+2DC676UztT1TvMlYVb/0ofikhtZb1qfzs4+v5okKshTKyE4UUk\u003d\n\u003dIqE7\n-----END PGP SIGNATURE-----\n",
  "comments": [
    {
      "key": {
        "uuid": "bebf0cbc_40db1e5c",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git/AbstractPushForReview.java",
        "patchSetId": 1
      },
      "lineNbr": 190,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-08-18T13:19:08Z",
      "side": 1,
      "message": "Do we want a test that pushing an initial commit for anything other than master and refs/meta/config fails?",
      "revId": "c9fe3d20f8aee30007f08274b9ab62d6bc735d09",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d1a5d88e_fd2d16e5",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git/AbstractPushForReview.java",
        "patchSetId": 1
      },
      "lineNbr": 190,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2017-08-18T13:30:35Z",
      "side": 1,
      "message": "Makes sense, I can add such a test.",
      "parentUuid": "bebf0cbc_40db1e5c",
      "revId": "c9fe3d20f8aee30007f08274b9ab62d6bc735d09",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "37061687_b7748a47",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git/AbstractPushForReview.java",
        "patchSetId": 1
      },
      "lineNbr": 190,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2017-08-18T13:56:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d1a5d88e_fd2d16e5",
      "revId": "c9fe3d20f8aee30007f08274b9ab62d6bc735d09",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "909ab67a_25629fb2",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/MergeOpRepoManager.java",
        "patchSetId": 1
      },
      "lineNbr": 139,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-08-18T13:19:08Z",
      "side": 1,
      "message": "getFullBranch() returns the name of the branch to which HEAD is pointing. So, without seeing this change, I would assume in a config-only repo, HEAD would be pointing at refs/meta/config even if refs/meta/config doesn\u0027t exist.\n\nBut, the fact that you had to write this change suggests my assumption is incorrect. I guess the only way to get HEAD pointing at refs/meta/config is to set ProjectInput.permissionsOnly, at which point it\u0027s also going to create the refs/meta/config branch.\n\nSo, is this the use case we\u0027re concerned about: someone running \"git init --bare $site/git/parentproject.git\", where they *plan* to make it config-only, but HEAD doesn\u0027t (yet) point at refs/meta/config?\n\nIf I\u0027m following correctly, then I think special-casing REFS_CONFIG here is the right way to go.",
      "range": {
        "startLine": 139,
        "startChar": 34,
        "endLine": 139,
        "endChar": 57
      },
      "revId": "c9fe3d20f8aee30007f08274b9ab62d6bc735d09",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5983df6c_a3182c54",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/MergeOpRepoManager.java",
        "patchSetId": 1
      },
      "lineNbr": 139,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2017-08-18T13:30:35Z",
      "side": 1,
      "message": "For permission-only projects (isn\u0027t this the same as config-only repo?) HEAD points to refs/meta/config. Hence for such projects pushing an initial commit for review to refs/meta/config already works today.\n\nThis change is trying to fix the case where you have a normal project where HEAD points to master and the refs/meta/config branch is missing. In this case at the moment you can\u0027t push an initial commit to the refs/meta/config branch for review. You can create such change from the UI (edit ACLs -\u003e Save for Review) but then the change is not submittable.\n\n\u003e So, is this the use case we\u0027re concerned about: someone\n\u003e running \"git init --bare $site/git/parentproject.git\", \n\u003e where they *plan* to make it config-only, but HEAD doesn\u0027t \n\u003e (yet) point at refs/meta/config?\n\nThat\u0027s not the use case that I had in mind, but it may help in this case too (although I think that in this case they could just fix HEAD to point to refs/meta/config).",
      "parentUuid": "909ab67a_25629fb2",
      "range": {
        "startLine": 139,
        "startChar": 34,
        "endLine": 139,
        "endChar": 57
      },
      "revId": "c9fe3d20f8aee30007f08274b9ab62d6bc735d09",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4116fd19_d6361de1",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/MergeOpRepoManager.java",
        "patchSetId": 1
      },
      "lineNbr": 139,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-08-18T14:06:21Z",
      "side": 1,
      "message": "\u003e This change is trying to fix the case where you have a normal project where HEAD points to master and the refs/meta/config branch is missing.\n\nI see. So the use case is, you start out with an empty repo, and you eventually plan to populate both refs/meta/config and master, but you just want to populate refs/meta/config _first_. That makes sense.",
      "parentUuid": "5983df6c_a3182c54",
      "range": {
        "startLine": 139,
        "startChar": 34,
        "endLine": 139,
        "endChar": 57
      },
      "revId": "c9fe3d20f8aee30007f08274b9ab62d6bc735d09",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}