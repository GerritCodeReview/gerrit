{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "3d1c4d19_dc61b810",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-view/gr-diff-view.ts",
        "patchSetId": 17
      },
      "lineNbr": 386,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-08T09:35:40Z",
      "side": 1,
      "message": "When !reviewedFiles should the private field still be reset?",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b3ccf1de_b0eb61b7",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-view/gr-diff-view.ts",
        "patchSetId": 17
      },
      "lineNbr": 386,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-11-15T15:50:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3d1c4d19_dc61b810",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "53db46b2_1d279cba",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-view/gr-diff-view.ts",
        "patchSetId": 17
      },
      "lineNbr": 409,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-08T09:35:40Z",
      "side": 1,
      "message": "Do you also need a takeUntil(this.disconnected$)?",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7c7efbdd_b14d3a10",
        "filename": "polygerrit-ui/app/elements/diff/gr-diff-view/gr-diff-view.ts",
        "patchSetId": 17
      },
      "lineNbr": 409,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-11-15T15:50:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "53db46b2_1d279cba",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7de531db_c6558512",
        "filename": "polygerrit-ui/app/services/change/change-model.ts",
        "patchSetId": 17
      },
      "lineNbr": 35,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-08T09:35:40Z",
      "side": 1,
      "message": "Add a comment about the meaning of this state and how it is managed.\n\nOne things that is important to mention: undefined means \"not yet loaded\", but empty set means \"loaded, but no files reviewed\".",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "39368525_452cbb3d",
        "filename": "polygerrit-ui/app/services/change/change-model.ts",
        "patchSetId": 17
      },
      "lineNbr": 35,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-11-15T15:50:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7de531db_c6558512",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "92db4dff_a3fba036",
        "filename": "polygerrit-ui/app/services/change/change-model.ts",
        "patchSetId": 17
      },
      "lineNbr": 92,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-08T09:35:40Z",
      "side": 1,
      "message": "Do you want to allow this? A user changing the reviewed state before the reviewed state was loaded?",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "66abb517_3db20049",
        "filename": "polygerrit-ui/app/services/change/change-model.ts",
        "patchSetId": 17
      },
      "lineNbr": 92,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-11-15T15:50:29Z",
      "side": 1,
      "message": "Yeah, the alternative is telling the users to wait somehow for the reviewed files to load. Not sure if users will be happy about that.\nWorst case they mark an already reviewed file reviewed again.\n\nIs there any other downside I am missing?",
      "parentUuid": "92db4dff_a3fba036",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "01a05b9c_839e994d",
        "filename": "polygerrit-ui/app/services/change/change-model.ts",
        "patchSetId": 17
      },
      "lineNbr": 92,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-16T08:43:31Z",
      "side": 1,
      "message": "If you allow this, then this update will be complete before the REST API call comes back. And when that comes back it will call updateStateReviewedFiles(), completely wiping the previous state.\n\nSo yes, while reviewedFiles\u003d\u003d\u003dundefined you have to either show a toast \"reviewed files not loaded yet\" when the user wants to interact with them. Or you disable the UI widgets based on loading state of the reviewed files.\n\nChange 323426 has an example of how to deal with \"loading\" state.",
      "parentUuid": "66abb517_3db20049",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "66e4540b_26268019",
        "filename": "polygerrit-ui/app/services/change/change-model.ts",
        "patchSetId": 17
      },
      "lineNbr": 92,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-11-26T11:08:47Z",
      "side": 1,
      "message": "Added a toast for now and a TODO for disabling the widgets when files have not loaded.",
      "parentUuid": "01a05b9c_839e994d",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "94381a91_6570338b",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 66,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-08T09:35:40Z",
      "side": 1,
      "message": "get... sounds like only read operations are happening and the method should have a return value.\n\nMaybe better update... or fetch... or set...",
      "range": {
        "startLine": 66,
        "startChar": 2,
        "endLine": 66,
        "endChar": 18
      },
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "eae85675_1368dca5",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 66,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-11-15T15:50:29Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "94381a91_6570338b",
      "range": {
        "startLine": 66,
        "startChar": 2,
        "endLine": 66,
        "endChar": 18
      },
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7c679174_5e7d9d46",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 67,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-08T09:35:40Z",
      "side": 1,
      "message": "So you are filtering twice? In line 58 and line 67.\n\nIf one of them is undefined, then clear the set of reviewed files?",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9ba80ce7_b4acf5e5",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 67,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-11-15T15:50:29Z",
      "side": 1,
      "message": "Removed the extra filter.\nThen the scenario of one of them being undefined should not be possible.",
      "parentUuid": "7c679174_5e7d9d46",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3c6da369_66f68eea",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 68,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-08T09:35:40Z",
      "side": 1,
      "message": "Better subscribe to account$.",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "02dca784_4490b039",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 68,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-11-15T15:50:29Z",
      "side": 1,
      "message": "How are they equivalent?\ngetLoggedIn() is doing an auth-check and account$ is simply the account object.",
      "parentUuid": "3c6da369_66f68eea",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5fcad923_ec9879df",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 68,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-16T08:43:31Z",
      "side": 1,
      "message": "The only benefit of getLoggedIn() over account$ is that it returns false, if you have been logged in before, but the credentials have expired in the meantime. But expired credentials generate a toast and an overlay anyway, so there is no need for every random component to care about that.",
      "parentUuid": "02dca784_4490b039",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d15ff139_704de505",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 68,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-11-26T11:08:47Z",
      "side": 1,
      "message": "Handling in Change 324891",
      "parentUuid": "5fcad923_ec9879df",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "df2daa3f_9e2c9ab9",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 73,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-08T09:35:40Z",
      "side": 1,
      "message": "Are you also making sure that the reviewed files in the state are wiped clean as soon as the changeNum changes (even if it changes to undefined)?",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "965761a8_3c74bf42",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 73,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-11-15T15:50:29Z",
      "side": 1,
      "message": "I could add something like\n\n```\nchangeNum$.subscribe(changeNum \u003d\u003e {\n      if (!changeNum) updateStateReviewedFiles(new Set([]));\n    })\n```\n\nto reset the state when changeNum becomes undefined. Currently it\u0027s fired whenever it becomes undefined but I\u0027m wondering if this is the best solution?",
      "parentUuid": "df2daa3f_9e2c9ab9",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "41aefc6c_d3ba7390",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 73,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-16T08:43:31Z",
      "side": 1,
      "message": "Added a new comment.",
      "parentUuid": "965761a8_3c74bf42",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6521f70a_92dec786",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 87,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-08T09:35:40Z",
      "side": 1,
      "message": "Maybe optimistic update before the API call? And then revert in cath(), if the API call failed?",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "383f9211_d210b8e5",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 87,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-11-15T15:50:29Z",
      "side": 1,
      "message": "Is it worth the extra complication?\nMaybe if users say it\u0027s slow otherwise this is the simpler option.",
      "parentUuid": "6521f70a_92dec786",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "13424811_37d4c4b9",
        "filename": "polygerrit-ui/app/services/change/change-service.ts",
        "patchSetId": 17
      },
      "lineNbr": 87,
      "author": {
        "id": 1013302
      },
      "writtenOn": "2021-11-16T08:43:31Z",
      "side": 1,
      "message": "It is optional, but I think the user experience is much better. That said, we don\u0027t yet do optimistic updates much, so feel free to let me establish that pattern in other places first.",
      "parentUuid": "383f9211_d210b8e5",
      "revId": "cb6bdb06fd00edd91d1c7eff1b9de7be056418e3",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}