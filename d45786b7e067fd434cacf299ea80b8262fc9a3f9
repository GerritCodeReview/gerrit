{
  "comments": [
    {
      "key": {
        "uuid": "9ee490d4_210ea1de",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 19,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2018-02-13T07:05:14Z",
      "side": 1,
      "message": "Another question is what implication group index activation on the slaves have on gerrit upgrade procedure. Should now reindex program be executed during upgrading on the slaves as well? Right now only init command is executed on the slaves. If this is the case, should this be documented in some place?",
      "range": {
        "startLine": 18,
        "startChar": 68,
        "endLine": 19,
        "endChar": 47
      },
      "revId": "d45786b7e067fd434cacf299ea80b8262fc9a3f9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3ef5c226_d5c29fac",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 19,
      "author": {
        "id": 1030912
      },
      "writtenOn": "2018-02-13T08:26:00Z",
      "side": 1,
      "message": "The group index including all current fields certainly has to be created on slaves (but the content of the index doesn\u0027t need to be up-to-date). I\u0027m not familiar enough with the upgrade procedures for slaves. Up-to-now, did the init step for slaves create all indices but they were simply not used?\n\nFor the regular upgrade, I mentioned in I5143cd0d0 that we need a reindex for the group index. Should I mention in the same paragraph that this step is also mandatory for slave hosts? Or do we typically document slave upgrade procedures somewhere else?",
      "parentUuid": "9ee490d4_210ea1de",
      "range": {
        "startLine": 18,
        "startChar": 68,
        "endLine": 19,
        "endChar": 47
      },
      "revId": "d45786b7e067fd434cacf299ea80b8262fc9a3f9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "36fb00c0_d02bd813",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 19,
      "author": {
        "id": 1030912
      },
      "writtenOn": "2018-02-21T09:39:15Z",
      "side": 1,
      "message": "David, can you please add the relevant steps to our documentation? If you give me more hints, I can also do it.",
      "parentUuid": "3ef5c226_d5c29fac",
      "range": {
        "startLine": 18,
        "startChar": 68,
        "endLine": 19,
        "endChar": 47
      },
      "revId": "d45786b7e067fd434cacf299ea80b8262fc9a3f9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3d1ae33b_4a363f69",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 19,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2018-02-21T09:51:37Z",
      "side": 1,
      "message": "Current slave host upgrade procedure:\n\n* run init program, that will upgrade release.war\n* done\n\nIf slave host upgrade procedure after this change is remained the same, there is nothing to document. My qeustion was a different one: This change prevented running reindexing program on slave hosts. Why ths restriction was necessary? Why can\u0027t we allow offline reindexing on slave hosts?\n\nHowever, now, that you added this documentation in I5143cd0d0 about restriction on offline reindexing in 2.16, saying that it must be done offline, because two fields were added, and cannot be done online, make it even more confusing for the administratos, as they would ask: hey, groups index is active now on master and slave, and on master, reindxing must be done offline, but why offline reindxing is not supported on the slave (by the fact the reindex site-program invocation wouldn\u0027t run).\n\nWhat am I missing?",
      "parentUuid": "36fb00c0_d02bd813",
      "range": {
        "startLine": 18,
        "startChar": 68,
        "endLine": 19,
        "endChar": 47
      },
      "revId": "d45786b7e067fd434cacf299ea80b8262fc9a3f9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d502e99d_16f4529a",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 19,
      "author": {
        "id": 1030912
      },
      "writtenOn": "2018-02-21T10:34:59Z",
      "side": 1,
      "message": "Now I see what you meant. We didn\u0027t deliberately restrict the offline reindexing for slaves. On the contrary, we implicitly assumed it would work (see the commit message of Ibac7af13de). But you\u0027re right: offline reindexing is currently switched off for slaves. We should change that for the group index.",
      "parentUuid": "3d1ae33b_4a363f69",
      "range": {
        "startLine": 18,
        "startChar": 68,
        "endLine": 19,
        "endChar": 47
      },
      "revId": "d45786b7e067fd434cacf299ea80b8262fc9a3f9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a8fe1bac_da6fa335",
        "filename": "java/com/google/gerrit/pgm/Reindex.java",
        "patchSetId": 2
      },
      "lineNbr": 159,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2018-02-13T07:09:41Z",
      "side": 1,
      "message": "Why shouldn\u0027t we be able to reindex in offline mode on Gerrit upgrades?",
      "range": {
        "startLine": 159,
        "startChar": 93,
        "endLine": 159,
        "endChar": 98
      },
      "revId": "d45786b7e067fd434cacf299ea80b8262fc9a3f9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a5ddad0_973da1a3",
        "filename": "java/com/google/gerrit/pgm/Reindex.java",
        "patchSetId": 2
      },
      "lineNbr": 159,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2018-02-13T07:10:34Z",
      "side": 1,
      "message": "I meant \"Why shouldn\u0027t we be able to reindex in offline mode on Gerrit upgrades on the slaved nodes\"?",
      "parentUuid": "a8fe1bac_da6fa335",
      "range": {
        "startLine": 159,
        "startChar": 93,
        "endLine": 159,
        "endChar": 98
      },
      "revId": "d45786b7e067fd434cacf299ea80b8262fc9a3f9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "eb907712_a82a69ab",
        "filename": "java/com/google/gerrit/pgm/Reindex.java",
        "patchSetId": 2
      },
      "lineNbr": 159,
      "author": {
        "id": 1030912
      },
      "writtenOn": "2018-02-13T08:26:00Z",
      "side": 1,
      "message": "I don\u0027t understand your question. \u0027false\u0027 means that the behavior of the non-slave mode is executed, no matter whether the Gerrit host is a master or a slave. Hence, all indices are provided for Reindex. This is exactly the behavior we had before this change.",
      "parentUuid": "5a5ddad0_973da1a3",
      "range": {
        "startLine": 159,
        "startChar": 93,
        "endLine": 159,
        "endChar": 98
      },
      "revId": "d45786b7e067fd434cacf299ea80b8262fc9a3f9",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}