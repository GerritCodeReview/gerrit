{
  "comments": [
    {
      "key": {
        "uuid": "9b44edda_34ecae2e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 43,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2018-01-18T22:18:28Z",
      "side": 1,
      "message": "I have been personally used Caffeine with large projects and I completely agree.",
      "range": {
        "startLine": 42,
        "startChar": 18,
        "endLine": 43,
        "endChar": 14
      },
      "revId": "d7787ba29f67fbb0d7142d3c316d9f2dad5bcb8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b0fac5d0_923fcce2",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 43,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2018-01-18T22:19:27Z",
      "side": 1,
      "message": ".",
      "parentUuid": "9b44edda_34ecae2e",
      "range": {
        "startLine": 42,
        "startChar": 18,
        "endLine": 43,
        "endChar": 14
      },
      "revId": "d7787ba29f67fbb0d7142d3c316d9f2dad5bcb8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "04aaf9ab_13868d7c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 66,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2018-01-18T23:34:31Z",
      "side": 1,
      "message": "nit: remove blank line",
      "revId": "d7787ba29f67fbb0d7142d3c316d9f2dad5bcb8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "933ccef6_0389ee64",
        "filename": "WORKSPACE",
        "patchSetId": 3
      },
      "lineNbr": 216,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2018-01-18T22:46:58Z",
      "side": 1,
      "message": "How about 2.6.1?",
      "revId": "d7787ba29f67fbb0d7142d3c316d9f2dad5bcb8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d708ddea_fbe1f127",
        "filename": "WORKSPACE",
        "patchSetId": 3
      },
      "lineNbr": 216,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2018-01-18T23:34:31Z",
      "side": 1,
      "message": "Also, how about extracting the version to a constant that is used both here and L222?",
      "parentUuid": "933ccef6_0389ee64",
      "revId": "d7787ba29f67fbb0d7142d3c316d9f2dad5bcb8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "164ff5ba_7f964713",
        "filename": "WORKSPACE",
        "patchSetId": 3
      },
      "lineNbr": 216,
      "author": {
        "id": 1012987
      },
      "writtenOn": "2018-01-19T00:34:32Z",
      "side": 1,
      "message": "good point, I will do this in next ps.",
      "parentUuid": "d708ddea_fbe1f127",
      "revId": "d7787ba29f67fbb0d7142d3c316d9f2dad5bcb8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "26d56842_7a2d954a",
        "filename": "WORKSPACE",
        "patchSetId": 3
      },
      "lineNbr": 216,
      "author": {
        "id": 1012987
      },
      "writtenOn": "2018-01-19T00:34:32Z",
      "side": 1,
      "message": "Since a library change is already a risk, I wanted at least to proposed a version I tested and I know works in a real production environment.\n\nThat said, even if we merge this change as is, it\u0027s only a matter of time before someone upgrade that library to the latest as we usually do so better do it now I guess.",
      "parentUuid": "933ccef6_0389ee64",
      "revId": "d7787ba29f67fbb0d7142d3c316d9f2dad5bcb8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8d67e4b1_d718a5dd",
        "filename": "java/com/google/gerrit/server/cache/h2/DefaultCacheFactory.java",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2018-01-19T16:39:01Z",
      "side": 1,
      "message": "Note that there are also several places in Gerrit code which use Guava\u0027s CacheBuilder directly instead of utilizing CacheModule and its DSL for declaring caches. These places would also need to be changed.",
      "revId": "d7787ba29f67fbb0d7142d3c316d9f2dad5bcb8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ed79d69c_3fa3834e",
        "filename": "java/com/google/gerrit/server/cache/h2/DefaultCacheFactory.java",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2018-01-19T16:43:12Z",
      "side": 1,
      "message": "+1 but IMO that doesn\u0027t have to be in this change.",
      "parentUuid": "8d67e4b1_d718a5dd",
      "revId": "d7787ba29f67fbb0d7142d3c316d9f2dad5bcb8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "08e0f25d_9d41cd65",
        "filename": "java/com/google/gerrit/server/cache/h2/DefaultCacheFactory.java",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1012987
      },
      "writtenOn": "2018-01-19T18:13:01Z",
      "side": 1,
      "message": "Do you think cache builder is used directly because we do not want these caches to be configurable in gerrit.config and we do not want them to show up in \"show-cache\" command?\n\nIf this is the reason, I can fix that by adding method in cache module to build \"hidden\" cache.\n\nHere is the list of caches not using the cache module:\n-External Id by account\n-one in NoteDbModule when used in tests\n-DefaultProjectNameLockManager\n\nThere is also one cache in AccountState to store properties and this one is a special case. It\u0027s not a global cache, there is one per AccountState instance.\n\nI am asking here but I will fix that in another change.",
      "parentUuid": "8d67e4b1_d718a5dd",
      "revId": "d7787ba29f67fbb0d7142d3c316d9f2dad5bcb8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0943750a_57de7f29",
        "filename": "java/com/google/gerrit/server/cache/h2/DefaultCacheFactory.java",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1003873
      },
      "writtenOn": "2018-01-22T09:42:11Z",
      "side": 1,
      "message": "\u003e Do you think cache builder is used directly because we do not want these caches to be configurable in gerrit.config and we do not want them to show up in \"show-cache\" command?\n\nI am not sure without looking at the code, but I doubt that we wanted to hide any\ncache from being shown up in the show-caches command.\n\nThere may be a reason to use CacheBuilder directly. For example, if we have a loading\ncache and want to bind an instance of the loader instead of binding its class.\nOne such example is in in the quota plugin [1].\nAFAIK, CacheModule only supports binding Loader(s) by their class.\n\n[1] https://gerrit.googlesource.com/plugins/quota/+/refs/changes/53/143053/12/src/main/java/com/googlesource/gerrit/plugins/quota/Module.java#210\n\n\u003e \n\u003e If this is the reason, I can fix that by adding method in cache module to build \"hidden\" cache.\n\u003e \n\u003e Here is the list of caches not using the cache module:\n\u003e -External Id by account\n\u003e -one in NoteDbModule when used in tests\n\u003e -DefaultProjectNameLockManager\n\u003e \n\u003e There is also one cache in AccountState to store properties and this one is a special case. It\u0027s not a global cache, there is one per AccountState instance.\n\u003e \n\u003e I am asking here but I will fix that in another change.\n\nUnless we have cases like [1] in Gerrit core, the fix should be easy :-)",
      "parentUuid": "08e0f25d_9d41cd65",
      "revId": "d7787ba29f67fbb0d7142d3c316d9f2dad5bcb8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "516d9e15_38cfe585",
        "filename": "java/com/google/gerrit/server/cache/h2/DefaultCacheFactory.java",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2018-01-22T18:38:18Z",
      "side": 1,
      "message": "The primary reason not to use CacheModule is to make it so the cache is *not* configurable using gerrit.config. For example in ExternalIdCacheImpl we explain in detail why we want the cache size to be exactly 1, which implies it shouldn\u0027t be configurable.\n\nI am definitely in favor of replacing these manual uses of CacheBuilder with Caffeine (assuming we adopt Caffeine for CacheModule).\n\nI would be open to adding a method on CacheBinding like configurable(boolean) that allows us to disable configuration via gerrit.config. That way we could continue to use CacheModule consistently. OTOH, converting something currently using a hand-rolled CacheBuilder to use CacheModule is probably a net increase in boilerplate/indirection, so I\u0027m not yet convinced it\u0027s a win.",
      "parentUuid": "0943750a_57de7f29",
      "revId": "d7787ba29f67fbb0d7142d3c316d9f2dad5bcb8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}