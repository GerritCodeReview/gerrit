{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "37eb5cf4_dc6a0865",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1002666
      },
      "writtenOn": "2021-02-09T20:58:38Z",
      "side": 1,
      "message": "Sorta works? The output I get from check_buildifier (which also has some deprecation notices) seems to be different from the diff I get after fix_buildifier:\n\n $ bazel run //:check_buildifier\n INFO: Invocation ID: f95eda8c-96ca-4059-a183-0e8aa1b5af09\n DEBUG: /Users/nasserg/.cache/bazel/60643c8736542bd7302f52749e82aa97/external/bazel_toolchains/rules/rbe_repo/version_check.bzl:68:14:\n Current running Bazel is ahead of bazel-toolchains repo. Please update your pin to bazel-toolchains repo in your WORKSPACE file.\n DEBUG: /Users/nasserg/.cache/bazel/60643c8736542bd7302f52749e82aa97/external/bazel_toolchains/rules/rbe_repo/checked_in.bzl:125:14: rbe_jdk11 not using checked in configs; Bazel version 3.7.0 was picked/selected but no checked in config was found in map {\"0.20.0\": [\"8.0.0\"], \"0.21.0\": [\"8.0.0\"], \"0.22.0\": [\"8.0.0\", \"9.0.0\"], \"0.23.0\": [\"8.0.0\", \"9.0.0\"], \"0.23.1\": [\"8.0.0\", \"9.0.0\"], \"0.23.2\": [\"9.0.0\"], \"0.24.0\": [\"9.0.0\"], \"0.24.1\": [\"9.0.0\"], \"0.25.0\": [\"9.0.0\"], \"0.25.1\": [\"9.0.0\"], \"0.25.2\": [\"9.0.0\"], \"0.26.0\": [\"9.0.0\"], \"0.26.1\": [\"9.0.0\"], \"0.27.0\": [\"9.0.0\"], \"0.27.1\": [\"9.0.0\"], \"0.28.0\": [\"9.0.0\"], \"0.28.1\": [\"9.0.0\"], \"0.29.0\": [\"9.0.0\"], \"0.29.1\": [\"9.0.0\", \"10.0.0\"], \"1.0.0\": [\"9.0.0\", \"10.0.0\"], \"1.0.1\": [\"10.0.0\"], \"1.1.0\": [\"10.0.0\"], \"1.2.0\": [\"10.0.0\"], \"1.2.1\": [\"10.0.0\"], \"2.0.0\": [\"10.0.0\"], \"2.1.0\": [\"10.0.0\"], \"2.1.1\": [\"10.0.0\", \"11.0.0\"], \"2.2.0\": [\"11.0.0\"], \"3.0.0\": [\"11.0.0\"], \"3.1.0\": [\"11.0.0\"]}\n DEBUG: /Users/nasserg/.cache/bazel/60643c8736542bd7302f52749e82aa97/external/com_github_bazelbuild_buildtools/buildifier/internal/factory.bzl:17:10: DEPRECATION NOTICE: value \u0027diff\u0027 for attribute \u0027mode\u0027 will be removed in the future. Migrate \u0027//:check_buildifier\u0027 to buildifier_test.\n DEBUG: /Users/nasserg/.cache/bazel/60643c8736542bd7302f52749e82aa97/external/com_github_bazelbuild_buildtools/buildifier/internal/factory.bzl:28:10: DEPRECATION NOTICE: attribute \u0027diff_command\u0027 will be removed in the future. Migrate \u0027//:check_buildifier\u0027 to buildifier_test.\n INFO: Analyzed target //:check_buildifier (4 packages loaded, 121 targets configured).\n INFO: Found 1 target...\n Target //:check_buildifier up-to-date:\n   bazel-bin/check_buildifier.bash\n INFO: Elapsed time: 2.043s, Critical Path: 0.71s\n INFO: 1 process: 1 internal.\n INFO: Build completed successfully, 1 total action\n INFO: Build completed successfully, 1 total action\n ./tools/js/eslint.bzl:\n --- ./tools/js/eslint.bzl\t2021-02-09 13:52:42.000000000 -0700\n +++ /var/folders/w2/qr1t1nrn4_d8rm_htnqq07980020j2/T/buildifier-tmp-844189646\t2021-02-09 13:52:48.000000000 -0700\n @@ -87,7 +87,7 @@\n              \"*_test_require_patch.js\",\n              \"--ignore-pattern\",\n              \"*_test_loader.js\",\n -            \"./\", # Relative to the config file location\n +            \"./\",  # Relative to the config file location\n          ],\n          # Should not run sandboxed.\n          tags \u003d [\n exit status 1\n ./tools/js/BUILD:\n --- ./tools/js/BUILD\t2021-02-09 13:52:42.000000000 -0700\n +++ /var/folders/w2/qr1t1nrn4_d8rm_htnqq07980020j2/T/buildifier-tmp-219081941\t2021-02-09 13:52:48.000000000 -0700\n @@ -1 +1,4 @@\n -exports_files([\"run_npm_binary.py\", \"eslint-chdir.js\"])\n +exports_files([\n +    \"run_npm_binary.py\",\n +    \"eslint-chdir.js\",\n +])\n exit status 1\n\n\n\nDiff output:\n\n diff --git a/WORKSPACE b/WORKSPACE\n index 3e45477e38..9950231bb9 100644\n --- a/WORKSPACE\n +++ b/WORKSPACE\n @@ -26,9 +26,8 @@ workspace(\n      },\n  )\n  \n -load(\"@bazel_tools//tools/build_defs/repo:git.bzl\", \"git_repository\")\n  load(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_archive\", \"http_file\")\n -load(\"//tools/bzl:maven_jar.bzl\", \"GERRIT\", \"MAVEN_LOCAL\", \"maven_jar\")\n +load(\"//tools/bzl:maven_jar.bzl\", \"GERRIT\", \"maven_jar\")\n  load(\"//plugins:external_plugin_deps.bzl\", \"external_plugin_deps\")\n  load(\"//tools:nongoogle.bzl\", \"TESTCONTAINERS_VERSION\", \"declare_nongoogle_deps\")\n  \n diff --git a/java/com/google/gerrit/auth/BUILD b/java/com/google/gerrit/auth/BUILD\n index a390e14f89..867faf8476 100644\n --- a/java/com/google/gerrit/auth/BUILD\n +++ b/java/com/google/gerrit/auth/BUILD\n @@ -1,5 +1,4 @@\n  load(\"@rules_java//java:defs.bzl\", \"java_library\")\n -load(\"//tools/bzl:javadoc.bzl\", \"java_doc\")\n  \n  # Giant kitchen-sink target.\n  #\n diff --git a/javatests/com/google/gerrit/auth/BUILD b/javatests/com/google/gerrit/auth/BUILD\n index d4bb16dbc7..a47d7a78e0 100644\n --- a/javatests/com/google/gerrit/auth/BUILD\n +++ b/javatests/com/google/gerrit/auth/BUILD\n @@ -1,4 +1,3 @@\n -load(\"@rules_java//java:defs.bzl\", \"java_library\")\n  load(\"//tools/bzl:junit.bzl\", \"junit_tests\")\n  \n  junit_tests(\n diff --git a/tools/bzl/junit.bzl b/tools/bzl/junit.bzl\n index 3695e168e0..491f95e66b 100644\n --- a/tools/bzl/junit.bzl\n +++ b/tools/bzl/junit.bzl\n @@ -12,7 +12,7 @@\n  # See the License for the specific language governing permissions and\n  # limitations under the License.\n  \n -# Skylark rule to generate a Junit4 TestSuite\n +# Starlark rule to generate a Junit4 TestSuite\n  # Assumes srcs are all .java Test files\n  # Assumes junit4 is already added to deps by the user.\n  \n diff --git a/tools/js/BUILD b/tools/js/BUILD\n index 1a272e238f..bb9f618e59 100644\n --- a/tools/js/BUILD\n +++ b/tools/js/BUILD\n @@ -1 +1,4 @@\n -exports_files([\"run_npm_binary.py\", \"eslint-chdir.js\"])\n +exports_files([\n +    \"run_npm_binary.py\",\n +    \"eslint-chdir.js\",\n +])\n diff --git a/tools/js/eslint.bzl b/tools/js/eslint.bzl\n index b32e2bc918..ad605e74ca 100644\n --- a/tools/js/eslint.bzl\n +++ b/tools/js/eslint.bzl\n @@ -87,7 +87,7 @@ def eslint(name, plugins, srcs, config, ignore, extensions \u003d [\".js\"], data \u003d [])\n              \"*_test_require_patch.js\",\n              \"--ignore-pattern\",\n              \"*_test_loader.js\",\n -            \"./\", # Relative to the config file location\n +            \"./\",  # Relative to the config file location\n          ],\n          # Should not run sandboxed.\n          tags \u003d [\n\ncheck_buildifier does pass after running fix_buildifier. Gerrit build still works after running fix_buildifier.",
      "revId": "dbbf0102eb9079ba424a1df752cfd08c4b277d84",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}