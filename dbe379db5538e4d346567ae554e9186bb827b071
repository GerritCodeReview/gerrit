{
  "comments": [
    {
      "key": {
        "uuid": "f3edb5ca_0dd6d161",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/AbstractDaemonTest.java",
        "patchSetId": 2
      },
      "lineNbr": 153,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2014-08-21T23:22:46Z",
      "side": 1,
      "message": "You have to start a new server if this test has @GerritConfig or @GerritConfigs.",
      "revId": "dbe379db5538e4d346567ae554e9186bb827b071",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b3e5fdf4_bbe1a734",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/schema/SchemaCreator.java",
        "patchSetId": 2
      },
      "lineNbr": 122,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-22T08:05:24Z",
      "side": 1,
      "message": "Use upper case.",
      "range": {
        "startLine": 122,
        "startChar": 18,
        "endLine": 122,
        "endChar": 32
      },
      "revId": "dbe379db5538e4d346567ae554e9186bb827b071",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9358f970_ba88b165",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/schema/SchemaCreator.java",
        "patchSetId": 2
      },
      "lineNbr": 132,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-21T23:16:54Z",
      "side": 1,
      "message": "Fixed sequences resetting. To reset the sequences we have to use refelction for now, as the methods are private ;-(\n\nAfter we have found a way to reset Lucene we are pretty much done with nuking the world.",
      "range": {
        "startLine": 124,
        "startChar": 6,
        "endLine": 132,
        "endChar": 24
      },
      "revId": "dbe379db5538e4d346567ae554e9186bb827b071",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f3edb5ca_2dd10d6a",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/schema/SchemaCreator.java",
        "patchSetId": 2
      },
      "lineNbr": 132,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2014-08-21T23:22:46Z",
      "side": 1,
      "message": "\u003e To reset the sequences we have to use refelction for now\n\nYou can reset sequences without pruning them. It requires H2-only SQL, but we only support H2 here, so that\u0027s fine:\n\n try {\n   for (String seq : dialect.listSequences(schema.getConnection())) {\n     e.execute(\"ALTER SEQUENCE \" + seq + \" RESTART WITH 1\");\n   }\n } finally {\n   e.close();\n }\n\n\u003e After we have found a way to reset Lucene we are pretty much done with nuking the world.\n\nAlready exists, because Reindex already does it.",
      "parentUuid": "9358f970_ba88b165",
      "range": {
        "startLine": 124,
        "startChar": 6,
        "endLine": 132,
        "endChar": 24
      },
      "revId": "dbe379db5538e4d346567ae554e9186bb827b071",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d3e8b1cd_1cf8d5e1",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/schema/SchemaCreator.java",
        "patchSetId": 2
      },
      "lineNbr": 132,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-22T08:05:24Z",
      "side": 1,
      "message": "The reason i tried to avoid entering non portable terrain across database dialects here is while it is true that currently acceptance tests framework is bound to H2, it can be easily changed in Datasource initialization and hijacked to be run against another dialect. All database dialects supported by Gerrit support restart sequence statement (*) in one or another way. So there is no reason why GWTORM couldn\u0027t expose public accessible `restartSequence()` method (and may be even `truncateTable()` method).\n\n (*) As always MySQL is an exception: it doesn\u0027t support sequences at all.\n  They are emulated with table-per-sequence pattern.",
      "parentUuid": "f3edb5ca_2dd10d6a",
      "range": {
        "startLine": 124,
        "startChar": 6,
        "endLine": 132,
        "endChar": 24
      },
      "revId": "dbe379db5538e4d346567ae554e9186bb827b071",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b3e5fdf4_fbeb2f10",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/schema/SchemaCreator.java",
        "patchSetId": 2
      },
      "lineNbr": 132,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-22T08:11:45Z",
      "side": 1,
      "message": "|| After we have found a way to reset Lucene we are pretty much done with nuking the world.\n\n| Already exists, because Reindex already does it.\n\nWhile thinking about it: we have @NoSshd and @NoHttpd annotations to not boot these services in some tests. I wonder why don\u0027t we have @NoIndex to not mess around with Lucene in non index related tests in the first place?",
      "parentUuid": "f3edb5ca_2dd10d6a",
      "range": {
        "startLine": 124,
        "startChar": 6,
        "endLine": 132,
        "endChar": 24
      },
      "revId": "dbe379db5538e4d346567ae554e9186bb827b071",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "902f0fb5_82f3ba04",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/schema/SchemaCreator.java",
        "patchSetId": 2
      },
      "lineNbr": 132,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2014-09-05T19:54:47Z",
      "side": 1,
      "message": "\u003e So there is no reason why GWTORM couldn\u0027t expose public accessible `restartSequence()` method (and may be even `truncateTable()` method).\n\nGood point, let\u0027s just expose that upstream then.\n\n\u003e I wonder why don\u0027t we have @NoIndex\n\nI would be surprised if that were a substantial gain.\n\nThe point of @NoSsh and @NoHttpd is to eliminate entire injectors, which saves noticeable Guice setup time. The overhead of setting up an in-memory index (or even an on-disk index) that isn\u0027t used is likely to be low.\n\nAnd honestly, I think if we had implemented one-server-per-test-class sooner, we might not have bothered with @NoSsh and @NoHttpd in the first place :)",
      "parentUuid": "b3e5fdf4_fbeb2f10",
      "range": {
        "startLine": 124,
        "startChar": 6,
        "endLine": 132,
        "endChar": 24
      },
      "revId": "dbe379db5538e4d346567ae554e9186bb827b071",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}