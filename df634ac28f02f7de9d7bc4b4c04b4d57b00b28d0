{
  "comments": [
    {
      "key": {
        "uuid": "39ebc864_c102223c",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/common/MultiLock.java",
        "patchSetId": 36
      },
      "lineNbr": 22,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Unnecessary blank line",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_c01c5e75",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/common/MultiLock.java",
        "patchSetId": 36
      },
      "lineNbr": 22,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:29:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_c102223c",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_6131162a",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/MergeOp.java",
        "patchSetId": 36
      },
      "lineNbr": 281,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Long line.",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_e00f6235",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/MergeOp.java",
        "patchSetId": 36
      },
      "lineNbr": 281,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:29:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_6131162a",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_412612f2",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/MergeOp.java",
        "patchSetId": 36
      },
      "lineNbr": 875,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Optional: add a create(Change...) static factory on ChangeSet",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_a1c71e33",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/MergeOp.java",
        "patchSetId": 36
      },
      "lineNbr": 875,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:29:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_412612f2",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_e11c069e",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/MergeQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 25,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Really? This is the opposite of the old behavior isn\u0027t it?\n\nThe old behavior (try once and stick in the merge queue if it fails) is what people expect if they call submit with wait_for_merge set.",
      "range": {
        "startLine": 25,
        "startChar": 5,
        "endLine": 25,
        "endChar": 9
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_e1bd26b5",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/MergeQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 25,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Oh :(\n\nWrong documentation is even worse than no documentation.\nActually the implementation in CMQ is to schedule it\n\n    ChangeSetTask task \u003d new ChangeSetTask(changes);\n    if (!queue.process(task)) {\n      queue.schedule(task, 0);\n    }\n\nI\u0027ll adapt the documentation.",
      "parentUuid": "39ebc864_e11c069e",
      "range": {
        "startLine": 25,
        "startChar": 5,
        "endLine": 25,
        "endChar": 9
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_a116fe77",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 38,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Is this prefix actually required to get it to compile?",
      "range": {
        "startLine": 38,
        "startChar": 55,
        "endLine": 38,
        "endChar": 76
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_e10f6635",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 38,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "In the current code yes.\n\nI could \n\n    import com.google.gerrit.server.git.PriorityLockedQueue.Task;\n\nthough, which makes it compile without the prefix.\nI\u0027ll do that for now, though I think as it\u0027s an inner class, we may want to point it out here?",
      "parentUuid": "39ebc864_a116fe77",
      "range": {
        "startLine": 38,
        "startChar": 55,
        "endLine": 38,
        "endChar": 76
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_8005364c",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 47,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "final?",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_0095a647",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 47,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_8005364c",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_6158f65b",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 50,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "final",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_c11c6275",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 50,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_6158f65b",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_a0e83af0",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 52,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "final",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_a1195e83",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 52,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_a0e83af0",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_415df249",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 55,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "final? Or maybe not.",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_e091a25b",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 55,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "ack",
      "parentUuid": "39ebc864_415df249",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_e0ee42fe",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 57,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "final",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_81265ac1",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 57,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_e0ee42fe",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_8153fa3f",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 61,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Why 1?",
      "range": {
        "startLine": 61,
        "startChar": 37,
        "endLine": 61,
        "endChar": 39
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_c09e9e6b",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 61,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "We should use the expected queue length here IMO, but even here at Google there will be less than one call to process/schedule per second, so the queue will be empty most of the time. \n\nI removed the 1, so we have a default sized PriorityQueue.",
      "parentUuid": "39ebc864_8153fa3f",
      "range": {
        "startLine": 61,
        "startChar": 37,
        "endLine": 61,
        "endChar": 39
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_a0195a83",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 61,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T19:40:10Z",
      "side": 1,
      "message": "The expected size is a function of the capacity, but it is not the same thing as the capacity. This is why Guava distinguishes between new*WithCapacity and new*WithExpectedSize",
      "parentUuid": "19f28455_c09e9e6b",
      "range": {
        "startLine": 61,
        "startChar": 37,
        "endLine": 61,
        "endChar": 39
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_e163e60b",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 68,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "We tend to keep method javadocs in the imperative mood, so perhaps:\n\nProcess a task immediately, if it is possible to do so.",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_a09b9a79",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 68,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_e163e60b",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_600a325c",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 69,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "\u003cp\u003e",
      "range": {
        "startLine": 68,
        "startChar": 78,
        "endLine": 69,
        "endChar": 5
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_8088962b",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 69,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_600a325c",
      "range": {
        "startLine": 68,
        "startChar": 78,
        "endLine": 69,
        "endChar": 5
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_400f2e6a",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 85,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Schedule",
      "range": {
        "startLine": 85,
        "startChar": 5,
        "endLine": 85,
        "endChar": 23
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_412052a3",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 85,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_400f2e6a",
      "range": {
        "startLine": 85,
        "startChar": 5,
        "endLine": 85,
        "endChar": 23
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_c170e2d3",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 88,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "s/a //",
      "range": {
        "startLine": 88,
        "startChar": 33,
        "endLine": 88,
        "endChar": 35
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_612b568b",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 88,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_c170e2d3",
      "range": {
        "startLine": 88,
        "startChar": 33,
        "endLine": 88,
        "endChar": 35
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_20142a7c",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 95,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Subsequent lines are indented 4 spaces, not aligned.",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_21254eb3",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 95,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_20142a7c",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_e0f522c4",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 97,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Unnecessary final",
      "range": {
        "startLine": 97,
        "startChar": 45,
        "endLine": 97,
        "endChar": 50
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_40828e09",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 97,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_e0f522c4",
      "range": {
        "startLine": 97,
        "startChar": 45,
        "endLine": 97,
        "endChar": 50
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_c0021e3c",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 103,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Try to process",
      "range": {
        "startLine": 103,
        "startChar": 5,
        "endLine": 103,
        "endChar": 21
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_613fd6e9",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 104,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "\u003cp\u003e only between paragraphs of the description, not between description and @params",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_e13646ef",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 104,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_613fd6e9",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_813adaf7",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 106,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Indentation",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_20878a19",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 106,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_813adaf7",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_00f926c0",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 108,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Indentation.",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_c13342fd",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 108,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_00f926c0",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_802c16d4",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 112,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "This nesting is hard to read, instead:\n\n if (!locks.lock(task.resources())) {\n   return false;\n }",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_007c8697",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 112,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_802c16d4",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_2139ce01",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 113,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "currentTasks is not a synchronized set, and presumably this method can be called from a variety of threads. I haven\u0027t thought through whether the call to locks.lock is enough to ensure whether a write to currentTasks after locks.lock returns is guaranteed to be seen by all threads.\n\nWould it make sense for this whole method be synchronized?",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_a1303ef1",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 113,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "If I understand the synchronized semantics correctly, then only one thread can enter this method at a time,\nbut we want to be able to run this code from different threads which utilize different resources at the same time?\n\nSo actually we could run the code of this method synchronized except for processTask/processAsyncTask which should be excluded from the synchronization.",
      "parentUuid": "39ebc864_2139ce01",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_61f9167b",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 113,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T19:40:10Z",
      "side": 1,
      "message": "I agree that only one thread can enter this block at a time, because it is guarded by the call to locks.lock.\n\nWhat I am unsure about is whether a write to currentTasks in this block is guaranteed to be visible to other threads. In the case of a standard synchronized{} block, if writes and reads only happen while actually holding the lock, then any reader is guaranteed to see the results of all writes. Since you are not holding an _actual_ lock (from the perspective of the java memory model) in this block, I don\u0027t know if that is the case.",
      "parentUuid": "39ebc864_a1303ef1",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_4134d209",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 115,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Instead of repeatedly checking the async boolean, consider splitting this into two methods, tryRunTask and tryRunTaskAsync.",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_e14ac675",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 128,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "ISTM you need to forceably cancel the async task before you can call this. What if the task is still running in the background, still making progress, but runs longer than the timeout? This will release the task\u0027s locks, which might then be handed to some other task. The second task can reasonably assume that no other worker is using those resources, but that assumption would be false in this case.",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_81cd3a5d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 128,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "That\u0027s the problem we were discussing earlier as well. Once we hand off the work to another thread, we cannot be sure if that thread takes a long time or just dies. So we need to have a guarantee that processingAsyncTaskDone is called eventually, such that we don\u0027t lock up.\n\nMaybe I should document the contract of processAsyncTask a bit more. Either you finish in time and call processingAsyncTaskDone or that call is assumed to be dead.\n\nPractically we could just have quite a long time out here, say 30 seconds, as no merge operation will take that long?",
      "parentUuid": "39ebc864_e14ac675",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_802656c1",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 128,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T19:40:10Z",
      "side": 1,
      "message": "We can\u0027t be sure how long it\u0027s going to take, but we can kill it if it\u0027s taking too long.\n\nGuessing an arbitrary timeout and hoping is not good enough unless there is really really no other option.",
      "parentUuid": "39ebc864_81cd3a5d",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_40260ef2",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 139,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Schedule",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_80ff7679",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 139,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_40260ef2",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_c147c26b",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 141,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "If",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_a0727abf",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 141,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_c147c26b",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_202b0aba",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 145,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Indentation",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_6004721d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 145,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_202b0aba",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_002006d0",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 152,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "The enclosing method is synchronized, but this run method is not. What if the queue is modified during iteration?",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_40096e33",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 152,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Introducing a synchronized(queue) { ... }",
      "parentUuid": "19f28455_002006d0",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_6031122a",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 196,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Need to finish this sentence",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_00136665",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 196,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_6031122a",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_a144be67",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 212,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Long line",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_81a1bab3",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 212,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Necessary?",
      "range": {
        "startLine": 212,
        "startChar": 45,
        "endLine": 212,
        "endChar": 65
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_21dc2e0d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 212,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_a144be67",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_01c12a21",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 212,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "No. :(",
      "parentUuid": "39ebc864_81a1bab3",
      "range": {
        "startLine": 212,
        "startChar": 45,
        "endLine": 212,
        "endChar": 65
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_e01c029e",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 213,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "final",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_41d732eb",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 213,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_e01c029e",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_61a6b6cb",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 228,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "synchronized?",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_61d236fd",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 228,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_61a6b6cb",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_41abb291",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 233,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "synchronized?",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_200e6a3d",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/git/PriorityLockedQueue.java",
        "patchSetId": 36
      },
      "lineNbr": 233,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:26:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_41abb291",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_21b0aefb",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 38,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "This method is called only once per test run. In particular, this means processedEntries is shared between test methods. I\u0027m guessing you ran into this problem and that\u0027s why you had to use different resource names in each method.\n\nUse a @Before method instead so the resources are created freshly for each test.",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_81ff7a79",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 38,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T18:41:26Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_21b0aefb",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_c019feab",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 47,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Optional, reduce one level of nesting:\n\n new Thread() {\n   @Override\n   public void run() {\n     ..\n   }\n }.start();",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_e04ac275",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 47,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T18:41:26Z",
      "side": 1,
      "message": "Syntax error, type annotations are available only when source level is at least 1.8\n\nWhen did we drop support for java 7 and below?\n(At least I seem to use some java version \u003c 8)",
      "parentUuid": "19f28455_c019feab",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_a044ba67",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 47,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:53:23Z",
      "side": 1,
      "message": "Huh?\n\n $ cat Foo.java \u0026\u0026 javac Foo.java \u0026\u0026 java Foo\n public class Foo {\n   public static void main(String[] args) throws Exception {\n     new Thread() {\n       @Override\n       public void run() {\n         System.out.println(\"running\");\n       }\n     }.start();\n     Thread.sleep(1000);\n   }\n }\n running",
      "parentUuid": "19f28455_e04ac275",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_40abae91",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 47,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:02:33Z",
      "side": 1,
      "message": "Oh I just messed up with the braces/parentheses",
      "parentUuid": "19f28455_a044ba67",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_c19ea26b",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 50,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "This seems racy.\n\n* This thread starts, awaits \u0027before\u0027 latch\n* Main thread calls process(task1) which calls processTask(task1)\n* Main thread awaits \u0027before\u0027 latch (l. 212)\n\nHow do you guarantee that the main thread proceeds first and takes the lock? ISTM the background thread is just as likely to proceed, which means it might grab the lock instead of the main thread.",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_e17886a5",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 50,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T18:41:26Z",
      "side": 1,
      "message": "The lock is locked in PriorityLockedQueue before the \u0027before\u0027 latch is counted down in the TestingTask, so it is guaranteed\nto be locked inside the PriorityLockedQueue during the whole time in processTask(). So I think you\u0027re missing the locking in the second step process(task1) is only called if lock.lock(task1.resources) could be met.",
      "parentUuid": "39ebc864_c19ea26b",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_80a1b6b3",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 50,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:53:23Z",
      "side": 1,
      "message": "Ack, thank you.",
      "parentUuid": "39ebc864_e17886a5",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_a016fa77",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 52,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Maybe a comment here, like \"Couldn\u0027t lock A because task1 holds the lock\"",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_004ec68b",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 52,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T18:41:26Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_a016fa77",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_8053f63f",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 83,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "This seems unrealistic. The lock belongs to task1 at this point, so shouldn\u0027t it only be released by task1?",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_603fd2e9",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 83,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T18:41:26Z",
      "side": 1,
      "message": "When the assertion before this line is true, then the lock belongs to us as the lock method only returns true if the lock could be locked. So we need to unlock it, such that task1 can actually start.",
      "parentUuid": "19f28455_8053f63f",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_60a6b2cb",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 83,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:53:23Z",
      "side": 1,
      "message": "Ok.\n\nBut this seems racy. Can the following happen?\n\n* New thread starts\n* task1 is scheduled for 25ms from now\n* 25ms pass without main thread proceeding\n* queue wakes up, decides to run task1\n* task1 gets lock\n* main thread reaches l. 82, assertion fails",
      "parentUuid": "19f28455_603fd2e9",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_210e6e3d",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 83,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:02:33Z",
      "side": 1,
      "message": "Yes this is racy, because we don\u0027t have a DeterministicScheduler (I removed that thing as it cannot really deal with multi threading).\n\nI thought 25 ms are long enough to prevent this race from happen. (25ms are a long time in computers, so why should the main thread just sit idle for that time? Maybe by OS interruptions).\nAnd as we don\u0027t have a testing scheduler we cannot make it too long as it\u0027s wall clock time passing here. \n\nMaybe we could increase it to 250 ms though?",
      "parentUuid": "19f28455_60a6b2cb",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_608d9239",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 83,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T19:10:41Z",
      "side": 1,
      "message": "Arbitrary threads can idle for a long time if the system is under heavy load, like, say, when you\u0027re running a bunch of Gerrit acceptance tests.\n\nThe solution is latches, which you\u0027re already using in some places to ensure deterministic operation.",
      "parentUuid": "39ebc864_210e6e3d",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_6058f25b",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 94,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Unnecessary",
      "range": {
        "startLine": 94,
        "startChar": 4,
        "endLine": 94,
        "endChar": 9
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_4034ce09",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 94,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T18:41:26Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19f28455_6058f25b",
      "range": {
        "startLine": 94,
        "startChar": 4,
        "endLine": 94,
        "endChar": 9
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_a19b9e79",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 114,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Unnecessary",
      "range": {
        "startLine": 114,
        "startChar": 4,
        "endLine": 114,
        "endChar": 9
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_c17582ab",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 114,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T18:41:26Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_a19b9e79",
      "range": {
        "startLine": 114,
        "startChar": 4,
        "endLine": 114,
        "endChar": 9
      },
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_0195aa47",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 131,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "final",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_a1727ebf",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 131,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T18:41:26Z",
      "side": 1,
      "message": "Why here?",
      "parentUuid": "39ebc864_0195aa47",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_6104761d",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 131,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:53:23Z",
      "side": 1,
      "message": "It\u0027s not reassigned anywhere.\n\nParticularly in multithreaded code, putting \"final\" in there is a strong signal that we don\u0027t have to worry about whether a write to this value in one thread is going to be visible to another thread.",
      "parentUuid": "39ebc864_a1727ebf",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_20b0aafb",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 131,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T19:02:33Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_6104761d",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_e191a65b",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 202,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2015-05-28T18:21:02Z",
      "side": 1,
      "message": "Use Guava\u0027s AtomicLongMap instead, then you don\u0027t need to synchronize on processedEntries at all",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_2039ca01",
        "filename": "gerrit-server/src/test/java/com/google/gerrit/server/git/PriorityLockedQueueTest.java",
        "patchSetId": 36
      },
      "lineNbr": 202,
      "author": {
        "id": 1017837
      },
      "writtenOn": "2015-05-28T18:41:26Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39ebc864_e191a65b",
      "revId": "df634ac28f02f7de9d7bc4b4c04b4d57b00b28d0",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}