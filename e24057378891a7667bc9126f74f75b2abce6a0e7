{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "a73b6707_3b1bc7b4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-08-10T08:05:40Z",
      "side": 1,
      "message": "what part is the \"conditional\" aspect referring to?",
      "range": {
        "startLine": 17,
        "startChar": 7,
        "endLine": 17,
        "endChar": 30
      },
      "revId": "e24057378891a7667bc9126f74f75b2abce6a0e7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ec5b0f58_e66a9c3b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-08-10T09:43:25Z",
      "side": 1,
      "message": "https://cs.opensource.google/gerrit/gerrit/gerrit/+/master:polygerrit-ui/app/elements/change/gr-change-view/gr-change-view.ts;l\u003d2099;drc\u003df2cb8c50bb9d3ec9c9ba0ceff61c45fdb02d4fb2",
      "parentUuid": "a73b6707_3b1bc7b4",
      "range": {
        "startLine": 17,
        "startChar": 7,
        "endLine": 17,
        "endChar": 30
      },
      "revId": "e24057378891a7667bc9126f74f75b2abce6a0e7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d83e16da_d35e67cf",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-08-10T14:27:58Z",
      "side": 1,
      "message": "Dhruv: 14:14:50\nI set a breakpoint on the reload() call and found that the call in GrChangeActions happens before the call from GrChangeView(which calls this.$.actions.reload). That means with the proposed fix, the call from GrChangeView is simply ignored.\n\nSo IIUC the call from GrChangeView is in fact redundant? @hanwen did you verify that the call inside GrChangeView cannot be simply removed?",
      "parentUuid": "ec5b0f58_e66a9c3b",
      "range": {
        "startLine": 17,
        "startChar": 7,
        "endLine": 17,
        "endChar": 30
      },
      "revId": "e24057378891a7667bc9126f74f75b2abce6a0e7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3aa3015c_b33249b6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-08-10T14:28:36Z",
      "side": 1,
      "message": "you can observe that the call happens in a particular order in a debugger, but does that mean it always happens in this order? AFAICT, both calls are driven by @observe(), which is fired from Polymer? What guarantees do we have about the ordering?\n\nI don\u0027t know why the calls are there, but they are triggered by reload (gr-change-view.ts, l.686). On reload, don\u0027t we want all data (including the change actions) to be recomputed?",
      "parentUuid": "d83e16da_d35e67cf",
      "range": {
        "startLine": 17,
        "startChar": 7,
        "endLine": 17,
        "endChar": 30
      },
      "revId": "e24057378891a7667bc9126f74f75b2abce6a0e7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "794a2259_e02be304",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-08-10T14:29:57Z",
      "side": 1,
      "message": "dhruv: \n\nloadData() in GrChangeView is calling _getChangeDetail here [1] which sets a new change object [2] which triggers the observer for GrChangeActions and reload() is automatically called.\n\nThe call for actions.reload() in GrChangeView is waiting for changeDetail call to be finished [3] via the loadingFlagSet promise so I\u0027m wondering what speedup it is really providing since it\u0027s waiting for the changeDetail call in both cases and polymer observer shouldn\u0027t be that slow(perhaps I am wrong here but that is what I want verified here).\n\n\u003e\u003e\u003eI don\u0027t know why the calls are there\n\nThis is exactly what I\u0027m asking you to verify before implementing your change. Perhaps removing the call from GrChangeView entirely is the much simpler solution.\n\nIs there some way to verify why this code is present in GrChangeView? Perhaps find the original change which added the code and see what justification(if any) they provided.\n\n[1] gr-change-view.ts;l\u003d2064 \n\n[2] gr-change-view.ts;l\u003d1883;\n\n[3] gr-change-view.ts;l\u003d2117",
      "parentUuid": "3aa3015c_b33249b6",
      "range": {
        "startLine": 17,
        "startChar": 7,
        "endLine": 17,
        "endChar": 30
      },
      "revId": "e24057378891a7667bc9126f74f75b2abce6a0e7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5981a9e3_7305bfc0",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-08-10T14:30:34Z",
      "side": 1,
      "message": "thanks for the detailed analysis. The problem was introduced in https://gerrit-review.googlesource.com/c/gerrit/+/177952\n\nI did as you suggested.",
      "parentUuid": "794a2259_e02be304",
      "range": {
        "startLine": 17,
        "startChar": 7,
        "endLine": 17,
        "endChar": 30
      },
      "revId": "e24057378891a7667bc9126f74f75b2abce6a0e7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a8642e1c_41abfa34",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1083225
      },
      "writtenOn": "2021-08-10T08:05:40Z",
      "side": 1,
      "message": "IIUC then at least one of those calls will be processed by reload() in GrChangeActions since you are setting _loadingPromise to null once it resolves?",
      "range": {
        "startLine": 29,
        "startChar": 37,
        "endLine": 29,
        "endChar": 66
      },
      "revId": "e24057378891a7667bc9126f74f75b2abce6a0e7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "45d06def_271037cc",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-08-10T09:43:25Z",
      "side": 1,
      "message": "correct. I dug a little deeper and documented when this can happen.",
      "parentUuid": "a8642e1c_41abfa34",
      "range": {
        "startLine": 29,
        "startChar": 37,
        "endLine": 29,
        "endChar": 66
      },
      "revId": "e24057378891a7667bc9126f74f75b2abce6a0e7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8a0cdde7_f58c7e41",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2021-08-10T15:28:12Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "45d06def_271037cc",
      "range": {
        "startLine": 29,
        "startChar": 37,
        "endLine": 29,
        "endChar": 66
      },
      "revId": "e24057378891a7667bc9126f74f75b2abce6a0e7",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}