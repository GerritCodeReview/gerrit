{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "11f0ea31_aabaa597",
        "filename": "java/com/google/gerrit/server/patch/gitfilediff/GitFileDiffCacheImpl.java",
        "patchSetId": 4
      },
      "lineNbr": 241,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2022-04-11T07:51:19Z",
      "side": 1,
      "message": "This means ObjectReader and DiffFormatter are not shared among threads that are processing at the same time, but Repository is. FileRepositry is thread-safe, so we are good, but for DfsRepository, it depends on the implementation.\n\nGoogle\u0027s implementation doesn\u0027t guarantee thread safety so this still isn\u0027t the cleanest possible solution. I do think it will solve our problem.",
      "range": {
        "startLine": 241,
        "startChar": 30,
        "endLine": 241,
        "endChar": 71
      },
      "revId": "e2d98f173cc7a5cdeab1a46c76f902b4c5dfc8f6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "92c66d7f_ef60ece4",
        "filename": "java/com/google/gerrit/server/patch/gitfilediff/GitFileDiffCacheImpl.java",
        "patchSetId": 4
      },
      "lineNbr": 241,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2022-04-11T09:20:52Z",
      "side": 1,
      "message": "add a comment + file bug? It may make a race window smaller, but better not have no races at all?",
      "parentUuid": "11f0ea31_aabaa597",
      "range": {
        "startLine": 241,
        "startChar": 30,
        "endLine": 241,
        "endChar": 71
      },
      "revId": "e2d98f173cc7a5cdeab1a46c76f902b4c5dfc8f6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "710e5a70_3c18e107",
        "filename": "java/com/google/gerrit/server/patch/gitfilediff/GitFileDiffCacheImpl.java",
        "patchSetId": 4
      },
      "lineNbr": 241,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2022-04-11T10:05:40Z",
      "side": 1,
      "message": "We are papering over this for the N-th time, so instead of making Repository thread safe in all cases to eliminate the remaining race potential, I think we should prioritize https://bugs.chromium.org/p/gerrit/issues/detail?id\u003d487. (Myers has a defined worst case runtime) and eliminate all of this Future,Pool,syncronziation logic so that what remains in single threaded WDYT?",
      "parentUuid": "92c66d7f_ef60ece4",
      "range": {
        "startLine": 241,
        "startChar": 30,
        "endLine": 241,
        "endChar": 71
      },
      "revId": "e2d98f173cc7a5cdeab1a46c76f902b4c5dfc8f6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6ba7e505_748e7ec0",
        "filename": "java/com/google/gerrit/server/patch/gitfilediff/GitFileDiffCacheImpl.java",
        "patchSetId": 4
      },
      "lineNbr": 241,
      "author": {
        "id": 1091982
      },
      "writtenOn": "2022-04-11T11:07:41Z",
      "side": 1,
      "message": "And also eliminate the main / fallback algorithms (as it was introduced because of the bug in Myers diff as far as I understand from the history).",
      "parentUuid": "710e5a70_3c18e107",
      "range": {
        "startLine": 241,
        "startChar": 30,
        "endLine": 241,
        "endChar": 71
      },
      "revId": "e2d98f173cc7a5cdeab1a46c76f902b4c5dfc8f6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a7a85b22_e21d6812",
        "filename": "java/com/google/gerrit/server/patch/gitfilediff/GitFileDiffCacheImpl.java",
        "patchSetId": 4
      },
      "lineNbr": 241,
      "author": {
        "id": 1024147
      },
      "writtenOn": "2022-04-11T12:09:17Z",
      "side": 1,
      "message": "maybe fixing MD is feasible. Regardless, if we\u0027re committing a thread-safety sin here, we should at least document it.",
      "parentUuid": "6ba7e505_748e7ec0",
      "range": {
        "startLine": 241,
        "startChar": 30,
        "endLine": 241,
        "endChar": 71
      },
      "revId": "e2d98f173cc7a5cdeab1a46c76f902b4c5dfc8f6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}