{
  "comments": [
    {
      "key": {
        "uuid": "3c04a1dc_276b6649",
        "filename": "polygerrit-ui/app/elements/change/gr-reply-dialog/gr-reply-dialog.js",
        "patchSetId": 2
      },
      "lineNbr": 327,
      "author": {
        "id": 1085901
      },
      "writtenOn": "2020-07-22T14:33:14Z",
      "side": 1,
      "message": "It should be either e \u003d\u003e { return this._compute...(); } or e\u003d\u003e this._compute...();\nAlso, please add test for it.",
      "range": {
        "startLine": 324,
        "startChar": 0,
        "endLine": 327,
        "endChar": 0
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6caf2b2e_c32c1d78",
        "filename": "polygerrit-ui/app/elements/change/gr-reply-dialog/gr-reply-dialog.js",
        "patchSetId": 2
      },
      "lineNbr": 327,
      "author": {
        "id": 1086906
      },
      "writtenOn": "2020-07-22T15:07:45Z",
      "side": 1,
      "message": "ya was a bit lazy for that, thanks for pointing out, will add a test.",
      "parentUuid": "3c04a1dc_276b6649",
      "range": {
        "startLine": 324,
        "startChar": 0,
        "endLine": 327,
        "endChar": 0
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "381b849f_448aa74b",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 429,
      "author": {
        "id": 1085901
      },
      "writtenOn": "2020-07-22T16:05:28Z",
      "side": 1,
      "message": "Comment removed by: Dmitrii Filippov",
      "range": {
        "startLine": 429,
        "startChar": 12,
        "endLine": 429,
        "endChar": 16
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d93138d8_984dabfa",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 429,
      "author": {
        "id": 1086906
      },
      "writtenOn": "2020-07-22T17:24:55Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "381b849f_448aa74b",
      "range": {
        "startLine": 429,
        "startChar": 12,
        "endLine": 429,
        "endChar": 16
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4ebb90e8_c06e6d96",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 434,
      "author": {
        "id": 1085901
      },
      "writtenOn": "2020-07-22T16:05:28Z",
      "side": 1,
      "message": "Comment removed by: Dmitrii Filippov",
      "range": {
        "startLine": 434,
        "startChar": 2,
        "endLine": 434,
        "endChar": 27
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f12e1034_dd8f4bb1",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 434,
      "author": {
        "id": 1086906
      },
      "writtenOn": "2020-07-22T17:24:55Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "4ebb90e8_c06e6d96",
      "range": {
        "startLine": 434,
        "startChar": 2,
        "endLine": 434,
        "endChar": 27
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a688cb0b_67f05f23",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 446,
      "author": {
        "id": 1085901
      },
      "writtenOn": "2020-07-22T15:00:51Z",
      "side": 1,
      "message": "Should it be\nthis.set(\u0027comment.message\u0027, this._messageText);\n?\n(see line 385 in this file)",
      "range": {
        "startLine": 446,
        "startChar": 8,
        "endLine": 446,
        "endChar": 49
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4bb742e4_54a26ae4",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 446,
      "author": {
        "id": 1086906
      },
      "writtenOn": "2020-07-22T15:07:45Z",
      "side": 1,
      "message": "it seems work just fine, but I can change to use `set`",
      "parentUuid": "a688cb0b_67f05f23",
      "range": {
        "startLine": 446,
        "startChar": 8,
        "endLine": 446,
        "endChar": 49
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e94ff140_eb3b81de",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 447,
      "author": {
        "id": 1085901
      },
      "writtenOn": "2020-07-22T15:00:51Z",
      "side": 1,
      "message": "I don\u0027t understand this part.\nIf gr-comment remains in editing mode, why do you set comment.message explicitly? I suppose that when user click save the _messageText is copied to comment.message anyway. And if user click discard - we should restore original message (from the comment.message).",
      "range": {
        "startLine": 435,
        "startChar": 36,
        "endLine": 447,
        "endChar": 7
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "75268c09_1c9095ff",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 447,
      "author": {
        "id": 1086906
      },
      "writtenOn": "2020-07-22T15:07:45Z",
      "side": 1,
      "message": "as noted in the comments:\n```\n// This usually happens when we save one comment while\n// we have more comments under editing, most of times\n// we probably don\u0027t want to lose all our edits on them\n```\n\nthis is when you have multiple comments in editing mode at the same time, currently we are re-rendering the thread-list when save by getting a new copy of all comments. our data flow always flow from upward to the thread and then comment component. And when that happens, all comments will have `editing` reset to false and `_messageText` will be lost since no edit / discard or any actions involved, its just the comment input gets updated",
      "parentUuid": "e94ff140_eb3b81de",
      "range": {
        "startLine": 435,
        "startChar": 36,
        "endLine": 447,
        "endChar": 7
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "43614da6_54c080da",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 447,
      "author": {
        "id": 1086906
      },
      "writtenOn": "2020-07-22T15:23:51Z",
      "side": 1,
      "message": "updated with a test that may help elaborate the scenario, hopefully :) I will keep this comment open so feel free to suggest anything",
      "parentUuid": "75268c09_1c9095ff",
      "range": {
        "startLine": 435,
        "startChar": 36,
        "endLine": 447,
        "endChar": 7
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0bf7688a_322e869a",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 447,
      "author": {
        "id": 1085901
      },
      "writtenOn": "2020-07-22T15:32:35Z",
      "side": 1,
      "message": "Tried to have multiple comments in editing mode and then click \"Save\" or \"Discard\". Tried several different scenarios and didn\u0027t notice any problem.\nSome steps to reproduce the problem can help a lot.",
      "parentUuid": "43614da6_54c080da",
      "range": {
        "startLine": 435,
        "startChar": 36,
        "endLine": 447,
        "endChar": 7
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ce0ca2d4_97cb7d34",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 447,
      "author": {
        "id": 1086906
      },
      "writtenOn": "2020-07-22T15:35:34Z",
      "side": 1,
      "message": "1. leave two drafts\n2. open reply dialog\n3. edit both\n4. save on one, name it as A\n5. wait\n6. both are back to non-edit mode and only A has the edits saved",
      "parentUuid": "0bf7688a_322e869a",
      "range": {
        "startLine": 435,
        "startChar": 36,
        "endLine": 447,
        "endChar": 7
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5554ec78_e73611a4",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 447,
      "author": {
        "id": 1085901
      },
      "writtenOn": "2020-07-22T16:05:28Z",
      "side": 1,
      "message": "Thank you, reproduced. It was not clear from the comments and commit message that the problem appears only in reply dialog and doesn\u0027t exist when you edit comments in file-list.\nI am a little bit worried that this solution (comparing old and new text) looks hackish.\nI downloaded this fix and noticed that the following scenario doesn\u0027t work:\nsteps 1 - 5 are the same\n6. Click \"Cancel\" on another comment. Expected: original text, Actual: edited text\n7. Click \"Send\". The comment from the step 6 posted with original text.\n\n\nBased on your explanation, what if instead of comparing text here you update _commentMessageChanged method:\n_commentMessageChanged(message) {\n    if (this.editing) { // In editing mode always preserve entered text\n      return;\n    }\n    this._messageText \u003d message || \u0027\u0027;\n  }\nIt seems, this also solves the problem described in your comment and also doesn\u0027t add unexpected problems with \"Cancel\" button.",
      "parentUuid": "ce0ca2d4_97cb7d34",
      "range": {
        "startLine": 435,
        "startChar": 36,
        "endLine": 447,
        "endChar": 7
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f68669e9_b9ae718e",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 447,
      "author": {
        "id": 1086906
      },
      "writtenOn": "2020-07-22T16:10:42Z",
      "side": 1,
      "message": "ya it only happens in thread-list (so in reply dialog, comment tabs, change log). I am not very happy with the method either, thought could improve that after comments in service.\n\n`_commentMessageChanged` won\u0027t work for the `unresolved` part, so if you edit two drafts, and mark one as resolved, and save on the other comment, that comment\u0027s resolved status will be overriden :( that\u0027s why I have it in commentUpdate part, let me take a look on the `cancel` case, its not urgent, I have not seen any reports on this issue before. let me know if you have other ideas.",
      "parentUuid": "5554ec78_e73611a4",
      "range": {
        "startLine": 435,
        "startChar": 36,
        "endLine": 447,
        "endChar": 7
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e6ff4d55_35003185",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 447,
      "author": {
        "id": 1085901
      },
      "writtenOn": "2020-07-22T17:22:51Z",
      "side": 1,
      "message": "\u003e\u003e _commentMessageChanged` won\u0027t work for the `unresolved` part\nI think unresolved part works well in your fix.\n\nMy suggestion was only about removing this condition:\nif (this.comment.message \u003d\u003d\u003d oldComment.message) {\n  this.comment.message \u003d this._messageText;\n}\nand instead update the _commentMessageChanged",
      "parentUuid": "f68669e9_b9ae718e",
      "range": {
        "startLine": 435,
        "startChar": 36,
        "endLine": 447,
        "endChar": 7
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "128987d7_52955d4f",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 447,
      "author": {
        "id": 1086906
      },
      "writtenOn": "2020-07-22T17:24:55Z",
      "side": 1,
      "message": "oh i see, i kind of want to have them in the same place. but ya I think having them in the `_commentMessageChanged` also works for me, will add a comment about that as well. thx",
      "parentUuid": "e6ff4d55_35003185",
      "range": {
        "startLine": 435,
        "startChar": 36,
        "endLine": 447,
        "endChar": 7
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d4ee3090_d71902e0",
        "filename": "polygerrit-ui/app/elements/shared/gr-comment/gr-comment.js",
        "patchSetId": 2
      },
      "lineNbr": 447,
      "author": {
        "id": 1086906
      },
      "writtenOn": "2020-07-22T17:34:12Z",
      "side": 1,
      "message": "actually, if move the logic to _commentMessageChanged, i will lose the ability to override the message even in editing mode when somehow the upcoming comment has a different message, it should rarely happen, but seems possible.",
      "parentUuid": "128987d7_52955d4f",
      "range": {
        "startLine": 435,
        "startChar": 36,
        "endLine": 447,
        "endChar": 7
      },
      "revId": "e71fbca76c19b1f8965f2dc8c5c20cd60b7414cb",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}