{
  "pushCert": "certificate version 0.1\npusher F41A2656 1506783214 +0200\nnonce ANEgCxebWobBPuLf3Dray2zJkMW8Clz5tZVbuiiq1J34ZLK4WFjDMS0AY6Ek4PNJQ3ZXxfJVZC9C\n\n0000000000000000000000000000000000000000 cb8263a9a4a604929d2c854db5e9767306b778d1 refs/for/master\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQEcBAABAgAGBQJZz6/uAAoJEHFVO370GiZWU7AIAIc+0Ly19sHulE3NQO3sL8aW\nl90krsIclCSUrrbJ2dFpQlCJK7gV6wbDwYqPapN1dO7ggfywf+d9oI6eb2GAnTc3\n0r5yk5nbov7cfYggE+dAOKzq50Xa4PXApVFxmspH63F9OPK8toOuDFBMgOkDlpCK\nLCDgScqZahXW7+lFWvWCcWVE9CPwYTrqaCOs+/D3orpY6/TmZIfhZJK3rxy40Evb\n6GrNeNWhgHFpPNbFzlps+WknJMwMDmWPzEthSHI5CZ55jCkn/Q4wiMqSRP5go79B\n4O0lVlJxMWByiWHFdXhca2QRVTxt94957CbZcZ5P0Zil7cWJ3pHxW9VTqjKRQxs\u003d\n\u003dtDXD\n-----END PGP SIGNATURE-----\n",
  "comments": [
    {
      "key": {
        "uuid": "209f6848_50b4d1d7",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/api/change/ChangeIT.java",
        "patchSetId": 3
      },
      "lineNbr": 3404,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-09-30T15:29:58Z",
      "side": 1,
      "message": "I was confused by this method name. It makes it seems like calling markAsReviewed(true) and then markAsReviewed(false) is disallowed. But that\u0027s not what this test is about, IIUC: it\u0027s saying that you can\u0027t use the lower-level setStars API to set a star that is inconsistent with the existing state. Is that right?",
      "range": {
        "startLine": 3404,
        "startChar": 14,
        "endLine": 3404,
        "endChar": 65
      },
      "revId": "e8aed50acab809edb15514bede12c2705ff5e70e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6e18cd8b_b323ed85",
        "filename": "gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/api/change/ChangeIT.java",
        "patchSetId": 3
      },
      "lineNbr": 3404,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2017-09-30T16:06:10Z",
      "side": 1,
      "message": "Yes, I will rename the tests to make this more clear.",
      "parentUuid": "209f6848_50b4d1d7",
      "range": {
        "startLine": 3404,
        "startChar": 14,
        "endLine": 3404,
        "endChar": 65
      },
      "revId": "e8aed50acab809edb15514bede12c2705ff5e70e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b8700f58_aef27054",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/StarredChangesUtil.java",
        "patchSetId": 3
      },
      "lineNbr": 395,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-09-30T15:29:58Z",
      "side": 1,
      "message": "anyMatch",
      "revId": "e8aed50acab809edb15514bede12c2705ff5e70e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c5c4530d_bda37684",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/StarredChangesUtil.java",
        "patchSetId": 3
      },
      "lineNbr": 397,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-09-30T15:29:58Z",
      "side": 1,
      "message": "I\u0027m honestly still not sold on putting the mutual exclusivity checks in the low-level star API like this, as opposed to just having some rule (even if it\u0027s arbitrary) for resolving a conflict. But, given that this is not the only check, I think it\u0027s fine to leave in.",
      "revId": "e8aed50acab809edb15514bede12c2705ff5e70e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e4a05f75_1fa78cb7",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/StarredChangesUtil.java",
        "patchSetId": 3
      },
      "lineNbr": 397,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2017-09-30T16:06:10Z",
      "side": 1,
      "message": "That makes me realise that this check is wrong. The reviewed/unreviewed labels are actually on patch-set level. Since we don\u0027t have labels on patch sets, the patch set is included in the label name. E.g. \"reviewed/1\" or \"reviewed/2\". It is legal to have different reviewed states on different patch sets, e.g. \"reviewed/1\" and \"unreviewed/2\". The current check would reject this.\n\nThis makes me wonder whether the MarkAsReviewed and MarkAsUnreviewed REST endpoints should rather be on revision level?",
      "parentUuid": "c5c4530d_bda37684",
      "revId": "e8aed50acab809edb15514bede12c2705ff5e70e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c24043f8_6e665a71",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/StarredChangesUtil.java",
        "patchSetId": 3
      },
      "lineNbr": 397,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-09-30T19:09:11Z",
      "side": 1,
      "message": "\u003e That makes me realise that this check is wrong.\n\nGood point. I think the only things that are mutually exclusive are \"reviewed/X\" and \"unreviewed/X\" for the _same_ X.\n\n\u003e This makes me wonder whether the MarkAsReviewed and MarkAsUnreviewed REST endpoints should rather be on revision level?\n\nI dunno. Is there a use case for ever marking a revision other than the current revision? If not, then I don\u0027t see the value.",
      "parentUuid": "e4a05f75_1fa78cb7",
      "revId": "e8aed50acab809edb15514bede12c2705ff5e70e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "35b70337_5b567a32",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/Module.java",
        "patchSetId": 3
      },
      "lineNbr": 94,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-09-30T15:29:58Z",
      "side": 1,
      "message": "Why not DELETE /reviewed for consistency with files?\n\nI would also have guessed that the class names would match PutReviewed/DeleteReviewed. But that would be slightly ugly since you would have to use a FQCN. And the class names don\u0027t really matter. But the REST API structure does :)",
      "revId": "e8aed50acab809edb15514bede12c2705ff5e70e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "58742cf3_9c084567",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/Module.java",
        "patchSetId": 3
      },
      "lineNbr": 94,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2017-09-30T15:50:34Z",
      "side": 1,
      "message": "Hmm.\n\nAs explained in the commit message we have 3 states:\n\n1. reviewed flag is auto-computed (neither \u0027reviewed\u0027 nor \u0027unreviewed\u0027 label)\n2. reviewed \u003d true (\u0027reviewed\u0027 label is set)\n3. reviewed \u003d false (\u0027unreviewed\u0027 label is set)\n\nMarkAsReviewed moves the change from state 1 or 3 to state 2, \nMarkAsUnreviewed moves the change from state 1 or 2 to state 3.\n\nI think\n\n  DELETE /c/id/reviewed\n\nmakes only sense as an undo for\n\n  PUT /c/id/reviewed \n\nto set the change from state 2 to state 1, but I think it would be unexpected if DELETE was setting a new label like \u0027unreviewed\u0027.\n\nHence I would rather keep MarkAsReviewed and MarkAsUnreviewed as separate PUT requests:\n\n  PUT /c/id/reviewed \n  PUT /c/id/unreviewed \n\nBut we can have support for delete requests in addition (to move back to state 1):\n\n  DELETE /c/id/reviewed \n  DELETE /c/id/unreviewed",
      "parentUuid": "35b70337_5b567a32",
      "revId": "e8aed50acab809edb15514bede12c2705ff5e70e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b632889d_26e27568",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/Module.java",
        "patchSetId": 3
      },
      "lineNbr": 94,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-09-30T19:09:11Z",
      "side": 1,
      "message": "\u003e Hmm.\n\u003e \n\u003e As explained in the commit message we have 3 states:\n\u003e \n\u003e 1. reviewed flag is auto-computed (neither \u0027reviewed\u0027 nor \u0027unreviewed\u0027 label)\n\u003e 2. reviewed \u003d true (\u0027reviewed\u0027 label is set)\n\u003e 3. reviewed \u003d false (\u0027unreviewed\u0027 label is set)\n\u003e \n\u003e MarkAsReviewed moves the change from state 1 or 3 to state 2, \n\u003e MarkAsUnreviewed moves the change from state 1 or 2 to state 3.\n\u003e \n\u003e I think\n\u003e \n\u003e   DELETE /c/id/reviewed\n\u003e \n\u003e makes only sense as an undo for\n\u003e \n\u003e   PUT /c/id/reviewed \n\u003e \n\u003e to set the change from state 2 to state 1, but I think it would be unexpected if DELETE was setting a new label like \u0027unreviewed\u0027.\n\nMakes sense\n\n\u003e Hence I would rather keep MarkAsReviewed and MarkAsUnreviewed as separate PUT requests:\n\u003e \n\u003e   PUT /c/id/reviewed \n\u003e   PUT /c/id/unreviewed \n\nSGTM\n\n\u003e But we can have support for delete requests in addition (to move back to state 1):\n\u003e \n\u003e   DELETE /c/id/reviewed \n\u003e   DELETE /c/id/unreviewed\n\nWould be ok, but I don\u0027t think it\u0027s necessary in this change. Most often the way it will go \"back\" to state 1 is when a new patch set is pushed.",
      "parentUuid": "58742cf3_9c084567",
      "revId": "e8aed50acab809edb15514bede12c2705ff5e70e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2fd7d0c1_1d300ced",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/schema/SchemaVersion.java",
        "patchSetId": 3
      },
      "lineNbr": 38,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-09-30T15:34:55Z",
      "side": 1,
      "message": "This means we will also have to temporarily revert this change internally :(",
      "revId": "e8aed50acab809edb15514bede12c2705ff5e70e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5f4fe695_315a0483",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/schema/Schema_161.java",
        "patchSetId": 3
      },
      "lineNbr": 67,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2017-09-30T15:29:58Z",
      "side": 1,
      "message": "toSet doesn\u0027t preserve order. I think toList would be better. Or toImmutableSet.",
      "range": {
        "startLine": 67,
        "startChar": 31,
        "endLine": 67,
        "endChar": 36
      },
      "revId": "e8aed50acab809edb15514bede12c2705ff5e70e",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}