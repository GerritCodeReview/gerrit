{
  "comments": [
    {
      "key": {
        "uuid": "19f28455_e05ac2c7",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2015-06-01T12:49:02Z",
      "side": 1,
      "message": "Do we really want to delete these schemas? Effectively this means that we force everyone to upgrade Gerrit version by version. E.g. instead of upgrading from 2.10 -\u003e 2.12. One must upgrade from 2.10 -\u003e 2.11 -\u003e 2.12. At least if you want to have online reindexing which is the case for any larger site which cannot effort a long downtime to do offline reindexing. This is especially bad, if admins are not aware of this problem. E.g. they upgrade from 2.10 -\u003e 2.12 and only then realize that online reindexing is not working with this upgrade, but now there is no way back...",
      "range": {
        "startLine": 9,
        "startChar": 45,
        "endLine": 11,
        "endChar": 9
      },
      "revId": "ed49f92c3b5d3de3f96b8a97be97ac39d516ac8a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f28455_00a5a639",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2015-06-01T14:11:52Z",
      "side": 1,
      "message": "| Do we really want to delete these schemas?\n\nNote, that since this change: [1], you cannot upgrade from 2.7 to 2.10 anyway, and forced to to this in two steps:\n\n* upgrade to 2.8 or 2.9\n* upgrade to 2.10\n\nThis trivial fix to support non disruptive migration path was rejected: [2]. So yes we do want to prune old schema versions, both database and index schemas, and no, we don\u0027t care about long offline times and to force performing single version migration steps. Nobody prevent us to write in the release notes, to do the upgrade with single release steps to benefit from online reindexing:\n\n* 2.6 -\u003e 2.9\n* 2.9 -\u003e 2.10\n* 2.10 -\u003e 2.11\n* 2.11 -\u003e 2.12\n* [...]\n\n| E.g. they upgrade from 2.10 -\u003e 2.12 and only then realize that online reindexing is not working with this upgrade, but now there is no way back...\n\n\nThis is wrong, of course, see this trivial downgrade SQL, that was provided by OpenStack infrastructure team to downgrade from 2.10 (broken JGit version) to 2.8.2 version: [3].\n\n* [1] https://gerrit-review.googlesource.com/63678\n* [2] https://gerrit-review.googlesource.com/63674\n* [3] https://review.openstack.org/#/c/182113/1/tools/gerrit-rollback-2.10-2.8.sql",
      "parentUuid": "19f28455_e05ac2c7",
      "range": {
        "startLine": 9,
        "startChar": 45,
        "endLine": 11,
        "endChar": 9
      },
      "revId": "ed49f92c3b5d3de3f96b8a97be97ac39d516ac8a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39ebc864_01bfea1e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 1003935
      },
      "writtenOn": "2015-06-01T14:22:41Z",
      "side": 1,
      "message": "\u003e Note, that since this change: [1], you cannot upgrade \n \u003e from 2.7 to 2.10 anyway\n\nI\u0027m not saying that we should never prune old schemas. If there is a good reason for pruning, we should do it (e.g. if there is a real effort for maintaining the old schemas). This was the case with [1]. But if there is no need, why not to keep the old schema versions around as long as they work?\n\n \u003e Nobody prevent us to write in the release notes, to do \n \u003e the upgrade with single release steps to benefit from \n \u003e online reindexing\n\nYes, I did this for the 2.11 release [4] and it\u0027s quite a paragraph to explain this. Just requiring everyone to read about and understand these details makes the upgrade unnecessarily complex.\n\n \u003e This is wrong, of course, see this trivial downgrade \n \u003e SQL, that was provided by OpenStack infrastructure\n\nYes, one can write such a script. But it is not part of the official Gerrit release and it doesn\u0027t work for arbitary schema downgrades.\n\n[4] https://gerrit-review.googlesource.com/66983",
      "parentUuid": "19f28455_00a5a639",
      "range": {
        "startLine": 9,
        "startChar": 45,
        "endLine": 11,
        "endChar": 9
      },
      "revId": "ed49f92c3b5d3de3f96b8a97be97ac39d516ac8a",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}