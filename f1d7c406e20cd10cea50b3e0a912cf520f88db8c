{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "045d8327_63974a37",
        "filename": "java/com/google/gerrit/index/query/AndSource.java",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1161425
      },
      "writtenOn": "2023-08-22T09:15:16Z",
      "side": 1,
      "message": "I tried to be less intrusive as possible in PaginatingSource, the reason of moving the filter logic in https://gerrit-review.googlesource.com/c/gerrit/+/345634/9/java/com/google/gerrit/index/query/AndSource.java is because PaginatingSource hold a reference to the source, instead of extending AndSource. \n\nIn other words, PaginatingSource calls this read method (that actually calls source.read()), and then does its own filtering, setting last and pageResultSize, returning its own ResultSet.\n\nDatasource instead calls this method to do the read and filtering.",
      "range": {
        "startLine": 72,
        "startChar": 2,
        "endLine": 79,
        "endChar": 3
      },
      "revId": "f1d7c406e20cd10cea50b3e0a912cf520f88db8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "38a628cb_85801922",
        "filename": "java/com/google/gerrit/index/query/AndSource.java",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-08-22T09:38:29Z",
      "side": 1,
      "message": "\u003e I tried to be less intrusive as possible in PaginatingSource\n\nWell, we are in master so we need to be as clean as possible.\nWould it make sense to split this change into two parts then?\n\n1. Make PaginatingSouce a subclass of AndSource\n2. Instantiate PaginatingSource instead of AndSource\n\nWDYT?",
      "parentUuid": "045d8327_63974a37",
      "range": {
        "startLine": 72,
        "startChar": 2,
        "endLine": 79,
        "endChar": 3
      },
      "revId": "f1d7c406e20cd10cea50b3e0a912cf520f88db8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "98d1f06e_751ac200",
        "filename": "java/com/google/gerrit/index/query/AndSource.java",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1161425
      },
      "writtenOn": "2023-08-22T13:29:38Z",
      "side": 1,
      "message": "Makes complete sense, doing it.",
      "parentUuid": "38a628cb_85801922",
      "range": {
        "startLine": 72,
        "startChar": 2,
        "endLine": 79,
        "endChar": 3
      },
      "revId": "f1d7c406e20cd10cea50b3e0a912cf520f88db8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "21f8fe6e_7ac2e9c5",
        "filename": "java/com/google/gerrit/index/query/AndSource.java",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1161425
      },
      "writtenOn": "2023-08-31T13:58:25Z",
      "side": 1,
      "message": "Actually it made sense to extend DataSource and not AndSource in `PaginatingSource`.\n\n In fact AndSource can have as `source` either a DataSource or PaginatingSource (also instantiated by QueryProcessor). I added a superclass `FilteredSource` so that AndSource can still hold a reference to a FilteredDatasource (with the original filtering and no internal pagination), or be an instance of PaginatingSource. \n\nThis allows for PaginatingSource to be initialized by itself as an extension of Datasource, or to be \"extended\" in the AnsSource class with the method `toDataSource` as before.\n\nI believe this solution also avoid code duplication and allow us to have less checks for paginationType.",
      "parentUuid": "98d1f06e_751ac200",
      "range": {
        "startLine": 72,
        "startChar": 2,
        "endLine": 79,
        "endChar": 3
      },
      "revId": "f1d7c406e20cd10cea50b3e0a912cf520f88db8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "726cff88_f1067d75",
        "filename": "javatests/com/google/gerrit/index/query/AndSourceTest.java",
        "patchSetId": 3
      },
      "lineNbr": 33,
      "author": {
        "id": 1161425
      },
      "writtenOn": "2023-08-22T09:15:16Z",
      "side": 1,
      "message": "Not sure if is worth running these tests for all pagination types.",
      "range": {
        "startLine": 33,
        "startChar": 52,
        "endLine": 33,
        "endChar": 79
      },
      "revId": "f1d7c406e20cd10cea50b3e0a912cf520f88db8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0b9a137b_569eac6d",
        "filename": "javatests/com/google/gerrit/index/query/AndSourceTest.java",
        "patchSetId": 3
      },
      "lineNbr": 33,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2023-08-22T09:38:29Z",
      "side": 1,
      "message": "I believe it does, just to make sure that it would still work.",
      "parentUuid": "726cff88_f1067d75",
      "range": {
        "startLine": 33,
        "startChar": 52,
        "endLine": 33,
        "endChar": 79
      },
      "revId": "f1d7c406e20cd10cea50b3e0a912cf520f88db8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f28f23df_9b63e4fc",
        "filename": "javatests/com/google/gerrit/index/query/AndSourceTest.java",
        "patchSetId": 3
      },
      "lineNbr": 33,
      "author": {
        "id": 1161425
      },
      "writtenOn": "2023-08-22T13:29:38Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "0b9a137b_569eac6d",
      "range": {
        "startLine": 33,
        "startChar": 52,
        "endLine": 33,
        "endChar": 79
      },
      "revId": "f1d7c406e20cd10cea50b3e0a912cf520f88db8c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}