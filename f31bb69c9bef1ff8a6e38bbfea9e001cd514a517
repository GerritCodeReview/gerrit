{
  "comments": [
    {
      "key": {
        "uuid": "9aa983fd_141ce384",
        "filename": "java/com/google/gerrit/server/BUILD",
        "patchSetId": 3
      },
      "lineNbr": 92,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2018-04-22T13:57:18Z",
      "side": 1,
      "message": "Sad to see, we are adding another dependency to server package, that can be avoided, because server.cache is not actually depending on the rest of the server package (except some classes from config package). And there is pending series to isolate server.cache from the rest of the server package. Next possible step is to move cache outside of the server, like you did with index package.",
      "range": {
        "startLine": 92,
        "startChar": 8,
        "endLine": 92,
        "endChar": 34
      },
      "revId": "f31bb69c9bef1ff8a6e38bbfea9e001cd514a517",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e49edc2f_67430d17",
        "filename": "java/com/google/gerrit/server/BUILD",
        "patchSetId": 3
      },
      "lineNbr": 92,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2018-04-25T13:41:54Z",
      "side": 1,
      "message": "Yeah, I agree we should split this up, although at this point TBH I prefer to focus on adding the new functionality rather than cleaning up the build. I still want to clean up the build eventually, of course.",
      "parentUuid": "9aa983fd_141ce384",
      "range": {
        "startLine": 92,
        "startChar": 8,
        "endLine": 92,
        "endChar": 34
      },
      "tag": "autogenerated:gerrit:newWipPatchSet",
      "revId": "f31bb69c9bef1ff8a6e38bbfea9e001cd514a517",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "34188f78_9390e4c3",
        "filename": "java/com/google/gerrit/server/cache/EnumCacheSerializer.java",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2018-04-25T12:11:06Z",
      "side": 1,
      "message": "Actually this could avoid the byte array allocation by using an OutputStreamWriter. (Granted, for small strings, it\u0027s probably a wash in terms of total memory allocation.)",
      "revId": "f31bb69c9bef1ff8a6e38bbfea9e001cd514a517",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "949ecf82_6222002f",
        "filename": "java/com/google/gerrit/server/cache/EnumCacheSerializer.java",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2018-04-25T13:41:54Z",
      "side": 1,
      "message": "Just decided to go with byte[] for reasons described elsewhere.",
      "parentUuid": "34188f78_9390e4c3",
      "tag": "autogenerated:gerrit:newWipPatchSet",
      "revId": "f31bb69c9bef1ff8a6e38bbfea9e001cd514a517",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "83d3e88e_9745fd4d",
        "filename": "java/com/google/gerrit/server/change/ChangeKindCacheImpl.java",
        "patchSetId": 3
      },
      "lineNbr": 130,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2018-04-21T17:24:52Z",
      "side": 1,
      "message": "FYI I do plan to make this an AutoValue type eventually, but I want to hold off until we\u0027ve migrated to the new serialization format internally and we\u0027ve deleted our hand-written serialization implementations.",
      "revId": "f31bb69c9bef1ff8a6e38bbfea9e001cd514a517",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "142d9440_e9069c3f",
        "filename": "proto/cache.proto",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2018-04-22T13:57:18Z",
      "side": 1,
      "message": "Another alternative to generic cache.proto with multiple messages per key, is to add cache key specific proto files, e.g. ChangeKindKey.proto. Does it make sense? (Not really related to the core, but if plugins would like to add persistent caches, they would add their own proto files.)",
      "revId": "f31bb69c9bef1ff8a6e38bbfea9e001cd514a517",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "94d5a971_271b4b69",
        "filename": "proto/cache.proto",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2018-04-25T13:41:54Z",
      "side": 1,
      "message": "It doesn\u0027t really make much difference, and doing it this way in core doesn\u0027t prevent plugins from adding their own proto_library rules. I\u0027d prefer to leave it as-is for now and reconsider if/when this file gets too cluttered.",
      "parentUuid": "142d9440_e9069c3f",
      "tag": "autogenerated:gerrit:newWipPatchSet",
      "revId": "f31bb69c9bef1ff8a6e38bbfea9e001cd514a517",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ae8366a_93b4f120",
        "filename": "proto/cache.proto",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2018-04-22T13:57:18Z",
      "side": 1,
      "message": "This could be \"com.google.gerrit.cache.proto\".",
      "range": {
        "startLine": 19,
        "startChar": 23,
        "endLine": 19,
        "endChar": 59
      },
      "revId": "f31bb69c9bef1ff8a6e38bbfea9e001cd514a517",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "285d9349_9b9c4712",
        "filename": "proto/cache.proto",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2018-04-25T13:41:54Z",
      "side": 1,
      "message": "I would prefer this live in the same package as the cache machinery, so I would rename it only after renaming the Java package.\n\n(Of course we could also argue for making the proto/ directory match the java/ directory with a gerrit/(server/)cache subdirectory, but let\u0027s not overthink it quite yet :)",
      "parentUuid": "9ae8366a_93b4f120",
      "range": {
        "startLine": 19,
        "startChar": 23,
        "endLine": 19,
        "endChar": 59
      },
      "tag": "autogenerated:gerrit:newWipPatchSet",
      "revId": "f31bb69c9bef1ff8a6e38bbfea9e001cd514a517",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a49c2018_3e3b4cb0",
        "filename": "tools/eclipse/project.py",
        "patchSetId": 3
      },
      "lineNbr": 250,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2018-04-22T13:57:18Z",
      "side": 1,
      "message": "Could be removed? I think it\u0027s not possible that the proto was generated, but the src zip is missing because of the way how the protoc compile works: it generates the sourcs zip in the proto_library:\n\n  protoc \u0027--java_out\u003dbazel-out/k8-fastbuild/genfiles/proto/cache_proto-speed-src.jar\u0027 ...\n\nand in the java_proto_library it compiles them:\n\n  --source_jars\nbazel-out/k8-fastbuild/genfiles/proto/cache_proto-speed-src.jar ...\n\nSo that the both should be always there:\n\n* java_proto_library: \"bazel-out/k8-fastbuild/bin/proto/libcache_proto-speed.jar\"\n* source: \"bazel-out/k8-fastbuild/genfiles/proto/cache_proto-speed-src.jar\"\n\nI would also expect that if bazel-out was wiped out, and the artifacts are restored from the action cache, both binary and source artifact are restored.",
      "range": {
        "startLine": 249,
        "startChar": 4,
        "endLine": 250,
        "endChar": 14
      },
      "revId": "f31bb69c9bef1ff8a6e38bbfea9e001cd514a517",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0c98e718_a8854b73",
        "filename": "tools/eclipse/project.py",
        "patchSetId": 3
      },
      "lineNbr": 250,
      "author": {
        "id": 1010008
      },
      "writtenOn": "2018-04-25T13:41:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a49c2018_3e3b4cb0",
      "range": {
        "startLine": 249,
        "startChar": 4,
        "endLine": 250,
        "endChar": 14
      },
      "tag": "autogenerated:gerrit:newWipPatchSet",
      "revId": "f31bb69c9bef1ff8a6e38bbfea9e001cd514a517",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}