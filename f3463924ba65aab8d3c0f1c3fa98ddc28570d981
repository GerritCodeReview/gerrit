{
  "comments": [
    {
      "key": {
        "uuid": "961c67fc_5a0d35c8",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 7,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-14T09:44:41Z",
      "side": 1,
      "message": "By defining in memory based suggestion oracle implementation i would expect that it is semantically equivalent to database based suggestion oracle implementation. But provided implementation is not AFAICT.\n\nOriginal code executes two select statements. full name based query over accounts table and email based query over AccountExternalId table. When a user has 42 rows in AccountExternalId email accounts, and provided query matches one of 42 email accounts the database based implementation would find a match even though the matched email address was not preferred email of this user.\n\nI don\u0027t have an opinion on wether this is the desired behavior with memory based approach or it should behave the same way, but these behavioaral differences between these backends must be reflected in the commit message.",
      "range": {
        "startLine": 7,
        "startChar": 0,
        "endLine": 7,
        "endChar": 67
      },
      "revId": "f3463924ba65aab8d3c0f1c3fa98ddc28570d981",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d6509fa6_9c12e5ee",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 17,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-14T09:44:41Z",
      "side": 1,
      "message": "Typo: approach.",
      "range": {
        "startLine": 17,
        "startChar": 62,
        "endLine": 17,
        "endChar": 69
      },
      "revId": "f3463924ba65aab8d3c0f1c3fa98ddc28570d981",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "961c67fc_1a07bdaa",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/SuggestReviewers.java",
        "patchSetId": 3
      },
      "lineNbr": 114,
      "author": {
        "id": 1006454
      },
      "writtenOn": "2014-08-14T10:23:58Z",
      "side": 1,
      "message": "A new config option should be reflected in the documentation.",
      "revId": "f3463924ba65aab8d3c0f1c3fa98ddc28570d981",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "961c67fc_ba17b1dd",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/SuggestReviewers.java",
        "patchSetId": 3
      },
      "lineNbr": 232,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-14T09:44:41Z",
      "side": 1,
      "message": "just str, we normally don\u0027t use \"lC\" prefixes.",
      "range": {
        "startLine": 232,
        "startChar": 11,
        "endLine": 232,
        "endChar": 19
      },
      "revId": "f3463924ba65aab8d3c0f1c3fa98ddc28570d981",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d6509fa6_3ceb9181",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/SuggestReviewers.java",
        "patchSetId": 3
      },
      "lineNbr": 234,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-14T09:44:41Z",
      "side": 1,
      "message": "not toList(), Iterate over all() directly.",
      "range": {
        "startLine": 234,
        "startChar": 29,
        "endLine": 234,
        "endChar": 72
      },
      "revId": "f3463924ba65aab8d3c0f1c3fa98ddc28570d981",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d6509fa6_1ceed590",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/SuggestReviewers.java",
        "patchSetId": 3
      },
      "lineNbr": 234,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-14T09:44:41Z",
      "side": 1,
      "message": "Not needed.",
      "range": {
        "startLine": 234,
        "startChar": 18,
        "endLine": 234,
        "endChar": 26
      },
      "revId": "f3463924ba65aab8d3c0f1c3fa98ddc28570d981",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d6509fa6_dc186d12",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/SuggestReviewers.java",
        "patchSetId": 3
      },
      "lineNbr": 244,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-14T09:44:41Z",
      "side": 1,
      "message": "unusual variable, just a?",
      "range": {
        "startLine": 244,
        "startChar": 19,
        "endLine": 244,
        "endChar": 22
      },
      "revId": "f3463924ba65aab8d3c0f1c3fa98ddc28570d981",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d6509fa6_7ce119a1",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/SuggestReviewers.java",
        "patchSetId": 3
      },
      "lineNbr": 244,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-14T09:44:41Z",
      "side": 1,
      "message": "Why two different loops over accounts? That has performance implications: you are iterating twice over 10000+ long list and your code is verbose. May be something like this (simplified, you would still need check for limit):\n\n  for (Account a : dbProvider.get().accounts().all()) {\n    if (matchFullName(a.getFullName())) {\n      addSuggestion(a);\n    }\n    if (matchPreferredEmail(a.getPreferredEmail())) {\n      addSuggestion(a);\n    }\n  }\n\nBut see also my comment in commit message.",
      "revId": "f3463924ba65aab8d3c0f1c3fa98ddc28570d981",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d6509fa6_fc1d29ff",
        "filename": "gerrit-server/src/main/java/com/google/gerrit/server/change/SuggestReviewers.java",
        "patchSetId": 3
      },
      "lineNbr": 246,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2014-08-14T09:44:41Z",
      "side": 1,
      "message": "Are you missing the check if that account id already contained in the accountMap. This is done on line 219 in original code above.",
      "range": {
        "startLine": 246,
        "startChar": 10,
        "endLine": 246,
        "endChar": 90
      },
      "revId": "f3463924ba65aab8d3c0f1c3fa98ddc28570d981",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}