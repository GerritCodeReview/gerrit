include_defs('//gerrit-acceptance-tests/tests.defs')

SUBMIT_UTIL_SRCS = [
  'AbstractSubmit.java',
  'AbstractSubmitByMerge.java',
]

FLAKY_TEST_CASES = ['SubmitByMergeIfNecessaryIT.java']

SUBMIT_TESTS = glob(['Submit*IT.java'], excludes = FLAKY_TEST_CASES)
OTHER_TESTS = glob(['*IT.java'], excludes = SUBMIT_TESTS)

acceptance_tests(
  group = 'rest-change-other',
  srcs = OTHER_TESTS,
  deps = [
    ':submit_util',
    '//lib/joda:joda-time',
  ],
  labels = ['rest'],
)
 
acceptance_tests(
  group = 'rest-change-submit',
  srcs = SUBMIT_TESTS,
  deps = [
    ':submit_util',
  ],
  labels = ['rest'],
)

acceptance_tests(
  group = 'rest-change-submit-flaky',
  srcs = FLAKY_TEST_CASES,
  deps = [
    ':submit_util',
  ],
  labels = ['rest', 'flaky'],
)

java_library(
  name = 'submit_util',
  srcs = SUBMIT_UTIL_SRCS,
  deps = [
    '//gerrit-acceptance-tests:lib',
  ],
)
