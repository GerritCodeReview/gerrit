include_defs('//gerrit-acceptance-tests/tests.defs')

UTIL_SRCS = [
  'AccountInfo.java',
  'ChangeInfo.java',
  'ChangeMessageInfo.java',
  'GroupInfo.java',
  'ProjectConfigInput.java',
  'SubmitInput.java',
  'SuggestReviewerInfo.java',
]

SUBMIT_UTIL_SRCS = [
  'AbstractSubmit.java',
  'AbstractSubmitByMerge.java',
]

NON_TEST = UTIL_SRCS + SUBMIT_UTIL_SRCS
SUBMIT_TESTS = glob(['Submit*IT.java'], excludes = NON_TEST)
OTHER_TESTS = glob(['*IT.java'], excludes = SUBMIT_TESTS + NON_TEST)

acceptance_tests(
  srcs = OTHER_TESTS,
  deps = [
    ':util',
    '//gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git:util',
  ],
)

acceptance_tests(
  srcs = SUBMIT_TESTS,
  deps = [
    ':submit_util',
    '//gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git:util',
  ],
)

java_library(
  name = 'submit_util',
  srcs = SUBMIT_UTIL_SRCS,
  deps = [
    ':util',
    '//gerrit-acceptance-tests:lib',
    '//gerrit-acceptance-tests/src/test/java/com/google/gerrit/acceptance/git:util',
  ],
)

java_library(
  name = 'util',
  srcs = UTIL_SRCS,
  deps = [
    '//lib:guava',
    '//gerrit-reviewdb:server',
  ],
  visibility = ['//gerrit-acceptance-tests/...'],
)
