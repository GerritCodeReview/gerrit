<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="../../../behaviors/fire-behavior/fire-behavior.html">
<link rel="import" href="../../../styles/shared-styles.html">
<link rel="import" href="../../shared/gr-overlay/gr-overlay.html">
<link rel="import" href="../../shared/gr-rest-api-interface/gr-rest-api-interface.html">
<link rel="import" href="../gr-diff/gr-diff.html">

<dom-module id="gr-apply-fix-dialog">
  <template>
    <style include="shared-styles">
      header {
        display: flex;
        padding: .5em 1.5em;
        border-bottom: 1px solid var(--border-color);
        flex-shrink: 0;
        font-weight: var(--font-weight-bold);
      }
      gr-diff {
        --content-width: 70vw;
      }
      .diffContainer {
        padding: 1em 0;
        border-bottom: 1px solid var(--border-color);
      }
      .file-name {
        padding: .2em 1.5em;
        background-color: var(--selection-background-color);
        border-bottom: 1px solid var(--border-color);
      }
      .fixActions {
        display: flex;
        justify-content: flex-end;
      }
      .title {
        flex: 1;
        font-weight: var(--font-weight-bold);
      }
      gr-button {
        margin-left: 1em;
      }
      header,
      footer {
        padding: .5em 1.5em;
      }
      footer {
        display: flex;
        flex-shrink: 0;
        justify-content: flex-end;
      }
    </style>
    <gr-overlay id="applyFixOverlay" with-backdrop>
      <header>
        <span class="title">[[robotId]] - [[currentFix.description]]</span>
      </header>
      <template is="dom-repeat" items="[[currentPreviews]]">
        <h5 class="file-name">[[item.filepath]]</h5>
        <div class="diffContainer">
          <gr-diff
          prefs="[[overridePartialPrefs(prefs)]]"
          change-num="[[changeNum]]"
          patch-num="[[patchNum]]"
          path="[[item.filepath]]"
          diff="[[item.preview]]"
          ></gr-diff>
        </div>
      </template>
      <footer>
        <gr-button
          link
          secondary
          on-click="onCancel">
          Cancel
        </gr-button>
        <gr-button
          link
          primary
          on-click="handleApplyFix">
          Apply Fix
        </gr-button>
      </footer>
    </gr-overlay>
    <gr-rest-api-interface id="restAPI"></gr-rest-api-interface>
  </template>
  <script src="gr-apply-fix-dialog.js"></script>
</dom-module>