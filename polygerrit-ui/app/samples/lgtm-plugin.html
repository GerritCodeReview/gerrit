<dom-module id="lgtm-plugin">
  <script>
    Gerrit.install(plugin => {
        plugin.getDomHook('reply-text').onAttached(element => {
            if (!element.content) { return; }
            plugin.attributeHelper(element.content)
                  .get('change')
                  .then(change => {
                  });
        });
        const replyApi = plugin.changeReply();
      replyApi.addReplyTextChangedCallback(text => {
        const label = 'Code-Review';
        const labelValue = replyApi.getLabelValue(label);
        if (labelValue &&
            labelValue === ' 0' &&
            text.indexOf('LGTM') === 0) {
          replyApi.setLabelValue(label, '+1');
        }
      });
    });
  </script>
</dom-module>
